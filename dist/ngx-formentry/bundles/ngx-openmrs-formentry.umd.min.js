!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("@angular/forms"),require("moment"),require("lodash"),require("hammerjs"),require("@angular/common"),require("@angular/platform-browser"),require("ngx-file-uploader"),require("@angular/material/core"),require("@angular/material-moment-adapter"),require("@angular/material/datepicker"),require("@angular/material/form-field"),require("@angular/material"),require("amazing-time-picker"),require("@angular/material/select"),require("@angular/http"),require("ngx-bootstrap/collapse")):"function"==typeof define&&define.amd?define("ngx-openmrs-formentry",["exports","@angular/core","rxjs","@angular/forms","moment","lodash","hammerjs","@angular/common","@angular/platform-browser","ngx-file-uploader","@angular/material/core","@angular/material-moment-adapter","@angular/material/datepicker","@angular/material/form-field","@angular/material","amazing-time-picker","@angular/material/select","@angular/http","ngx-bootstrap/collapse"],t):t(e["ngx-openmrs-formentry"]={},e.ng.core,e.rxjs,e.ng.forms,null,null,null,e.ng.common,e.ng.platformBrowser,null,e.ng.material.core,e.ng["material-moment-adapter"],e.ng.material.datepicker,e.ng.material["form-field"],e.ng.material,null,e.ng.material.select,e.ng.http,null)}(this,function(exports,core,rxjs,forms,moment_,_,hammerjs,common,platformBrowser,ngxFileUploader,core$1,materialMomentAdapter,datepicker,formField,material,amazingTimePicker,select,http,collapse){"use strict";var DebugModeService=function(){function e(){this.cookieKey="formDebug"}return e.prototype.debugEnabled=function(){return!1},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[]},e}(),FormErrorsService=function(){function e(){this.announceErrorFieldSource=new rxjs.Subject,this.announceErrorField$=this.announceErrorFieldSource.asObservable()}return e.prototype.announceErrorField=function(e){this.announceErrorFieldSource.next(e)},e.control=null,e.tab=null,e.decorators=[{type:core.Injectable}],e}(),extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};function __extends(e,t){function o(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}function __values(e){var t="function"==typeof Symbol&&e[Symbol.iterator],o=0;return t?t.call(e):{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}}}var ControlRelation=function(){function e(e,t){this._control=e,this._relatedTo=t,this._registerForChangesFromRelatedControl()}return Object.defineProperty(e.prototype,"control",{get:function(){return this._control},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relatedTo",{get:function(){return this._relatedTo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastUpdateValue",{get:function(){return this._lastUpdateValue},enumerable:!0,configurable:!0}),e.prototype.updateControlBasedOnRelation=function(e){return e!==this._lastUpdateValue&&(this._lastUpdateValue=e,this._control.updateCalculatedValue&&this._control.updateCalculatedValue(),this._control.updateValueAndValidity(),this._control.updateHiddenState&&this._control.updateHiddenState(),this._control.updateDisabledState&&this._control.updateDisabledState(),this._control.updateAlert&&this._control.updateAlert(),!0)},e.prototype._registerForChangesFromRelatedControl=function(){var t=this;this._relatedTo.valueChanges.subscribe(function(e){t.updateControlBasedOnRelation(e)})},e}(),ControlRelations=function(){function e(e,t){this._otherRelations=[],this._relationFor=e,this._relations=[],t&&this.addRelatedControls(t)}return Object.defineProperty(e.prototype,"relationsFor",{get:function(){return this._relationFor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relations",{get:function(){return this._relations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"otherRelations",{get:function(){return this._otherRelations},enumerable:!0,configurable:!0}),e.prototype.addRelatedControls=function(e){if(e instanceof forms.AbstractControl&&this.relations.push(new ControlRelation(this._relationFor,e)),e instanceof Array)for(var t=0;t<e.length;t++)this.relations.push(new ControlRelation(this._relationFor,e[t]))},e}(),HiderHelper=function(){function e(){}return e.prototype.hideControl=function(e){e.hidden=!0,e.disable&&e.disable()},e.prototype.showControl=function(e){e.hidden=!1},e.prototype.setHiderForControl=function(e,t){e.hiders.push(t)},e.prototype.clearHidersForControl=function(e){e.hiders.splice(0),e.hidden=!1},e.prototype.evaluateControlHiders=function(e){var t=!1;e.hiders.forEach(function(e){e.reEvaluateHidingExpression(),!0===e.toHide&&(t=!0)}),e.hidden=t,e.hidden&&e.disable&&e.disable()},e.prototype.setUpReEvaluationWhenValueChanges=function(t){t.updateHiddenState&&t.valueChanges.subscribe(function(e){t.updateHiddenState()})},e}(),AlertHelper=function(){function e(){}return e.prototype.hideAlert=function(e){e.shown=!1},e.prototype.showAlert=function(e){e.shown=!0},e.prototype.setAlertsForControl=function(e,t){e.alerts.push(t)},e.prototype.clearAlertsForControl=function(e){e.alerts.splice(0),e.alert=""},e.prototype.evaluateControlAlerts=function(e){var t="";e.alerts.forEach(function(e){e.reEvaluateAlertExpression(),t=!0===e.shown?e.alertMessage:""}),e.alert=t},e.prototype.setUpReEvaluationWhenValueChanges=function(t){t.updateAlert&&t.valueChanges.subscribe(function(e){t.updateAlert()})},e}(),DisablerHelper=function(){function e(){}return e.prototype.setDisablerForControl=function(e,t){e.disablers.push(t)},e.prototype.clearDisablersForControl=function(e){e.disablers.splice(0),e.disable()},e.prototype.evaluateControlDisablers=function(e){var t=!1;e.disablers.forEach(function(e){e.reEvaluateDisablingExpression(),!0===e.toDisable&&(t=!0)}),t?e.disable():e.enable()},e.prototype.setUpReEvaluationWhenValueChanges=function(t){t.updateDisabledState&&t.valueChanges.subscribe(function(e){t.updateDisabledState()})},e}(),NodeBase=function(){function e(e,t,o,n){this._control=t,this._questionModel=e,this._form=o,this._path=n?n+"."+e.key:e.key}return Object.defineProperty(e.prototype,"question",{get:function(){return this._questionModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"control",{get:function(){return this._control},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"form",{get:function(){return this._form},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),e.prototype.removeAt=function(e){},e.prototype.createChildNode=function(){},e.prototype.removeChildNode=function(){},e}(),LeafNode=function(i){function e(e,t,o,n,r){return i.call(this,e,t,n,r)||this}return __extends(e,i),e}(NodeBase),GroupNode=function(a){function e(e,t,o,n,r){var i=a.call(this,e,t,n,r)||this;return i._children={},i}return __extends(e,a),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),e.prototype.setChild=function(e,t){this.children[e]=t},e}(NodeBase),ArrayNode=function(s){function e(e,t,o,n,r,i){var a=s.call(this,e,t,r,i)||this;return a.formFactory=n,a.childNodeCreatedEvents=[],a._children=[],a.childNodeCreatedEvents=[],a}return __extends(e,s),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),e.prototype.createChildNode=function(){if(this.createChildFunc){var e=this.createChildFunc(this.question,this,this.formFactory);return this.fireChildNodeCreatedListener(e),e}return null},e.prototype.removeAt=function(e){this.removeChildFunc&&this.removeChildFunc(e,this)},e.prototype.addChildNodeCreatedListener=function(e){this.childNodeCreatedEvents.push(e)},e.prototype.fireChildNodeCreatedListener=function(e){for(var t=0;t<this.childNodeCreatedEvents.length;t++){(0,this.childNodeCreatedEvents[t])(e)}},e}(NodeBase),ValidationModel=function(e){this.type=e.type,this.message=e.message||null},JsExpressionValidationModel=function(o){function e(e){var t=o.call(this,e)||this;return t.failsWhenExpression=e.failsWhenExpression,t}return __extends(e,o),e}(ValidationModel),ConditionalValidationModel=function(o){function e(e){var t=o.call(this,e)||this;return t.referenceQuestionId=e.referenceQuestionId,t.referenceQuestionAnswers=e.referenceQuestionAnswers,t}return __extends(e,o),e}(ValidationModel),ControlRelationsFactory=function(){function e(){}return e.prototype.buildRelations=function(e){var t=this.mapControlIds(e,{});for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];this.setRelations(t,n)}},e.prototype.buildArrayNodeRelations=function(e){var t=e.form;if(t){var o=t.rootNode;this.buildRelations(e);var n=this.mapControlIds(o,{}),r=this.mapControlIds(e,{});for(var i in n){if(n.hasOwnProperty(i))if((l=n[i])instanceof LeafNode){var a=l.question;a.key&&0<a.key.length&&this.setRelations(r,l)}}for(var s in this.createRelationsToArrayControls(e),r)if(r.hasOwnProperty(s)){var l,u=(l=r[s]).control;u.updateHiddenState(),u.updateAlert()}}},e.prototype.createRelationsToArrayControls=function(a){var s=a.form.rootNode,e=this.mapControlIds(s,{}),l=this.mapControlIds(a,{});for(var t in e)if(e.hasOwnProperty(t)){var u=e[t],c=a.path.substring(0,a.path.lastIndexOf("."));if(-1===u.path.indexOf(c+".")){var o=function(e){if(l.hasOwnProperty(e)){var t=l[e],o=t.question.key;if(p.hasRelation(o,u.question)){var n=a.form.searchNodeByPath(s,c,[]);if(0<n.length){var r=n[0],i=u.control;-1===i.controlRelations.otherRelations.indexOf(r)&&i.controlRelations.otherRelations.push(r),t.control.addValueChangeListener(function(e){i.updateCalculatedValue&&i.updateCalculatedValue(),i.updateValueAndValidity(),i.updateHiddenState&&i.updateHiddenState(),i.updateAlert&&i.updateAlert(),i.updateDisabledState&&i.updateDisabledState()})}}}},p=this;for(var n in l)o(n)}}},e.prototype.getRelationsForControl=function(e,t){var o=new Array,n=t.form.searchNodeByQuestionId(e);if(0<n.length){var r=n[0],i=this.mapControlIds(t,{});for(var a in i)i.hasOwnProperty(a)&&this.hasRelation(i[a].question.key,r.question)&&o.push(i[a].control)}return o},e.prototype.mapControlIds=function(e,t){var o=e.children;for(var n in o)if(o.hasOwnProperty(n)){var r=o[n];if(r instanceof GroupNode)this.mapControlIds(r,t);else if(r instanceof LeafNode){(i=r.question).key&&0<i.key.length&&(t[i.key]=r)}else if(r instanceof ArrayNode){var i;(i=r.question).key&&0<i.key.length&&(t[i.key]=r)}}return t},e.prototype.setRelations=function(e,t){var o=t.question.key;for(var n in e)if(e.hasOwnProperty(n)&&n!==o){var r=e[n],i=r.question;if(this.hasRelation(o,i,t)&&this.addRelationToControl(r.control,t.control),"object"==typeof i.required){var a=i.required;"conditionalRequired"===a.type&&a.referenceQuestionId===o&&this.addRelationToControl(r.control,t.control)}}},e.prototype.hasRelation=function(o,e,t){var n=!1;if(e.validators&&0<e.validators.length&&e.validators.forEach(function(e){if(e instanceof JsExpressionValidationModel){var t=e.failsWhenExpression;t&&-1!==t.indexOf(o)&&(n=!0)}else e instanceof ConditionalValidationModel&&"conditionalAnswered"===e.type&&e.referenceQuestionId===o&&(n=!0)}),!n){if("string"==typeof e.hide){var r=e.hide;0<r.length&&-1!==r.indexOf(o)&&(n=!0)}else if("object"==typeof e.hide){e.hide.field===o&&(n=!0)}if(e.alert&&"object"==typeof e.alert&&(n=!0),"string"==typeof e.disable){var i=e.disable;0<i.length&&-1!==i.indexOf(o)&&(n=!0)}}return!n&&e.calculateExpression&&0<e.calculateExpression.length&&-1!==e.calculateExpression.indexOf(o)&&(n=!0),n},e.prototype.addRelationToControl=function(e,t){e.controlRelations.addRelatedControls(t)},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[]},e}(),moment=moment_,ExpressionRunner=function(){function ExpressionRunner(){}return ExpressionRunner.prototype.getRunnable=function(expression,control,helper,dataDependencies,form){var runner=this,runnable={run:function(){var scope={};control.uuid&&(scope[control.uuid]=control.value),window.moment=moment,scope.myValue=control.value,runner.getControlRelationValueString(control,scope),runner.getHelperMethods(helper,scope),runner.getDataDependencies(dataDependencies,scope),form&&runner.getDataDependencies(form.dataSourcesContainer.dataSources,scope);var paramList="",argList="";for(var o in scope)paramList=""===paramList?paramList+o:paramList+","+o,argList=""===argList?argList+"scope['"+o+"']":argList+",scope['"+o+"']";-1===expression.indexOf("return")&&(expression='"return '+expression+'"');var funcDeclarationCode='var afeDynamicFunc = new Function("'+paramList+'", '+expression+");",funcCallCode="afeDynamicFunc.call(this "+(""===argList?"":","+argList)+");";try{return 0<=Object.keys(scope).indexOf("undefined")?(console.warn("Missing reference found",expression,scope),!1):eval(funcDeclarationCode+funcCallCode)}catch(e){return!1}}};return runnable},ExpressionRunner.prototype.getControlRelationValueString=function(i,a){var s=this;i&&i.controlRelations&&i.controlRelations.relations&&i.controlRelations.relations.forEach(function(e){if(e.relatedTo){var t=e.relatedTo,o=e.relatedTo;o&&Array.isArray(o.value)?a[t.uuid]=e.relatedTo.value:a[t.uuid]=e.relatedTo.value&&e.relatedTo.value.value?e.relatedTo.value.value:e.relatedTo.value}}),i&&i.controlRelations&&i.controlRelations.otherRelations&&0<i.controlRelations.otherRelations.length&&i.controlRelations.otherRelations.forEach(function(e){if(e instanceof ArrayNode){var t=e,o=i.uuid,n=new ControlRelationsFactory,r=[];t.children.forEach(function(e){r=r.concat(n.getRelationsForControl(o,e))}),s.setControlArrayValues(i,r,a)}})},ExpressionRunner.prototype.setControlArrayValues=function(e,o,n){var r=this;this._getFormControlKeys(o).forEach(function(e){var t=r._getValuesForKey(e,o);n[e]=t})},ExpressionRunner.prototype._getFormControlKeys=function(e){var t=[];return e.forEach(function(e){-1===t.indexOf(e.uuid)&&t.push(e.uuid)}),t},ExpressionRunner.prototype._getValuesForKey=function(t,e){var o=[];return e.forEach(function(e){e.uuid===t&&o.push(e.value)}),o},ExpressionRunner.prototype.getHelperMethods=function(e,t){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},ExpressionRunner.prototype.getDataDependencies=function(e,t){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},ExpressionRunner}(),AfeFormControl=function(r){function e(e,t,o){var n=r.call(this,e,t,o)||this;return n.hidden=!1,n.hiderHelper=new HiderHelper,n.disablerHelper=new DisablerHelper,n.AlertHelper=new AlertHelper,n._controlRelations=new ControlRelations(n),n.hiders=[],n.disablers=[],n.alerts=[],n.valueChanges.subscribe(function(e){n._previousValue!==e&&(n.fireValueChangeListener(e),n._previousValue=e)}),n}return __extends(e,r),Object.defineProperty(e.prototype,"controlRelations",{get:function(){return this._controlRelations},enumerable:!0,configurable:!0}),e.prototype.disable=function(e){r.prototype.disable.call(this,e),r.prototype.setValue.call(this,"")},e.prototype.hide=function(){this.hiderHelper.hideControl(this)},e.prototype.show=function(){this.hiderHelper.showControl(this)},e.prototype.setHidingFn=function(e){this.hiderHelper.setHiderForControl(this,e)},e.prototype.setCalculatorFn=function(e){this.calculator=e},e.prototype.updateCalculatedValue=function(){if(this.calculator){var e=this.calculator.call(ExpressionRunner,{});this.setValue(e)}},e.prototype.clearHidingFns=function(){this.hiderHelper.clearHidersForControl(this)},e.prototype.updateHiddenState=function(){this.hiderHelper.evaluateControlHiders(this)},e.prototype.setDisablingFn=function(e){this.disablerHelper.setDisablerForControl(this,e)},e.prototype.clearDisablingFns=function(){this.disablerHelper.clearDisablersForControl(this)},e.prototype.updateDisabledState=function(){this.disablerHelper.evaluateControlDisablers(this)},e.prototype.setAlertFn=function(e){this.AlertHelper.setAlertsForControl(this,e)},e.prototype.clearMessageFns=function(){this.AlertHelper.clearAlertsForControl(this)},e.prototype.updateAlert=function(){this.AlertHelper.evaluateControlAlerts(this)},e.prototype.addValueChangeListener=function(e){this._valueChangeListener=e},e.prototype.fireValueChangeListener=function(e){this._valueChangeListener&&"function"==typeof this._valueChangeListener&&this._valueChangeListener(e)},e.prototype.setValue=function(e){r.prototype.setValue.call(this,e)},e}(forms.FormControl),AfeFormGroup=function(r){function e(e,t,o){var n=r.call(this,e,t,o)||this;return n.hiderHelper=new HiderHelper,n.disablerHelper=new DisablerHelper,n.AlertHelper=new AlertHelper,n._controlRelations=new ControlRelations(n),n.hiders=[],n.disablers=[],n.alerts=[],n}return __extends(e,r),Object.defineProperty(e.prototype,"controlRelations",{get:function(){return this._controlRelations},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.hiderHelper.hideControl(this)},e.prototype.show=function(){this.hiderHelper.showControl(this)},e.prototype.disable=function(e){r.prototype.disable.call(this,e),r.prototype.setValue.call(this,{})},e.prototype.setHidingFn=function(e){this.hiderHelper.setHiderForControl(this,e)},e.prototype.clearHidingFns=function(){this.hiderHelper.clearHidersForControl(this)},e.prototype.updateHiddenState=function(){this.hiderHelper.evaluateControlHiders(this)},e.prototype.setDisablingFn=function(e){this.disablerHelper.setDisablerForControl(this,e)},e.prototype.clearDisablingFns=function(){this.disablerHelper.clearDisablersForControl(this)},e.prototype.updateDisabledState=function(){this.disablerHelper.evaluateControlDisablers(this)},e.prototype.setAlertFn=function(e){this.AlertHelper.setAlertsForControl(this,e)},e.prototype.clearMessageFns=function(){this.AlertHelper.clearAlertsForControl(this)},e.prototype.updateAlert=function(){this.AlertHelper.evaluateControlAlerts(this)},e.prototype.setValue=function(e){r.prototype.setValue.call(this,e)},e}(forms.FormGroup),AfeFormArray=function(r){function e(e,t,o){var n=r.call(this,e,t,o)||this;return n.hiderHelper=new HiderHelper,n.AlertHelper=new AlertHelper,n.disablerHelper=new DisablerHelper,n._controlRelations=new ControlRelations(n),n.hiders=[],n.alerts=[],n.disablers=[],n.valueChanges.subscribe(function(e){n._previousValue!==e&&(n.fireValueChangeListener(e),n._previousValue=e)}),n}return __extends(e,r),Object.defineProperty(e.prototype,"uuid",{get:function(){return this._uuid},set:function(e){this._uuid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controlRelations",{get:function(){return this._controlRelations},enumerable:!0,configurable:!0}),e.prototype.hide=function(){this.hiderHelper.hideControl(this)},e.prototype.show=function(){this.hiderHelper.showControl(this)},e.prototype.disable=function(e){r.prototype.disable.call(this,e),r.prototype.setValue.call(this,[])},e.prototype.setHidingFn=function(e){this.hiderHelper.setHiderForControl(this,e)},e.prototype.clearHidingFns=function(){this.hiderHelper.clearHidersForControl(this)},e.prototype.updateHiddenState=function(){this.hiderHelper.evaluateControlHiders(this)},e.prototype.setDisablingFn=function(e){this.disablerHelper.setDisablerForControl(this,e)},e.prototype.clearDisablingFns=function(){this.disablerHelper.clearDisablersForControl(this)},e.prototype.updateDisabledState=function(){this.disablerHelper.evaluateControlDisablers(this)},e.prototype.setAlertFn=function(e){this.AlertHelper.setAlertsForControl(this,e)},e.prototype.clearMessageFns=function(){this.AlertHelper.clearAlertsForControl(this)},e.prototype.updateAlert=function(){this.AlertHelper.evaluateControlAlerts(this)},e.prototype.addValueChangeListener=function(e){this._valueChangeListener=e},e.prototype.fireValueChangeListener=function(e){0<this.alerts.length&&this.updateAlert(),this._valueChangeListener&&"function"==typeof this._valueChangeListener&&this._valueChangeListener(e)},e.prototype.setValue=function(e){r.prototype.setValue.call(this,e)},e}(forms.FormArray),AfeControlType={AfeFormControl:0,AfeFormArray:1,AfeFormGroup:2,None:3};AfeControlType[AfeControlType.AfeFormControl]="AfeFormControl",AfeControlType[AfeControlType.AfeFormArray]="AfeFormArray",AfeControlType[AfeControlType.AfeFormGroup]="AfeFormGroup",AfeControlType[AfeControlType.None]="None";var QuestionBase=function(){function e(e){this.defaultValue=e.defaultValue,this.originalValue=e.originalValue,this.extras=e.extras,this.renderingType=e.type,this.key=e.key||"",this.label=e.label||"",this.validators=e.validators||[],this.required=e.required,this.hide=e.hide,this.disable=e.disable,this.alert=e.alert,this.historicalDataValue=e.historicalDataValue,this.calculateExpression=e.calculateExpression}return e.prototype.setHistoricalValue=function(e){this.enableHistoricalValue=e},e.prototype.showHistoricalEncounterDate=function(e){this.showHistoricalValueDate=e===undefined||e},e}(),ConditionalRequiredValidator=function(){function e(){}return e.prototype.validate=function(a){return function(e){var t,o=e.value,n=null,r=a.referenceQuestionId,i=a.referenceQuestionAnswers;return e&&e.controlRelations&&e.controlRelations.relations&&e.controlRelations.relations.forEach(function(e){var t=e.relatedTo;t.uuid===r&&(n=t&&Array.isArray(t.value)?e.relatedTo.value:e.relatedTo.value&&e.relatedTo.value.value?e.relatedTo.value.value:e.relatedTo.value)}),"object"==typeof i&&-1!==i.indexOf(n)&&(t=!0),t&&!o?{conditional_required:{message:a.message}}:null}},e}(),ConditionalAnsweredValidator=function(){function e(){}return e.prototype.validate=function(a){return function(e){var t=e.value,o=null,n=a.referenceQuestionId,r=a.referenceQuestionAnswers,i=!0;return t&&e&&e.controlRelations&&e.controlRelations.relations&&e.controlRelations.relations.forEach(function(e){var t=e.relatedTo;t.uuid===n&&(o=Array.isArray(t.value)?t.value:t.value&&"object"==typeof t.value&&t.value.value?t.value.value:t.value),o?"object"==typeof r&&-1===r.indexOf(o)&&(i=!1):i=!1}),i?null:{conditional_answered:{message:a.message}}}},e}(),RequiredValidator=function(){function e(){}return e.prototype.validate=function(e){if(e.hidden)return null;var t=e.value;return null==t||"string"==typeof t&&0===t.length?{required:!0}:null},e}(),DateValidator=function(){function e(){}return e.prototype.validate=function(e){if(e.hidden)return null;var t=e.value;return t&&0!==t.length?!/Invalid|NaN/.test(new Date(t).toString())?null:{date:!0}:null},e}(),MinValidator=function(){function e(){}return e.prototype.validate=function(o){return function(e){if(e.hidden)return null;if(e.value&&0!==e.value.length){var t=e.value;return o<=t?null:{min:{requiredValue:o,actualValue:t}}}return null}},e}(),MaxValidator=function(){function e(){}return e.prototype.validate=function(o){return function(e){if(e.hidden)return null;if(e.value&&0!==e.value.length){var t=e.value;return t<=o?null:{max:{requiredValue:o,actualValue:t}}}return null}},e}(),MinDateValidator=function(){function e(){}return e.prototype.validate=function(o){return function(e){if(e.hidden)return null;if(e.value&&0!==e.value.length){if((new DateValidator).validate(e.value))return{mindate:{requiredDate:o}};var t=new Date(e.value);return t.getTime()<o.getTime()?{mindate:{requiredDate:o,actualDate:t}}:null}return null}},e}(),MaxDateValidator=function(){function e(){}return e.prototype.validate=function(o){return function(e){if(e.hidden)return null;if(e.value&&0!==e.value.length){if((new DateValidator).validate(e.value))return{maxdate:{requiredDate:o}};var t=new Date(e.value);return t.getTime()>o.getTime()?{maxdate:{requiredDate:o,actualDate:t}}:null}return null}},e}(),FutureDateRestrictionValidator=function(){function e(){}return e.prototype.validate=function(e){if(e.hidden)return null;var t=e.value,o=new Date;if(t&&0!==t.length&&!(new DateValidator).validate(t))return new Date(t).getTime()>o.getTime()?{futureDateRestriction:!0}:null;return null},e}(),JsExpressionHelper=function(){function e(){}return e.prototype.calcBMI=function(e,t){var o;return e&&t&&(o=(t/(e/100*e/100)).toFixed(1)),e&&t?parseFloat(o):null},e.prototype.isEmpty=function(e){return e===undefined||null===e||""===e||"null"===e||"undefined"===e||!(!Array.isArray(e)||0!==e.length)},e.prototype.arrayContains=function(e,t){if(Array.isArray(t)){if(0===t.length)return!0;for(var o=!0,n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&(o=!1)}return o}return-1!==e.indexOf(t)},e.prototype.extractRepeatingGroupValues=function(t,e){return e.map(function(e){return e[t]})},e.prototype.formatDate=function(e,t,o){if(t=t||"yyyy-MM-dd",o=o||"+0300",!(e instanceof Date||null!==(e=new Date(e))&&e!==undefined))throw new Error("DateFormatException: value passed is not a valid date");return e},e.prototype.arrayContainsAny=function(e,t){if(Array.isArray(t)){if(0===t.length)return!0;for(var o=!1,n=0;n<t.length;n++){var r=t[n];-1!==e.indexOf(r)&&(o=!0)}return o}return-1!==e.indexOf(t)},Object.defineProperty(e.prototype,"helperFunctions",{get:function(){var e=this;return{arrayContainsAny:e.arrayContainsAny,calcBMI:e.calcBMI,isEmpty:e.isEmpty,arrayContains:e.arrayContains,extractRepeatingGroupValues:e.extractRepeatingGroupValues}},enumerable:!0,configurable:!0}),e}(),Validations=function(){function e(){}return e.JSExpressionValidatorsEnabled=!1,e}(),JsExpressionValidator=function(){function e(){}return e.prototype.validate=function(n,r){return function(e){if(!Validations.JSExpressionValidatorsEnabled)return null;var t=n.failsWhenExpression,o=(new JsExpressionHelper).helperFunctions;return(new ExpressionRunner).getRunnable(t,e,o,{},r).run()?{js_expression:{expression:t,message:n.message}}:null}},e}(),Messages=function(){function e(){}return e.REQUIRED_FIELD_MSG="This field is required!",e.INVALID_DATE_MSG="Provided date is invalid!",e.FUTURE_DATE_RESTRICTION_MSG="Future date is not allowed!",e.MIN_LENGTH_MSG="Min Length should be {minLength}",e.MAX_LENGTH_MSG="Max Length should be {maxLength}",e.MAX_DATE_MSG="Max Date should be {maxDate}",e.MIN_DATE_MSG="Min Date should be {minDate}",e.MAX_MSG="Max value should be {max}",e.MIN_MSG="Min value should be {min}",e}(),ValidationFactory=function(){function e(){}return e.prototype.getValidators=function(e,t){var o=this,n=[];return e.validators&&_.forEach(e.validators,function(e){switch(e.type){case"date":n.push(o.dateValidator),e.allowFutureDates||n.push(o.futureDateRestrictionValidator);break;case"js_expression":n.push(o.jsExpressionValidator.validate(e,t));break;case"max":n.push(o.getMaxValueValidator(e.max));break;case"min":n.push(o.getMinValueValidator(e.min));break;case"conditionalRequired":n.push(o.conditionalRequiredValidator.validate(e));break;case"conditionalAnswered":n.push(o.conditionalAnsweredValidator.validate(e))}}),e.required&&"string"==typeof e.required&&"true"===e.required&&n.push(this.requiredValidator),n},Object.defineProperty(e.prototype,"conditionalRequiredValidator",{get:function(){return new ConditionalRequiredValidator},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"conditionalAnsweredValidator",{get:function(){return new ConditionalAnsweredValidator},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requiredValidator",{get:function(){return(new RequiredValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateValidator",{get:function(){return(new DateValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"futureDateRestrictionValidator",{get:function(){return(new FutureDateRestrictionValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxDateValidator",{get:function(){return(new MaxDateValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minDateValidator",{get:function(){return(new MinDateValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minLengthValidator",{get:function(){return forms.Validators.minLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxLengthValidator",{get:function(){return forms.Validators.maxLength},enumerable:!0,configurable:!0}),e.prototype.getMinValueValidator=function(e){return(new MinValidator).validate(e)},e.prototype.getMaxValueValidator=function(e){return(new MaxValidator).validate(e)},Object.defineProperty(e.prototype,"jsExpressionValidator",{get:function(){return new JsExpressionValidator},enumerable:!0,configurable:!0}),e.prototype.errors=function(e,t){var o=[];for(var n in e)if(e.hasOwnProperty(n))switch(n){case"required":o.push(Messages.REQUIRED_FIELD_MSG);break;case"date":o.push(Messages.INVALID_DATE_MSG);break;case"futureDateRestriction":o.push(Messages.FUTURE_DATE_RESTRICTION_MSG);break;case"minlength":o.push(Messages.MIN_LENGTH_MSG.replace("{minLength}",e.minlength.requiredLength));break;case"maxlength":o.push(Messages.MIN_LENGTH_MSG.replace("{maxLength}",e.maxlength.requiredLength));break;case"maxdate":o.push(Messages.MAX_DATE_MSG.replace("{maxDate}",e.maxdate.requiredDate));break;case"mindate":o.push(Messages.MIN_DATE_MSG.replace("{minDate}",e.mindate.requiredDate));break;case"max":o.push(Messages.MAX_MSG.replace("{max}",e.max.requiredValue));break;case"min":o.push(Messages.MIN_MSG.replace("{min}",e.min.requiredValue));break;case"js_expression":o.push(e.js_expression.message);break;case"conditional_required":o.push(e.conditional_required.message);break;case"conditional_answered":o.push(e.conditional_answered.message)}return o},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[]},e}(),HidersDisablersFactory=function(){function e(e,t,o){this.expressionRunner=e,this.expressionHelper=t,this._debugModeService=o}return e.prototype.getJsExpressionDisabler=function(e,t,o){var n=this.expressionRunner.getRunnable(e.disable,t,this.expressionHelper.helperFunctions,{},o),r={toDisable:!1,disableWhenExpression:e.disable,reEvaluateDisablingExpression:function(){var e=n.run();r.toDisable=e}};return r},e.prototype.getJsExpressionHider=function(e,t,o){var n=e.hide,r="object"==typeof n?this.convertHideObjectToString(n):e.hide,i=this._debugModeService.debugEnabled(),a=this.expressionRunner.getRunnable(r,t,this.expressionHelper.helperFunctions,{},o),s={toHide:!1,hideWhenExpression:r,reEvaluateHidingExpression:function(){s.toHide=!0!==i&&a.run()}};return s},e.prototype.convertHideObjectToString=function(e){return e.value instanceof Array?"!arrayContains(["+("'"+e.value.join("','")+"'")+"],"+e.field+")":""},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[{type:ExpressionRunner},{type:JsExpressionHelper},{type:DebugModeService}]},e}(),AlertsFactory=function(){function e(e,t){this.expressionRunner=e,this.expressionHelper=t}return e.prototype.getJsExpressionshowAlert=function(e,t,o){var n=this.expressionRunner.getRunnable(e.alert.alertWhenExpression,t,this.expressionHelper.helperFunctions,{},o),r={shown:!1,alertWhenExpression:e.alert.alertWhenExpression,alertMessage:e.alert.message,reEvaluateAlertExpression:function(){var e=n.run();r.shown=e}};return r},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[{type:ExpressionRunner},{type:JsExpressionHelper}]},e}(),FormControlService=function(){function e(e,t,o){this.alertsFactory=o,this.controls=[],this.validationFactory=e,this.hidersDisablersFactory=t}return e.prototype.generateControlModel=function(e,t,o,n){if(e instanceof QuestionBase){if(e.controlType===AfeControlType.AfeFormArray)return this.generateFormArray(e,t,n);if(e.controlType===AfeControlType.AfeFormGroup)return this.generateFormGroupModel(e,o,t,n);if(e.controlType===AfeControlType.AfeFormControl)return this.generateFormControl(e,t,n)}return null},e.prototype.generateFormGroupModel=function(e,t,o,n){var r=new AfeFormGroup({});this.wireHidersDisablers(e,r,n),this.wireAlerts(e,r,n),o instanceof AfeFormGroup&&o.setControl(e.key,r);var i=e;return t&&i&&0<i.questions.length&&this._generateFormGroupChildrenModel(i.questions,r,n),r},e.prototype._generateFormGroupChildrenModel=function(e,o,n){var r=this;0<e.length&&e.forEach(function(e){var t=r.generateControlModel(e,o,!0,n);null!==t&&o.addControl(e.key,t)})},e.prototype.generateFormArray=function(e,t,o){var n,r=this.validationFactory.getValidators(e,o);return(n=r&&0<r.length?new AfeFormArray([],r[0]):new AfeFormArray([])).uuid=e.key,this.wireHidersDisablers(e,n,o),this.wireAlerts(e,n,o),t instanceof AfeFormGroup&&t.setControl(e.key,n),n},e.prototype.generateFormControl=function(e,t,o){var n=e.defaultValue||"",r=this.validationFactory.getValidators(e,o),i=new AfeFormControl(n,r);return i.uuid=e.key,this.wireHidersDisablers(e,i,o),this.wireAlerts(e,i,o),this.wireCalculator(e,i,o?o.dataSourcesContainer.dataSources:null),t instanceof AfeFormGroup&&t.setControl(e.key,i),i},e.prototype.wireAlerts=function(e,t,o){if(e.alert&&""!==e.alert){var n=this.alertsFactory.getJsExpressionshowAlert(e,t,o);t.setAlertFn(n)}},e.prototype.wireHidersDisablers=function(e,t,o){if(e.hide&&""!==e.hide){var n=this.hidersDisablersFactory.getJsExpressionHider(e,t,o);t.setHidingFn(n)}if(e.disable&&""!==e.disable){var r=this.hidersDisablersFactory.getJsExpressionDisabler(e,t,o);t.setDisablingFn(r)}},e.prototype.wireCalculator=function(e,t,o){if(e.calculateExpression&&""!==e.calculateExpression){var n=new JsExpressionHelper,r=(new ExpressionRunner).getRunnable(e.calculateExpression,t,n.helperFunctions,o);t.setCalculatorFn(r.run)}},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[{type:ValidationFactory},{type:HidersDisablersFactory},{type:AlertsFactory}]},e}(),DEFAULT_STYLES='a {\n      color: white;\n      text-decoration: none;\n      font-size: 12px;\n      text-transform: uppercase;\n    }\n\n    ul {\n      list-style-type: none;\n      margin: 2px auto;\n      position: relative;\n    }\n\n    li {\n      display: block;\n      padding: 10px 20px;\n      white-space: nowrap;\n      transition: all 0.3s ease-in;\n      border-bottom: 4px solid transparent;\n    }\n\n    li:hover {\n      border-bottom: 4px solid white;\n      opacity: 0.7;\n      cursor: pointer;\n    }\n\n    .owl-theme .owl-controls .owl-nav {\n      position: absolute;\n      width: 100%;\n      top: 0;\n    }\n\n    .owl-theme .owl-controls .owl-nav [class*="owl-"] {\n      position: absolute;\n      background: none;\n      color: black;\n    }\n\n    .owl-theme .owl-controls .owl-nav [class*="owl-"]:hover {\n      background: none;\n      color: black;\n    }\n\n    .owl-theme .owl-controls .owl-nav .owl-next {\n      right: 0;\n      transform: translate(120%);\n    }\n\n    .owl-theme .owl-controls .owl-nav .owl-prev {\n      left: 0;\n      transform: translate(-120%);\n    }\n\n    .slick-initialized .swipe-tab-content {\n      position: relative;\n      min-height: 365px;\n    }\n    @media screen and (min-width: 767px) {\n      .slick-initialized .swipe-tab-content {\n        min-height: 500px;\n      }\n    }\n    .slick-initialized .swipe-tab {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: 50px;\n      background: none;\n      border: 0;\n      color: #757575;\n      cursor: pointer;\n      text-align: center;\n      border-bottom: 2px solid rgba(51, 122, 183, 0);\n      transition: all 0.5s;\n    }\n    .slick-initialized .swipe-tab:hover {\n      color: #337AB7;\n    }\n    .slick-initialized .swipe-tab.active-tab {\n      border-bottom-color: #337AB7;\n      color: #337AB7;\n      font-weight: bold;\n    }\n\n    .disabled {\n      opacity: .5;\n      pointer-events: none;\n    }\n\n    .select2-container {\n      margin-top: -5px;\n    }\n\n    .btn {\n      padding: 0px 12px !important;\n    }\n\n    .form-tooltip{\n      color:rgb(51, 122, 183);\n      display: inline-block;\n    }\n    .question-info{\n          opacity:0;\n          height:0px;\n          display: none;\n          transition-duration: opacity 1s ease-out;\n          transtion-delay: 0.5s;\n          padding-top: 2px;\n          padding-bottom: 2px;\n          color: #696969;\n          border-style: ridge;\n          border-width: 1px;\n          border-color: #337ab7;\n          margin-top: 2px;\n    }\n    .hide-info{\n      display:none;\n      height:0px;\n    }\n    .form-tooltip:hover ~ .question-info {\n          display:block;\n          opacity:1;\n          height:auto;\n     }\n    .form-tooltip .tooltipcontent::after {\n          content: " ";\n          position: absolute;\n          bottom: 100%;  /* At the top of the tooltip */\n          right: 0%;\n          margin-left: -5px;\n          border-width: 5px;\n          border-style: solid;\n          border-top-color: transparent;\n          border-right-color: transparent;\n          border-bottom-color: #337ab7;\n          border-left-color: transparent;\n }\n\n    ng-select.form-control {\n      padding-top: 0;\n      height: auto;\n      padding-bottom: 0;\n    }\n\n .forms-dropdown-menu {\n     max-height: 450px;\n     overflow-y: scroll;\n }\n .no-border {\n  border: 0;\n  box-shadow: none;\n}\n\n    ',DataSources=function(){function e(){this._dataSources={}}return Object.defineProperty(e.prototype,"dataSources",{get:function(){return this._dataSources},enumerable:!0,configurable:!0}),e.prototype.registerDataSource=function(e,t,o){if(void 0===o&&(o=!1),o)for(var n in t)console.log("registering",n,t[n]),this.registerDataSource(n,t[n],!1);this.dataSources[e]&&console.warn("Overriding registered data source",e),this._dataSources[e]=t},e.prototype.clearDataSource=function(e){delete this._dataSources[e]},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[]},e}(),FormRendererComponent=function(){function e(e,t,o,n){this.validationFactory=e,this.dataSources=t,this.formErrorsService=o,this.document=n,this.childComponents=[],this.isCollapsed=!1,this.activeTab=0}return e.prototype.ngOnInit=function(){var t=this;if(this.setUpRemoteSelect(),this.setUpFileUpload(),this.node&&this.node.form){var e=this.node.form.valueProcessingInfo.lastFormTab;e&&e!==this.activeTab&&(this.activeTab=e)}this.node&&"form"===this.node.question.renderingType&&this.formErrorsService.announceErrorField$.subscribe(function(e){t.scrollToControl(e)}),this.node&&"section"===this.node.question.renderingType&&(this.isCollapsed=!this.node.question.isExpanded),this.parentComponent&&this.parentComponent.addChildComponent(this)},e.prototype.addChildComponent=function(e){this.childComponents.push(e)},e.prototype.setUpRemoteSelect=function(){this.node&&this.node.question.extras&&"remote-select"===this.node.question.renderingType&&(this.dataSource=this.dataSources.dataSources[this.node.question.dataSource],this.dataSource&&this.node.question.dataSourceOptions&&(this.dataSource.dataSourceOptions=this.node.question.dataSourceOptions))},e.prototype.setUpFileUpload=function(){this.node&&this.node.question.extras&&"file"===this.node.question.renderingType&&(this.dataSource=this.dataSources.dataSources[this.node.question.dataSource],console.log("Key",this.node.question),console.log("Data source",this.dataSource))},e.prototype.clickTab=function(e){this.activeTab=e},e.prototype.loadPreviousTab=function(){this.isCurrentTabFirst()||(this.clickTab(this.activeTab-1),document.body.scrollTop=0)},e.prototype.isCurrentTabFirst=function(){return 0===this.activeTab},e.prototype.isCurrentTabLast=function(){return this.activeTab===this.node.question.questions.length-1},e.prototype.loadNextTab=function(){this.isCurrentTabLast()||(this.clickTab(this.activeTab+1),document.body.scrollTop=0)},e.prototype.tabSelected=function(e){this.activeTab=e.index,this.setPreviousTab()},e.prototype.setPreviousTab=function(){this.node&&this.node.form&&(this.node.form.valueProcessingInfo.lastFormTab=this.activeTab)},e.prototype.hasErrors=function(){return this.node.control.touched&&!this.node.control.valid},e.prototype.errors=function(){return this.getErrors(this.node)},e.prototype.scrollToControl=function(e){var t=this,o=+e.split(",")[0],n=e.split(",")[1]+"id",r=this.childComponents[o];this.clickTab(o),setTimeout(function(){r.childComponents.forEach(function(e){e.isCollapsed=!1,setTimeout(function(){t.document.getElementById(n).focus()},200)})},200)},e.prototype.onDateChanged=function(e){this.node=e},e.prototype.upload=function(e){console.log("Event",e),console.log("Data",this.dataSource)},e.prototype.toggleInformation=function(e){var t=document.getElementById(e);"block"===t.style.display?t.style.display="none":t.style.display="block",console.log("InfoId",e)},e.prototype.getErrors=function(e){var t=e.control.errors;return t?this.validationFactory.errors(t,e.question):[]},e.decorators=[{type:core.Component,args:[{selector:"form-renderer",template:'\x3c!--CONTAINERS--\x3e\n<div *ngIf="node.question.renderingType === \'form\'">\n  <div class="dropdown dropdown-tabs forms-dropdown">\n    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">\n      <i class="fa fa-angle-double-down"></i>\n    </a>\n    <ul class="dropdown-menu dropdown-menu-right forms-dropdown-menu" role="menu" aria-labelledby="dropdownMenu">\n      <li *ngFor="let question of node.question.questions; let i = index;" (click)="clickTab(i)">\n        {{question.label}}\n      </li>\n    </ul>\n  </div>\n  <mat-tab-group (selectChange)=\'tabSelected($event)\' [selectedIndex]=\'activeTab\'>\n    <mat-tab [label]=\'question.label\' *ngFor="let question of node.question.questions; let i = index;">\n      <ng-template matTabContent>\n        <div (swipeLeft)=\'loadNextTab()\' (swipeRight)=\'loadPreviousTab()\'>\n          <form-renderer [node]="node.children[question.key]" [parentComponent]="this" [parentGroup]="node.control"></form-renderer>\n        </div>\n      </ng-template>\n    </mat-tab>\n  </mat-tab-group>\n\n  <div style="text-align: center;">\n    <button type="button" class="btn btn-default" (click)="loadPreviousTab()" [ngClass]="{disabled: isCurrentTabFirst()}">&lt;&lt;</button>\n    <button type="button" class="btn btn-default" (click)="loadNextTab()" [ngClass]="{disabled: isCurrentTabLast()}">\n      &gt;&gt;</button>\n  </div>\n</div>\n<div *ngIf="node.question.renderingType === \'page\'">\n  \x3c!--<h2>{{node.question.label}}</h2>--\x3e\n  <form-renderer *ngFor="let question of node.question.questions" [parentComponent]="this" [node]="node.children[question.key]"\n    [parentGroup]="parentGroup"></form-renderer>\n</div>\n<div *ngIf="node.question.renderingType === \'section\'">\n  <div class="panel  panel-primary">\n    <div class="panel-heading">\n      <button type="button" class="btn btn-primary pull-right" (click)="isCollapsed = !isCollapsed">\n        {{isCollapsed ? \'Show\' : \'Hide\'}}\n      </button> {{node.question.label}}\n    </div>\n    <div class="panel-body" [collapse]="isCollapsed">\n      <form-renderer *ngFor="let question of node.question.questions" [parentComponent]="this" [node]="node.children[question.key]"\n        [parentGroup]="parentGroup"></form-renderer>\n    </div>\n  </div>\n</div>\n\n\x3c!-- MESSAGES --\x3e\n<div *ngIf="node.control && node.control.alert && node.control.alert !== \'\'" class="alert alert-warning">\n  <a href="#" class="close" data-dismiss="alert">&times;</a> {{node.control.alert}}\n</div>\n\n\x3c!--CONTROLS--\x3e\n\n<div *ngIf="node.question.controlType === 0" class="form-group" [formGroup]="parentGroup" [hidden]="node.control.hidden"\n  [ngClass]="{disabled: node.control.disabled}">\n  \x3c!--LEAF CONTROL--\x3e\n  <div class="question-area">\n    <a class="form-tooltip pull-right" (click)="toggleInformation(node.question.extras.id)" data-placement="right" *ngIf="node.question && node.question.extras.questionInfo  && node.question.extras.questionInfo !== \'\'  && node.question.extras.questionInfo !== \' \'">\n      <i class="glyphicon glyphicon-question-sign" aria-hidden="true"></i>\n    </a>\n\n    <label *ngIf="node.question.label" [style.color]="hasErrors()? \'red\' :\'\'" class="control-label" [attr.for]="node.question.key">\n      {{node.question.required === true ? \'*\':\'\'}} {{node.question.label}}\n    </label>\n    <div [ngSwitch]="node.question.renderingType">\n      <select class="form-control" *ngSwitchCase="\'select\'" [formControlName]="node.question.key" [id]="node.question.key + \'id\'">\n        <option *ngFor="let o of node.question.options" [ngValue]="o.value">{{o.label}}\n        </option>\n      </select>\n      <remote-file-upload *ngSwitchCase="\'file\'" [dataSource]="dataSource" [formControlName]="node.question.key" [id]="node.question.key + \'id\'"\n        (fileChanged)="upload($event)">\n      </remote-file-upload>\n      <textarea [placeholder]="node.question.placeholder" [rows]="node.question.rows" class="form-control" *ngSwitchCase="\'textarea\'"\n        [formControlName]="node.question.key" [id]="node.question.key + \'id\'">\n      </textarea>\n      <remote-select *ngSwitchCase="\'remote-select\'" [placeholder]="node.question.placeholder" tabindex="0" [dataSource]="dataSource"\n        [componentID]="node.question.key + \'id\'" [formControlName]="node.question.key" [id]="node.question.key + \'id\'"></remote-select>\n      <date-time-picker *ngSwitchCase="\'date\'" [showTime]="node.question.showTime" tabindex="0" [weeks]=\'node.question.extras.questionOptions.weeksList\'\n        (onDateChange)="onDateChanged(node)" [showWeeks]="node.question.showWeeksAdder" [formControlName]="node.question.key"\n        [id]="node.question.key + \'id\'"></date-time-picker>\n      <ng-select *ngSwitchCase="\'multi-select\'" [noFilter]="50" [style.height]=\'auto\' tabindex="0" [formControlName]="node.question.key"\n        [id]="node.question.key + \'id\'" [options]="node.question.options" [multiple]="true">\n      </ng-select>\n      <input class="form-control" *ngSwitchCase="\'number\'" [formControlName]="node.question.key " [attr.placeholder]="node.question.placeholder "\n        [type]="\'number\'" [id]="node.question.key + \'id\' " [step]="\'any\'" [min]="node.question.extras.questionOptions.min"\n        [max]="node.question.extras.questionOptions.max">\n      <input class="form-control" *ngSwitchDefault [formControlName]="node.question.key " [attr.placeholder]="node.question.placeholder "\n        [type]="node.question.renderingType" [id]="node.question.key + \'id\' ">\n\n      <div *ngSwitchCase="\'radio\'">\n        <div *ngFor="let o of node.question.options">\n          <label class="form-control no-border">\n            <input type="radio" [formControlName]="node.question.key" [id]="node.question.key + \'id\'" [value]="o.value"> {{ o.label }}\n          </label>\n        </div>\n      </div>\n\n      <div *ngSwitchCase="\'checkbox\'">\n        <checkbox [id]="node.question.key + \'id\'" [formControlName]="node.question.key" [options]="node.question.options"></checkbox>\n      </div>\n\n      <div *ngIf="node.question.enableHistoricalValue && node.question.historicalDisplay">\n        <div class="container-fluid">\n          <div class="row">\n            <div class="col-xs-9">\n              <span class="text-warning">Previous Value: </span>\n              <strong>{{node.question.historicalDisplay?.text}}</strong>\n              <span *ngIf="node.question.showHistoricalValueDate">\n                <span> | </span>\n                <strong class="text-primary">{{node.question.historicalDisplay?._date}}</strong>\n              </span>\n\n            </div>\n            <button type="button" [node]="node" [name]="\'historyValue\'" class="btn btn-primary btn-small col-xs-3">Use Value\n            </button>\n          </div>\n        </div>\n      </div>\n      <appointments-overview [node]="node"></appointments-overview>\n      <div *ngIf="hasErrors() ">\n        <p *ngFor="let e of errors() ">\n          <span class="text-danger ">{{e}}</span>\n        </p>\n      </div>\n    </div>\n\n    <div class="question-info col-md-12 col-lg-12 col-sm-12" id="{{node.question.extras.id}}" *ngIf="node.question && node.question.extras.questionInfo  && node.question.extras.questionInfo !== \'\'  && node.question.extras.questionInfo !== \' \'">\n      {{node.question.extras.questionInfo}}\n    </div>\n\n  </div>\n</div>\n<div *ngIf="node.question.controlType === 1" [hidden]="node.control.hidden" [ngClass]="{disabled: node.control.disabled}">\n\n\n  \x3c!--ARRAY CONTROL--\x3e\n  <div [ngSwitch]="node.question.renderingType ">\n    <div class=\'well\' style="padding: 2px; " *ngSwitchCase=" \'repeating\' ">\n      <h4 style="margin: 2px; font-weight: bold;">{{node.question.label}}</h4>\n      <hr style="margin-left:-2px; margin-right:-2px; margin-bottom:4px; margin-top:8px; border-width:2px;" />\n      <div [ngSwitch]="node.question.extras.type">\n        <div *ngSwitchCase="\'testOrder\'">\n          <div *ngFor="let child of node.children; let i=index ">\n            <form-renderer *ngFor="let question of child.question.questions " [parentComponent]="this" [node]="child.children[question.key]\n            " [parentGroup]="child.control "></form-renderer>\n            <div>{{child.orderNumber}}</div>\n            <button type="button " class=\'btn btn-sm btn-danger\' (click)="node.removeAt(i) ">Remove</button>\n            <br/>\n            <hr style="margin-left:-2px; margin-right:-2px; margin-bottom:4px; margin-top:8px; border-width:1px;" />\n          </div>\n        </div>\n\n        <div *ngSwitchCase="\'obsGroup\'" style="margin-bottom:20px;">\n          <div *ngFor="let child of node.children; let i=index ">\n            <form-renderer *ngFor="let question of child.question.questions " [parentComponent]="this" [node]="child.children[question.key]\n            " [parentGroup]="child.control "></form-renderer>\n            <button type="button " class=\'btn btn-sm btn-danger\' (click)="node.removeAt(i) ">Remove</button>\n            <br/>\n            <hr style="margin-left:-2px; margin-right:-2px; margin-bottom:4px; margin-top:8px; border-width:1px;" />\n          </div>\n        </div>\n      </div>\n      <button type="button " class=\'btn btn-primary\' (click)="node.createChildNode() ">Add</button>\n    </div>\n  </div>\n\n</div>\n<div *ngIf="node.question.controlType === 2" [hidden]="node.control.hidden" [ngClass]="{disabled: node.control.disabled}">\n\n  \x3c!--GROUP--\x3e\n  <div [ngSwitch]="node.question.renderingType ">\n    <div *ngSwitchCase=" \'group\' ">\n      <form-renderer *ngFor="let question of node.question.questions " [parentComponent]="this" [node]="node.children[question.key]\n            " [parentGroup]="node.control "></form-renderer>\n    </div>\n    <div *ngSwitchCase=" \'field-set\' " style="border: 1px solid #eeeeee; padding: 2px; margin: 2px;">\n      <form-renderer *ngFor="let question of node.question.questions " [parentComponent]="this" [node]="node.children[question.key]\n            " [parentGroup]="node.control "></form-renderer>\n    </div>\n  </div>\n\n</div>\n',styles:["../../style/app.css",DEFAULT_STYLES]}]}],e.ctorParameters=function(){return[{type:ValidationFactory},{type:DataSources},{type:FormErrorsService},{type:undefined,decorators:[{type:core.Inject,args:[common.DOCUMENT]}]}]},e.propDecorators={parentComponent:[{type:core.Input}],node:[{type:core.Input}],parentGroup:[{type:core.Input}]},e}(),ErrorRendererComponent=function(){function e(e,t){this.validationFactory=e,this.formErrorsService=t}return e.prototype.ngOnInit=function(){},e.prototype.showErrors=function(){return!this.form.valid&&this.form.showErrors},Object.defineProperty(e.prototype,"errorNodes",{get:function(){return this.form.markInvalidControls(this.form.rootNode,[])},enumerable:!0,configurable:!0}),e.prototype.getControlError=function(e){var t=e.control.errors;return t?this.validationFactory.errors(t,e.question):[]},e.prototype.announceErrorField=function(o){var n=this,e=this.form.searchNodeByQuestionId(o.path.substring(0,o.path.indexOf(".")));_.forEach(e,function(e){if("page"===e.question.renderingType){var t=n.getPageIndex(e);n.formErrorsService.announceErrorField(t+","+o.question.key)}})},e.prototype.getPageIndex=function(e){return this.form.rootNode.question.questions.indexOf(e.question)},e.decorators=[{type:core.Component,args:[{selector:"error-renderer",template:'<div *ngIf="showErrors()" class="container">\n<ul class="list-group">\n  <li class="list-group-item list-group-item-warning" *ngFor="let errorNode of errorNodes" (click)=announceErrorField(errorNode)>\n    <div class="error" *ngIf="errorNode.control.valid == false">\n      <h4>{{errorNode.question.label}}</h4>\n      <span class="text-danger"> {{getControlError(errorNode)}}</span>\n    </div>\n  </li>\n</ul>\n</div>\n',styles:["ul{list-style:none}.list-group-item{padding:2px 15px;cursor:pointer}ul li:hover{background-color:#fff}h4{margin-top:7px;margin-bottom:7px}"]}]}],e.ctorParameters=function(){return[{type:ValidationFactory},{type:FormErrorsService}]},e.propDecorators={form:[{type:core.Input}]},e}(),HistoricalFieldHelperService=function(){function e(){}return e.prototype.getDisplayTextFromOptions=function(e,o,n){var r="",t=e.historicalDataValue;if(_.isArray(t.value)){var i=0;_.each(t.value,function(t){_.each(e.options,function(e){e[o]===t&&(0===i?r+=e[n]:r=r+", "+e[n],i++)})})}else _.each(e.options,function(e){e[o]===t.value&&(r=e[n])});return r},e}(),HistoricalValueDirective=function(){function e(e){this.historicalFieldHelper=e,this._nodeChange=new core.EventEmitter}return e.prototype.setValue=function(e){"historyValue"===e.target.name&&(!this._node||this.compareString(this._node.question.renderingType,"page")&&this.compareString(this._node.question.renderingType,"section")||(this._node.control.setValue(this._node.question.historicalDataValue.value),this._node.question.historicalValue=this._node.question.historicalDataValue,e.stopPropagation(),this._nodeChange.emit(this._node)))},e.prototype.compareString=function(e,t){return e===t},Object.defineProperty(e.prototype,"node",{set:function(e){if(e&&(this._node=e,this._node.question.enableHistoricalValue&&!_.isUndefined(this._node.question.historicalDataValue))){var t={text:"",_date:""};"select"===this._node.question.renderingType||"multi-select"===this._node.question.renderingType?(t.text=this.historicalFieldHelper.getDisplayTextFromOptions(this._node.question,"value","label"),t._date=this._node.question.historicalDataValue.valueDate,this._node.question.historicalDisplay=t):_.isUndefined(this._node.question.historicalDataValue)||(t.text=this._node.question.historicalDataValue.value,t._date=this._node.question.historicalDataValue.valueDate,this._node.question.historicalDisplay=t)}},enumerable:!0,configurable:!0}),e.decorators=[{type:core.Directive,args:[{selector:"[node]"}]}],e.ctorParameters=function(){return[{type:HistoricalFieldHelperService}]},e.propDecorators={_node:[{type:core.Input}],_nodeChange:[{type:core.Output}],setValue:[{type:core.HostListener,args:["click",["$event"]]}],node:[{type:core.Input}]},e}(),STYLE="\nng-select {\n  display: inline-block;\n  margin: 0;\n  position: relative;\n  vertical-align: middle;\n  width: 100%;\n}\nng-select * {\n  box-sizing: border-box;\n  font-family: Sans-Serif;\n}\nng-select > div {\n  border: 1px solid #ddd;\n  box-sizing: border-box;\n  cursor: pointer;\n  user-select: none;\n  width: 100%;\n}\nng-select > div.disabled {\n  background-color: #eee;\n  color: #aaa;\n  cursor: default;\n  pointer-events: none;\n}\nng-select > div > div.single {\n  display: flex;\n  height: 30px;\n  width: 100%;\n}\nng-select > div > div.single > div.value,\nng-select > div > div.single > div.placeholder {\n  flex: 1;\n  line-height: 30px;\n  overflow: hidden;\n  padding: 0 10px;\n  white-space: nowrap;\n}\nng-select > div > div.single > div.placeholder {\n  color: #a9a9a9;\n}\nng-select > div > div.single > div.clear,\nng-select > div > div.single > div.toggle {\n  color: #aaa;\n  line-height: 30px;\n  text-align: center;\n  width: 30px;\n}\nng-select > div > div.single > div.clear:hover,\nng-select > div > div.single > div.toggle:hover {\n  background-color: #ececec;\n}\nng-select > div > div.single > div.clear {\n  font-size: 18px;\n}\nng-select > div > div.single > div.toggle {\n  font-size: 14px;\n}\nng-select > div > div.multiple {\n  display: flex;\n  flex-flow: row wrap;\n  height: 100%;\n  min-height: 30px;\n  padding: 0 10px;\n  width: 100%;\n}\nng-select > div > div.multiple > div.option {\n  background-color: #eee;\n  border: 1px solid #aaa;\n  border-radius: 4px;\n  color: #333;\n  cursor: default;\n  display: inline-block;\n  flex-shrink: 0;\n  font-size: 14px;\n  line-height: 22px;\n  margin: 3px 5px 3px 0;\n  padding: 0 4px;\n}\nng-select > div > div.multiple > div.option span.deselect-option {\n  color: #aaa;\n  cursor: pointer;\n  font-size: 14px;\n  height: 20px;\n  line-height: 20px;\n}\nng-select > div > div.multiple > div.option span.deselect-option:hover {\n  color: #555;\n}\nng-select > div > div.multiple input {\n  background-color: transparent;\n  border: none;\n  height: 30px;\n  line-height: 30px;\n  padding: 0;\n}\nng-select > div > div.multiple input:focus {\n  outline: none;\n}\n",Option=function(){function e(e,t){this.value=e,this.label=t,this.disabled=!1,this.highlighted=!1,this.selected=!1,this.shown=!0}return e.prototype.show=function(){this.shown=!0},e.prototype.hide=function(){this.shown=!1},e.prototype.disable=function(){this.disabled=!0},e.prototype.enable=function(){this.disabled=!1},e.prototype.undecoratedCopy=function(){return{label:this.label,value:this.value}},e}(),Diacritics=function(){function e(){}return e.strip=function(e){var t=this;return e?e.replace(/[^\u0000-\u007E]/g,function(e){return t.DIACRITICS[e]||e}):""},e.DIACRITICS={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},e}(),OptionList=function(){function e(e){(this._highlightedOption=null)==e&&(e=[]),this._options=e.map(function(e){var t=new Option(e.value,e.label);return e.disabled&&t.disable(),t}),this.highlight()}return e.equalValues=function(e,t){if(e.length!==t.length)return!1;var o=e.slice().sort(),n=t.slice().sort();return o.every(function(e,t){return e===n[t]})},Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),e.prototype.getOptionsByValue=function(t){return this.options.filter(function(e){return e.value===t})},Object.defineProperty(e.prototype,"value",{get:function(){return this.selection.map(function(e){return e.value})},set:function(t){t=null==t?[]:t,this.options.forEach(function(e){e.selected=-1<t.indexOf(e.value)})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.options.filter(function(e){return e.selected})},enumerable:!0,configurable:!0}),e.prototype.select=function(e,t){t||this.clearSelection(),e.selected=!0},e.prototype.deselect=function(e){e.selected=!1},e.prototype.clearSelection=function(){this.options.forEach(function(e){e.selected=!1})},Object.defineProperty(e.prototype,"filtered",{get:function(){return this.options.filter(function(e){return e.shown})},enumerable:!0,configurable:!0}),e.prototype.filter=function(n){""===n.trim()?this.resetFilter():this.options.forEach(function(e){var t=Diacritics.strip(e.label).toUpperCase(),o=Diacritics.strip(n).toUpperCase();e.shown=-1<t.indexOf(o)}),this.highlight()},e.prototype.resetFilter=function(){this.options.forEach(function(e){e.shown=!0})},Object.defineProperty(e.prototype,"highlightedOption",{get:function(){return this._highlightedOption},enumerable:!0,configurable:!0}),e.prototype.highlight=function(){var e=this.hasShownSelected()?this.getFirstShownSelected():this.getFirstShown();this.highlightOption(e)},e.prototype.highlightOption=function(e){this.clearHighlightedOption(),null!==e&&(e.highlighted=!0,this._highlightedOption=e)},e.prototype.highlightNextOption=function(){var e=this.filtered,t=this.getHighlightedIndexFromList(e);-1<t&&t<e.length-1&&this.highlightOption(e[t+1])},e.prototype.highlightPreviousOption=function(){var e=this.filtered,t=this.getHighlightedIndexFromList(e);0<t&&this.highlightOption(e[t-1])},e.prototype.clearHighlightedOption=function(){null!==this.highlightedOption&&(this.highlightedOption.highlighted=!1,this._highlightedOption=null)},e.prototype.getHighlightedIndexFromList=function(e){for(var t=0;t<e.length;t++)if(e[t].highlighted)return t;return-1},e.prototype.getHighlightedIndex=function(){return this.getHighlightedIndexFromList(this.filtered)},e.prototype.hasShown=function(){return this.options.some(function(e){return e.shown})},e.prototype.hasSelected=function(){return this.options.some(function(e){return e.selected})},e.prototype.hasShownSelected=function(){return this.options.some(function(e){return e.shown&&e.selected})},e.prototype.getFirstShown=function(){try{for(var e=__values(this.options),t=e.next();!t.done;t=e.next()){var o=t.value;if(o.shown)return o}}catch(i){n={error:i}}finally{try{t&&!t.done&&(r=e["return"])&&r.call(e)}finally{if(n)throw n.error}}return null;var n,r},e.prototype.getFirstShownSelected=function(){try{for(var e=__values(this.options),t=e.next();!t.done;t=e.next()){var o=t.value;if(o.shown&&o.selected)return o}}catch(i){n={error:i}}finally{try{t&&!t.done&&(r=e["return"])&&r.call(e)}finally{if(n)throw n.error}}return null;var n,r},e}(),SELECT_VALUE_ACCESSOR={provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef(function(){return SelectComponent}),multi:!0},SelectComponent=function(){function e(){this.KEYS={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,UP:38,DOWN:40},this.allowClear=!1,this.disabled=!1,this.highlightColor="#2196f3",this.highlightTextColor="#fff",this.multiple=!1,this.noFilter=0,this.notFoundMsg="No results found",this.placeholder="",this.opened=new core.EventEmitter,this.closed=new core.EventEmitter,this.selected=new core.EventEmitter,this.deselected=new core.EventEmitter,this.typed=new core.EventEmitter,this._value=[],this.hasSelected=!1,this.filterEnabled=!0,this.filterInputWidth=1,this.hasFocus=!1,this.isBelow=!0,this.isDisabled=!1,this.isOpen=!1,this.placeholderView="",this.clearClicked=!1,this.selectContainerClicked=!1,this.onChange=function(e){},this.onTouched=function(){}}return e.prototype.ngOnInit=function(){this.placeholderView=this.placeholder},e.prototype.ngAfterViewInit=function(){this.updateFilterWidth()},e.prototype.ngOnChanges=function(e){if(e.hasOwnProperty("options")&&this.updateOptionsList(e.options.isFirstChange()),e.hasOwnProperty("noFilter")){var t=this.optionList.options.length,o=e.noFilter.currentValue;this.filterEnabled=o<=t}},e.prototype.onWindowClick=function(){this.selectContainerClicked||this.closeDropdown(),this.clearClicked=!1,this.selectContainerClicked=!1},e.prototype.onWindowResize=function(){this.updateWidth()},e.prototype.onSelectContainerClick=function(e){this.selectContainerClicked=!0,this.clearClicked||this.toggleDropdown()},e.prototype.onSelectContainerFocus=function(){this.onTouched()},e.prototype.onSelectContainerKeydown=function(e){this.handleSelectContainerKeydown(e)},e.prototype.onDropdownOptionClicked=function(e){this.multiple?this.toggleSelectOption(e):this.selectOption(e)},e.prototype.onDropdownClose=function(e){this.closeDropdown(e)},e.prototype.onSingleFilterClick=function(){this.selectContainerClicked=!0},e.prototype.onSingleFilterInput=function(e){var t=this;setTimeout(function(){2<e.length&&t.typed.emit(e)},500),this.optionList.filter(e)},e.prototype.onSingleFilterKeydown=function(e){this.handleSingleFilterKeydown(e)},e.prototype.onMultipleFilterInput=function(e){var t=this;this.isOpen||this.openDropdown(),this.updateFilterWidth(),setTimeout(function(){t.optionList.filter(e.target.value)})},e.prototype.onMultipleFilterKeydown=function(e){this.handleMultipleFilterKeydown(e)},e.prototype.onClearSelectionClick=function(e){this.clearClicked=!0,this.clearSelection(),this.closeDropdown(!0)},e.prototype.onDeselectOptionClick=function(e){this.clearClicked=!0,this.deselectOption(e)},e.prototype.open=function(){this.openDropdown()},e.prototype.close=function(){this.closeDropdown()},e.prototype.clear=function(){this.clearSelection()},e.prototype.select=function(e){var t=this;this.optionList.getOptionsByValue(e).forEach(function(e){t.selectOption(e)}),this.valueChanged()},e.prototype.writeValue=function(e){this.value=e},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this.disabled=e},Object.defineProperty(e.prototype,"value",{get:function(){return 0===this._value.length?"":this.multiple?this._value:this._value[0]},set:function(e){if(null==e||""===e)e=[];else if("string"==typeof e)e=[e];else if(!Array.isArray(e))throw new TypeError("Value must be a string or an array.");OptionList.equalValues(e,this._value)||(this.optionList.value=e,this.valueChanged())},enumerable:!0,configurable:!0}),e.prototype.valueChanged=function(){this._value=this.optionList.value,this.hasSelected=0<this._value.length,this.placeholderView=this.hasSelected?"":this.placeholder,this.updateFilterWidth(),this.onChange(this.value)},e.prototype.updateOptionsList=function(e){var t;e||(t=this.optionList.value),this.optionList=new OptionList(this.options),e||(this.optionList.value=t,this.valueChanged())},e.prototype.toggleDropdown=function(){this.isDisabled||(this.isOpen?this.closeDropdown(!0):this.openDropdown())},e.prototype.openDropdown=function(){this.isOpen||(this.updateWidth(),this.updatePosition(),this.isOpen=!0,this.multiple&&this.filterEnabled&&this.filterInput.nativeElement.focus(),this.opened.emit(null))},e.prototype.closeDropdown=function(e){void 0===e&&(e=!1),this.isOpen&&(this.clearFilterInput(),this.isOpen=!1,e&&this.focus(),this.closed.emit(null))},e.prototype.selectOption=function(e){e.selected||(this.optionList.select(e,this.multiple),this.valueChanged(),this.selected.emit(e.undecoratedCopy()))},e.prototype.deselectOption=function(e){var t=this;e.selected&&(this.optionList.deselect(e),this.valueChanged(),this.deselected.emit(e.undecoratedCopy()),setTimeout(function(){t.multiple&&(t.updatePosition(),t.optionList.highlight(),t.isOpen&&t.dropdown.moveHighlightedIntoView())}))},e.prototype.clearSelection=function(){var e=this.optionList.selection;0<e.length&&(this.optionList.clearSelection(),this.valueChanged(),1===e.length?this.deselected.emit(e[0].undecoratedCopy()):this.deselected.emit(e.map(function(e){return e.undecoratedCopy()})))},e.prototype.toggleSelectOption=function(e){e.selected?this.deselectOption(e):this.selectOption(e)},e.prototype.selectHighlightedOption=function(){var e=this.optionList.highlightedOption;null!==e&&(this.selectOption(e),this.closeDropdown(!0))},e.prototype.deselectLast=function(){var e=this.optionList.selection;if(0<e.length){var t=e[e.length-1];this.deselectOption(t),this.setMultipleFilterInput(t.label+" ")}},e.prototype.clearFilterInput=function(){this.multiple&&this.filterEnabled?this.filterInput.nativeElement.value="":this.dropdown.clearFilterInput()},e.prototype.setMultipleFilterInput=function(e){this.filterEnabled&&(this.filterInput.nativeElement.value=e)},e.prototype.handleSelectContainerKeydown=function(e){var t=this,o=e.which;this.isOpen?o===this.KEYS.ESC||o===this.KEYS.UP&&e.altKey?this.closeDropdown(!0):o===this.KEYS.TAB?this.closeDropdown():o===this.KEYS.ENTER?this.selectHighlightedOption():o===this.KEYS.UP?(this.optionList.highlightPreviousOption(),this.dropdown.moveHighlightedIntoView(),this.filterEnabled||e.preventDefault()):o===this.KEYS.DOWN&&(this.optionList.highlightNextOption(),this.dropdown.moveHighlightedIntoView(),this.filterEnabled||e.preventDefault()):(o===this.KEYS.ENTER||o===this.KEYS.SPACE||o===this.KEYS.DOWN&&e.altKey)&&setTimeout(function(){t.openDropdown()})},e.prototype.handleMultipleFilterKeydown=function(e){e.which===this.KEYS.BACKSPACE&&this.hasSelected&&this.filterEnabled&&""===this.filterInput.nativeElement.value&&this.deselectLast()},e.prototype.handleSingleFilterKeydown=function(e){var t=e.which;t!==this.KEYS.ESC&&t!==this.KEYS.TAB&&t!==this.KEYS.UP&&t!==this.KEYS.DOWN&&t!==this.KEYS.ENTER||this.handleSelectContainerKeydown(e)},e.prototype.focus=function(){this.hasFocus=!0,this.multiple&&this.filterEnabled?this.filterInput.nativeElement.focus():this.selectionSpan.nativeElement.focus()},e.prototype.blur=function(){this.hasFocus=!1,this.selectionSpan.nativeElement.blur()},e.prototype.updateWidth=function(){this.width=this.selectionSpan.nativeElement.offsetWidth},e.prototype.updatePosition=function(){var e=this.selectionSpan.nativeElement;this.left=e.offsetLeft,this.top=e.offsetTop+e.offsetHeight},e.prototype.updateFilterWidth=function(){if("undefined"!=typeof this.filterInput){var e=this.filterInput.nativeElement.value;this.filterInputWidth=0===e.length?1+10*this.placeholderView.length:1+10*e.length}},e.decorators=[{type:core.Component,args:[{selector:"ng-select",template:'<div\n    #selection\n    [attr.tabindex]="disabled ? null : 0"\n    [ngClass]="{\'open\': isOpen, \'focus\': hasFocus, \'below\': isBelow, \'disabled\': disabled}"\n    (click)="onSelectContainerClick($event)"\n    (focus)="onSelectContainerFocus()"\n    (keydown)="onSelectContainerKeydown($event)"\n    (window:click)="onWindowClick()"\n    (window:resize)="onWindowResize()">\n\n    <div class="single"\n        *ngIf="!multiple">\n        <div class="value"\n            *ngIf="optionList.hasSelected()">\n            {{optionList.selection[0].label}}\n        </div>\n        <div class="placeholder"\n            *ngIf="!optionList.hasSelected()">\n            {{placeholderView}}\n        </div>\n        <div class="clear"\n            *ngIf="allowClear"\n            (click)="onClearSelectionClick($event)">\n            &#x2715;\n        </div>\n        <div class="toggle"\n            *ngIf="isOpen">\n            &#x25B2;\n        </div>\n        <div class="toggle"\n            *ngIf="!isOpen">\n            &#x25BC;\n        </div>\n    </div>\n\n    <div class="multiple"\n        *ngIf="multiple">\n        <div class="option"\n            *ngFor="let option of optionList.selection">\n            <span class="deselect-option"\n                (click)=onDeselectOptionClick(option)>\n                &#x2715;\n            </span>\n            {{option.label}}\n        </div>\n        <input\n            *ngIf="filterEnabled"\n            #filterInput\n            tabindex="-1"\n            [placeholder]="placeholderView"\n            [ngStyle]="{\'width.px\': filterInputWidth}"\n            (input)="onMultipleFilterInput($event)"\n            (keydown)="onMultipleFilterKeydown($event)"/>\n    </div>\n\n</div>\n<select-dropdown\n    *ngIf="isOpen"\n    #dropdown\n    [multiple]="multiple"\n    [optionList]="optionList"\n    [notFoundMsg]="notFoundMsg"\n    [highlightColor]="highlightColor"\n    [highlightTextColor]="highlightTextColor"\n    [filterEnabled]="filterEnabled"\n    [width]="width"\n    [top]="top"\n    [left]="left"\n    (close)="onDropdownClose($event)"\n    (optionClicked)="onDropdownOptionClicked($event)"\n    (singleFilterClick)="onSingleFilterClick()"\n    (singleFilterInput)="onSingleFilterInput($event)"\n    (singleFilterKeydown)="onSingleFilterKeydown($event)">\n</select-dropdown>\n',styles:[STYLE],providers:[SELECT_VALUE_ACCESSOR],encapsulation:core.ViewEncapsulation.None}]}],e.propDecorators={options:[{type:core.Input}],allowClear:[{type:core.Input}],disabled:[{type:core.Input}],highlightColor:[{type:core.Input}],highlightTextColor:[{type:core.Input}],multiple:[{type:core.Input}],noFilter:[{type:core.Input}],notFoundMsg:[{type:core.Input}],placeholder:[{type:core.Input}],opened:[{type:core.Output}],closed:[{type:core.Output}],selected:[{type:core.Output}],deselected:[{type:core.Output}],typed:[{type:core.Output}],selectionSpan:[{type:core.ViewChild,args:["selection"]}],dropdown:[{type:core.ViewChild,args:["dropdown"]}],filterInput:[{type:core.ViewChild,args:["filterInput"]}]},e}(),STYLE$1="select-dropdown {\n  box-sizing: border-box;\n  font-family: Sans-Serif;\n}\nselect-dropdown * {\n  box-sizing: border-box;\n  font-family: Sans-Serif;\n}\nselect-dropdown > div {\n  background-color: #fff;\n  border: 1px solid #ccc;\n  border-top: none;\n  box-sizing: border-box;\n  position: absolute;\n  z-index: 1;\n}\nselect-dropdown > div .filter {\n  padding: 3px;\n  width: 100%;\n}\nselect-dropdown > div .filter input {\n  border: 1px solid #eee;\n  box-sizing: border-box;\n  padding: 4px;\n  width: 100%;\n}\nselect-dropdown > div .options {\n  max-height: 200px;\n  overflow-y: auto;\n}\nselect-dropdown > div .options ul {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\nselect-dropdown > div .options ul li {\n  padding: 4px 8px;\n  cursor: pointer;\n  user-select: none;\n}\nselect-dropdown .selected {\n  background-color: #e0e0e0;\n}\nselect-dropdown .selected.highlighted {\n  background-color: #2196F3;\n  color: #fff;\n}\nselect-dropdown .highlighted {\n  background-color: #2196F3;\n  color: #fff;\n}\nselect-dropdown .disabled {\n  background-color: #fff;\n  color: #9e9e9e;\n  cursor: default;\n  pointer-events: none;\n}",SelectDropdownComponent=function(){function e(){this.close=new core.EventEmitter,this.optionClicked=new core.EventEmitter,this.singleFilterClick=new core.EventEmitter,this.singleFilterInput=new core.EventEmitter,this.singleFilterKeydown=new core.EventEmitter,this.disabledColor="#fff",this.disabledTextColor="9e9e9e"}return e.prototype.ngOnInit=function(){this.optionsReset()},e.prototype.ngOnChanges=function(e){e.hasOwnProperty("optionList")&&this.optionsReset()},e.prototype.ngAfterViewInit=function(){this.moveHighlightedIntoView(),!this.multiple&&this.filterEnabled&&this.filterInput.nativeElement.focus()},e.prototype.onSingleFilterClick=function(e){this.singleFilterClick.emit(null)},e.prototype.onSingleFilterInput=function(e){this.singleFilterInput.emit(e.target.value)},e.prototype.onSingleFilterKeydown=function(e){this.singleFilterKeydown.emit(e)},e.prototype.onOptionsWheel=function(e){this.handleOptionsWheel(e)},e.prototype.onOptionMouseover=function(e){this.optionList.highlightOption(e)},e.prototype.onOptionClick=function(e){this.optionClicked.emit(e)},e.prototype.optionsReset=function(){this.optionList.resetFilter(),this.optionList.highlight()},e.prototype.getOptionStyle=function(e){return e.highlighted?{"background-color":this.highlightColor,color:this.highlightTextColor}:{}},e.prototype.clearFilterInput=function(){this.filterEnabled&&(this.filterInput.nativeElement.value="")},e.prototype.moveHighlightedIntoView=function(){var e=this.optionsList.nativeElement,t=e.offsetHeight,o=this.optionList.getHighlightedIndex();if(-1<o){var n=e.children[0].children[o].offsetHeight,r=o*n,i=r+n,a=e.scrollTop;a+t<i?e.scrollTop=i-t:r<a&&(e.scrollTop=r)}},e.prototype.handleOptionsWheel=function(e){var t=this.optionsList.nativeElement,o=0===t.scrollTop,n=t.offsetHeight+t.scrollTop===t.scrollHeight;o&&e.deltaY<0?e.preventDefault():n&&0<e.deltaY&&e.preventDefault()},e.decorators=[{type:core.Component,args:[{selector:"select-dropdown",template:'<div\n    [ngStyle]="{\'top.px\': top, \'left.px\': left, \'width.px\': width}">\n\n    <div class="filter"\n        *ngIf="!multiple">\n        <input\n            *ngIf="filterEnabled"\n            #filterInput\n            (click)="onSingleFilterClick($event)"\n            (input)="onSingleFilterInput($event)"\n            (keydown)="onSingleFilterKeydown($event)">\n    </div>\n\n    <div class="options"\n        #optionsList>\n        <ul\n            (wheel)="onOptionsWheel($event)">\n            <li *ngFor="let option of optionList.filtered"\n                [ngClass]="{\'highlighted\': option.highlighted, \'selected\': option.selected, \'disabled\': option.disabled}"\n                [ngStyle]="getOptionStyle(option)"\n                (click)="onOptionClick(option)"\n                (mouseover)="onOptionMouseover(option)">\n                {{option.label}}\n            </li>\n            <li\n                *ngIf="!optionList.hasShown()"\n                class="message">\n                {{notFoundMsg}}\n            </li>\n        </ul>\n    </div>\n</div>\n',styles:[STYLE$1],encapsulation:core.ViewEncapsulation.None}]}],e.propDecorators={filterEnabled:[{type:core.Input}],highlightColor:[{type:core.Input}],highlightTextColor:[{type:core.Input}],left:[{type:core.Input}],multiple:[{type:core.Input}],notFoundMsg:[{type:core.Input}],optionList:[{type:core.Input}],top:[{type:core.Input}],width:[{type:core.Input}],close:[{type:core.Output}],optionClicked:[{type:core.Output}],singleFilterClick:[{type:core.Output}],singleFilterInput:[{type:core.Output}],singleFilterKeydown:[{type:core.Output}],filterInput:[{type:core.ViewChild,args:["filterInput"]}],optionsList:[{type:core.ViewChild,args:["optionsList"]}]},e}(),SelectModule=function(){function e(){}return e.decorators=[{type:core.NgModule,args:[{declarations:[SelectComponent,SelectDropdownComponent],exports:[SelectComponent],imports:[common.CommonModule,forms.FormsModule]}]}],e}(),SecurePipe=function(){function e(e,t){this._ref=e,this.sanitizer=t,this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null,this._result=new rxjs.BehaviorSubject(null),this.result=this._result.asObservable(),this._internalSubscription=null}return e.prototype.ngOnDestroy=function(){this._subscription&&this._dispose()},e.prototype.transform=function(e,t){this.getfile=t;var o=this.internalTransform(e);return this.asyncTrasnform(o)},e.prototype.internalTransform=function(e){var o=this;return e&&this.previousUrl!==e&&(this.previousUrl=e,this._internalSubscription=this.getfile(e).subscribe(function(e){var t=o.sanitizer.bypassSecurityTrustUrl(e);o._result.next(t)})),this.result},e.prototype.asyncTrasnform=function(e){return this._obj?e!==this._obj?(this._dispose(),this.asyncTrasnform(e)):this._latestValue===this._latestReturnedValue?this._latestReturnedValue:(this._latestReturnedValue=this._latestValue,core.WrappedValue.wrap(this._latestValue)):(e&&this._subscribe(e),this._latestReturnedValue=this._latestValue,this._latestValue)},e.prototype._subscribe=function(t){var o=this;this._obj=t,this._subscription=t.subscribe({next:function(e){return o._updateLatestValue(t,e)},error:function(e){throw e}})},e.prototype._dispose=function(){this._subscription&&this._subscription.unsubscribe(),this._internalSubscription&&this._internalSubscription.unsubscribe(),this._internalSubscription=null,this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null},e.prototype._updateLatestValue=function(e,t){e===this._obj&&(this._latestValue=t,this._ref.markForCheck())},e.decorators=[{type:core.Pipe,args:[{name:"secure",pure:!1}]}],e.ctorParameters=function(){return[{type:core.ChangeDetectorRef},{type:platformBrowser.DomSanitizer}]},e}(),SharedModule=function(){function e(){}return e.decorators=[{type:core.NgModule,args:[{declarations:[SecurePipe],imports:[common.CommonModule],exports:[SecurePipe],providers:[DataSources]}]}],e}(),RemoteFileUploadComponent=function(){function e(e){this.renderer=e,this.uploading=!1,this.innerValue=null,this.propagateChange=function(e){}}return Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(e){this._dataSource=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.upload=function(e){var t=this;this.dataSource&&(this.uploading=!0,this.dataSource.fileUpload(e).subscribe(function(e){console.log("Result",e),t.innerValue=e.image,t.propagateChange(t.innerValue),t.uploading=!1},function(e){t.uploading=!1}))},e.prototype.writeValue=function(e){e!==this.innerValue&&(this.innerValue=e)},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(){},e.prototype.onChange=function(e){this.propagateChange(e.id)},e.prototype.clearValue=function(){this.innerValue=null,this.propagateChange(this.innerValue)},e.decorators=[{type:core.Component,args:[{selector:"remote-file-upload",template:'<div>\n    <file-uploader [(ngModel)]="innerValue" (onClear)="clearValue()" (fileChanged)="upload($event)">\n    </file-uploader>\n    <img *ngIf="innerValue" class="img-responsive" [src]="innerValue | secure:this.dataSource.fetchFile" alt="" />\n</div>',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef(function(){return e}),multi:!0}],styles:["img {\n        margin-left: auto;margin-right: auto;display: block;\n    }"]}]}],e.ctorParameters=function(){return[{type:core.Renderer2}]},e.propDecorators={dataSource:[{type:core.Input}]},e}(),RemoteFileUploadModule=function(){function e(){}return e.decorators=[{type:core.NgModule,args:[{imports:[common.CommonModule,SelectModule,forms.FormsModule,ngxFileUploader.FileUploaderModule,SharedModule],exports:[RemoteFileUploadComponent],declarations:[RemoteFileUploadComponent],providers:[]}]}],e}(),moment$1=moment_,DatePickerComponent=function(){function e(){this.locale="en",this.viewFormat="ll",this.returnObject="js",this.onDatePickerCancel=new core.EventEmitter,this.onSelectDate=new core.EventEmitter,this.onDisplayMonths=!1,this.onDisplayYears=!1,this.displayYearsIndex=0,this.monthsShort=moment$1.monthsShort()}return e.prototype.ngOnInit=function(){var o=this;this.initValue(),_.each(this.fullYearRange,function(e,t){o.currentYear=o.calendarDate.clone().startOf("year").year(),-1!==e.indexOf(o.currentYear)&&(o.displayYearsIndex=t)}),this.displayYearRange=this.fullYearRange[this.displayYearsIndex],this.generateCalendar()},e.prototype.prev=function(){this.onDisplayYears?(this.displayYearsIndex--,this.displayYearsIndex<0&&(this.displayYearsIndex=0),this.displayYearRange=this.fullYearRange[this.displayYearsIndex]):this.calendarDate=this.calendarDate.clone().subtract(1,"M"),this.generateCalendar()},e.prototype.showMonthSelection=function(){this.onDisplayMonths=!0,this.onDisplayYears=!1},e.prototype.showYearSelection=function(){this.onDisplayYears=!0,this.onDisplayMonths=!1},e.prototype.next=function(){this.onDisplayYears?(this.displayYearsIndex++,this.displayYearsIndex>=this.fullYearRange.length&&(this.displayYearsIndex=this.fullYearRange.length-1),this.displayYearRange=this.fullYearRange[this.displayYearsIndex++]):this.calendarDate=this.calendarDate.clone().add(1,"M"),this.generateCalendar()},e.prototype.selectDay=function(e){var t=e.diff(this.calendarDate.clone().startOf("date"),"days");e=this.calendarDate.clone().add(t,"d");var o=this.parseToReturnObjectType(e);this.onSelectDate.emit(o),this.cancelDatePicker()},e.prototype.selectMonth=function(e){this.calendarDate=this.calendarDate.clone().month(e),this.onDisplayMonths=!1,this.generateCalendar()},e.prototype.selectYear=function(e){this.calendarDate=this.calendarDate.clone().year(e),this.onDisplayYears=!1,this.generateCalendar()},e.prototype.selectToday=function(){var e=this.parseToReturnObjectType(moment$1());this.onSelectDate.emit(e),this.cancelDatePicker()},e.prototype.clearPickDate=function(){this.onSelectDate.emit(null),this.cancelDatePicker()},e.prototype.cancelDatePicker=function(){this.onDatePickerCancel.emit(!1)},e.prototype.generateYears=function(){for(var e=moment$1().year(),t=[],o=this.calendarDate.clone().subtract(100,"y").year();o<=e;o++)t.push(o);this.fullYearRange=_.chunk(t,14)},e.prototype.initValue=function(){moment$1.locale(this.locale),this.today=moment$1().startOf("date"),this.currentMonth=this.monthsShort[moment$1().month()],this.currentYear=moment$1().year(),this.dayNames=moment$1.weekdaysShort(!0),this.initDate?(this.calendarDate="string"===this.returnObject?moment$1(this.initDate,this.viewFormat):moment$1(this.initDate),this.selectedDate=this.calendarDate.clone().startOf("date")):this.calendarDate=moment$1(),this.generateYears()},e.prototype.generateCalendar=function(){this.calendarDays=[];for(var e=0-(this.calendarDate.clone().startOf("month").day()+(7-moment$1.localeData().firstDayOfWeek()))%7,t=41+e,o=e;o<=t;o+=1){var n=this.calendarDate.clone().startOf("month").add(o,"days");this.calendarDays.push(n)}},e.prototype.parseToReturnObjectType=function(e){switch(this.returnObject){case"js":return e.toDate();case"string":return e.format(this.viewFormat);case"moment":return e;case"json":return e.toJSON();case"array":return e.toArray();case"iso":return e.toISOString();case"object":return e.toObject();default:return e}},e.decorators=[{type:core.Component,args:[{selector:"date-picker",template:'<picker-modal (onOverlayClick)="cancelDatePicker()">\n  <div class="picker-wrap">\n    <div class="picker-box">\n      <div class="picker-header">\n        <div class="picker-header-nav">\n          <span class="nav-prev" (click)="prev()"></span>\n        </div>\n        <div class="picker-header-content">\n          <div class="content">\n            <span (click)="showMonthSelection()" class="month">{{calendarDate | moment: "MMMM"}}</span>\n            <span class="seperator">|</span>\n            <span (click)="showYearSelection()" class="year">{{calendarDate | moment: "YYYY"}}</span>\n          </div>\n        </div>\n        <div class="picker-header-nav">\n          <span class="nav-next" (click)="next()"></span>\n        </div>\n      </div>\n      <div class="picker-calendar">\n        <div class="picker-calendar-row" *ngIf="!onDisplayMonths && !onDisplayYears">\n          <span class="picker-weekday" *ngFor="let day of dayNames">{{ day }}</span>\n        </div>\n        <div class="picker-calendar-row" *ngIf="!onDisplayMonths && !onDisplayYears">\n                    <span class="picker-day" (click)="selectDay(day)" [ngClass]="{\n                       \'out-focus\': day.month() != calendarDate.month(),\n                       \'today\': day.isSame(today),\n                       \'selected\': day.isSame(selectedDate)\n                      }" *ngFor="let day of calendarDays">\n                    {{ day | moment: \'D\'}}\n                </span>\n        </div>\n        <div class="picker-calendar-row" *ngIf="onDisplayMonths">\n                    <span class="picker-month" *ngFor="let month of monthsShort"\n                          (click)="selectMonth(month)"\n                          [ngClass]="{\n                       \'selected\': month === currentMonth\n                      }">\n                    {{ month }}\n                </span>\n        </div>\n        <div class="picker-calendar-row" *ngIf="onDisplayYears">\n                    <span class="picker-year" *ngFor="let year of displayYearRange"\n                          (click)="selectYear(year)"\n                          [ngClass]="{\n                       \'selected\': year === currentYear\n                      }">\n                    {{ year }}\n                </span>\n        </div>\n      </div>\n      <div class="picker-footer">\n        <div class="picker-action action-today" (click)="selectToday()"><span class="text">Today</span></div>\n        <div class="picker-action action-clear" (click)="clearPickDate()"><span class="text">Clear</span></div>\n        <div class="picker-action action-close" (click)="cancelDatePicker()"><span class="text">Close</span></div>\n      </div>\n    </div>\n  </div>\n</picker-modal>\n',styles:['*,::after,::before{box-sizing:border-box}.picker-wrap{width:95vw;max-width:666px}.picker-box{font-family:\'Open Sans\';min-width:400px!important;padding:.625rem 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.picker-footer,.picker-header{font-size:1.333rem;line-height:2.5rem;display:flex;height:2.5rem;width:100%}.picker-header-nav{position:relative;cursor:pointer;width:calc(100% / 8)}.picker-header-nav>*{position:absolute;top:50%;right:auto;bottom:auto;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.picker-header-nav .nav-next::before,.picker-header-nav .nav-prev::before{content:" ";border-top:.5em solid transparent;border-bottom:.5em solid transparent;border-right:.75em solid #000;width:0;height:0;display:block;margin:0 auto}.picker-header-nav .nav-next::before{border-right:0;border-left:.75em solid #000}.picker-header-content{width:calc(100% * 6 / 8);text-align:center}.picker-header-content .month{font-size:1.778rem;line-height:2.5rem;margin-right:.5rem;font-weight:700}.picker-header-content .year{font-style:italic;color:#999}.picker-calendar{width:100%}.picker-calendar .picker-calendar-row{display:flex;flex-wrap:wrap;width:100%;margin-bottom:.625rem}.picker-calendar .picker-weekday{font-weight:700;text-align:left;color:#999;width:calc(100% / 7)}.picker-calendar .picker-day,.picker-calendar .picker-month,.picker-calendar .picker-year{font-size:1.333rem;line-height:2.5rem;position:relative;height:2.5rem;text-align:center;cursor:pointer;width:calc(100% / 7)}.picker-calendar .picker-day:hover,.picker-calendar .picker-month:hover,.picker-calendar .picker-year:hover{background:#b1dcfb}.picker-calendar .out-focus{color:#ddd}.picker-calendar .out-focus:hover{color:#000}.picker-calendar .selected{background:#0089ec;color:#fff}.picker-calendar .selected:hover{background:#0089ec}.picker-calendar .today::before{content:" ";position:absolute;top:2px;right:2px;width:0;height:0;border-top:.5em solid #0059bc;border-left:.5em solid transparent}.picker-footer{cursor:pointer}.picker-footer .picker-action{text-align:center;width:calc(100% / 3)}.picker-footer .picker-action:hover{background-color:#b1dcfb}.picker-footer .picker-action .text{padding-left:.8rem}.picker-footer .action-clear::before,.picker-footer .action-close::before,.picker-footer .action-today::before{content:" ";position:relative;display:inline-block;height:0;width:0}.picker-footer .action-today::before{border-top:.66em solid #0059bc;border-left:.66em solid transparent}.picker-footer .action-clear::before{top:-.5rem;width:1rem;border-top:3px solid #e20}.picker-footer .action-close::before{width:1rem;height:1rem;background:linear-gradient(to bottom,transparent 35%,#777 35%,#777 65%,transparent 65%),linear-gradient(to right,transparent 35%,#777 35%,#777 65%,transparent 65%);-webkit-transform:rotate(45deg);transform:rotate(45deg)}']}]}],e.ctorParameters=function(){return[]},e.propDecorators={initDate:[{type:core.Input}],locale:[{type:core.Input}],viewFormat:[{type:core.Input}],returnObject:[{type:core.Input}],onDatePickerCancel:[{type:core.Output}],onSelectDate:[{type:core.Output}]},e}(),moment$2=moment_,TimePickerComponent=function(){function e(){this.showSecond=!0,this.viewFormat="hh:mm A",this.use12Hour=!1,this.returnObject="js",this.onSelectTime=new core.EventEmitter,this.onTimePickerCancel=new core.EventEmitter,this.hourFormat="HH"}return e.prototype.ngOnInit=function(){this.use12Hour&&(this.hourFormat="hh"),this.time=this.initTime?moment$2(this.initTime,this.viewFormat):moment$2(),this.initTime?this.time="string"===this.returnObject?moment$2(this.initTime,this.viewFormat):moment$2(this.initTime):this.time=moment$2()},e.prototype.increaseHour=function(){this.time=this.time.clone().add(1,"h")},e.prototype.decreaseHour=function(){this.time=this.time.clone().subtract(1,"h")},e.prototype.increaseMinute=function(){this.time=this.time.clone().add(1,"m")},e.prototype.decreaseMinute=function(){this.time=this.time.clone().subtract(1,"m")},e.prototype.increaseSecond=function(){this.time=this.time.clone().add(1,"s")},e.prototype.decreaseSecond=function(){this.time=this.time.clone().subtract(1,"s")},e.prototype.selectTime=function(){var e=this.parseToReturnObjectType(this.time);this.onSelectTime.emit(e),this.cancelTimePicker()},e.prototype.selectNow=function(){var e=this.parseToReturnObjectType(moment$2());this.onSelectTime.emit(e),this.cancelTimePicker()},e.prototype.clearTime=function(){this.onSelectTime.emit(null),this.cancelTimePicker()},e.prototype.cancelTimePicker=function(){this.onTimePickerCancel.emit(!1)},e.prototype.parseToReturnObjectType=function(e){switch(this.returnObject){case"js":return e.toDate();case"string":return e.format(this.viewFormat);case"moment":return e;case"json":return e.toJSON();case"array":return e.toArray();case"iso":return e.toISOString();case"object":return e.toObject();default:return e}},e.decorators=[{type:core.Component,args:[{selector:"time-picker",template:'<picker-modal (onOverlayClick)="cancelTimePicker()">\n    <div class="picker-wrap">\n        <div class="picker-box">\n            <div class="picker-header">Time Picker</div>\n            <div class="picker-table">\n                <ul class="picker-table-time">\n                    <li class="picker-table-number hour">\n                        <span class="arrow up" (click)="increaseHour()"></span>\n                        {{time | moment: hourFormat}}\n                        <span class="arrow down" (click)="decreaseHour()"></span>\n                    </li>\n                    <li class="picker-table-separator">:</li>\n                    <li class="picker-table-number minute">\n                        <span class="arrow up" (click)="increaseMinute()"></span>\n                        {{time | moment: \'mm\'}}\n                        <span class="arrow down" (click)="decreaseMinute()"></span>\n                    </li>\n                    <li *ngIf="showSecond" class="picker-table-separator">:</li>\n                    <li *ngIf="showSecond" class="picker-table-number second">\n                        <span class="arrow up" (click)="increaseSecond()"></span>\n                        {{time | moment: \'ss\'}}\n                        <span class="arrow down" (click)="decreaseSecond()"></span>\n                    </li>\n                    <li *ngIf="use12Hour" class="picker-table-meridiem meridiem">\n                        {{time | moment: \'A\'}}\n                    </li>\n                </ul>\n            </div>\n            <div class="picker-footer">\n                <div class="picker-action action-now" (click)="selectNow()"><span class="text">Now</span></div>\n                <div class="picker-action action-confirm" (click)="selectTime()"><span class="text">Confirm</span></div>\n                <div class="picker-action action-clear" (click)="clearTime()"><span class="text">Clear</span></div>\n                <div class="picker-action action-close" (click)="cancelTimePicker()"><span class="text">Close</span></div>\n            </div>\n        </div>\n    </div>\n</picker-modal>\n',styles:["*,::after,::before{box-sizing:border-box}.picker-wrap{width:95vw;max-width:40rem;font-family:'Open Sans'}.picker-box{width:100%;padding:.625rem 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.picker-footer,.picker-header{font-size:1.333rem;line-height:2.5rem;height:2.5rem;width:100%}.picker-header{text-align:center}.picker-table{width:100%;margin:2.5rem 0}.picker-table-time{font-size:2.37rem;line-height:2.5rem;list-style:none;margin:0;padding:0;display:flex;justify-content:center;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.picker-table-meridiem,.picker-table-number,.picker-table-separator{text-align:center}.picker-table-meridiem,.picker-table-number{position:relative;width:20%}.arrow{position:absolute;left:50%;border:solid #777;border-width:0 .2rem .2rem 0;display:inline-block;padding:.25rem;cursor:pointer}.arrow.up{top:-1rem;-webkit-transform:translateX(-50%) rotate(-135deg);transform:translateX(-50%) rotate(-135deg)}.arrow.down{bottom:-1rem;-webkit-transform:translateX(-50%) rotate(45deg);transform:translateX(-50%) rotate(45deg)}.arrow:hover{border-color:#1975d2}.picker-table-separator{width:calc(20% / 3)}.picker-footer{display:flex;justify-content:center;width:100%;cursor:pointer}.picker-footer .picker-action{width:25%;text-align:center}.picker-footer .picker-action:hover{background-color:#b1dcfb}.picker-footer .picker-action .text{padding-left:.8rem}.picker-footer .action-clear::before,.picker-footer .action-close::before,.picker-footer .action-confirm::before,.picker-footer .action-now::before{content:\" \";position:relative;display:inline-block;height:0;width:0}.picker-footer .action-now::before{border-top:.66em solid #0059bc;border-left:.66em solid transparent}.picker-footer .action-confirm::before{width:1rem;height:1rem;border-radius:100%;background-color:#00b5ad}.picker-footer .action-clear::before{top:-.5rem;width:1rem;border-top:3px solid #e20}.picker-footer .action-close::before{width:1rem;height:1rem;background:linear-gradient(to bottom,transparent 35%,#777 35%,#777 65%,transparent 65%),linear-gradient(to right,transparent 35%,#777 35%,#777 65%,transparent 65%);-webkit-transform:rotate(45deg);transform:rotate(45deg)}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={initTime:[{type:core.Input}],showSecond:[{type:core.Input}],viewFormat:[{type:core.Input}],use12Hour:[{type:core.Input}],returnObject:[{type:core.Input}],onSelectTime:[{type:core.Output}],onTimePickerCancel:[{type:core.Output}]},e}(),ModalComponent=function(){function e(){this.onOverlayClick=new core.EventEmitter}return e.prototype.ngOnInit=function(){},e.prototype.closeModal=function(){this.onOverlayClick.emit(!1)},e.decorators=[{type:core.Component,args:[{selector:"picker-modal",template:'<section class="x-modal">\n    <section class="modal-overlay" (click)="closeModal()"></section>\n    <section class="modal-main" id="section-modal-main">\n        <ng-content></ng-content>\n    </section>\n</section>\n',styles:[":host{z-index:9999999999}*,::after,::before{box-sizing:border-box}.modal-main{position:absolute;left:19.6%;right:auto;top:auto;z-index:111;background-color:#fff;border:1px solid #d7dad7;border-radius:6px;-webkit-transform:translate(-50%,0);transform:translate(-50%,0);box-shadow:0 5px 15px rgba(0,0,0,.3)}"],changeDetection:core.ChangeDetectionStrategy.OnPush,animations:[]}]}],e.ctorParameters=function(){return[]},e.propDecorators={onOverlayClick:[{type:core.Output}]},e}(),MomentPipe=function(){function e(){}return e.prototype.transform=function(e,t){return t?e.format(t):e.format("MMM DD, YYYY")},e.decorators=[{type:core.Pipe,args:[{name:"moment"}]}],e}(),Moment=moment_,DateTimePickerComponent=function(){function e(){this.showDate=!0,this.showTime=!1,this.showWeeks=!1,this.weeks=[2,4,6,8,12,16,24],this.onDateChange=new core.EventEmitter,this.showDatePicker=!1,this.showTimePicker=!1,this.onChange=function(){},this.onTouched=function(){}}return e.prototype.ngOnInit=function(){},e.prototype.weeksSelected=function(e){var t=new Date,o=t.setDate(t.getDate()+7*e);this.value=Moment(o).format()},e.prototype.setDate=function(e){this.value=e&&""!==e?Moment(e).format():e},e.prototype.setTime=function(e){this.value=e&&""!==e?Moment(e).format():e},e.prototype.toggleDatePicker=function(e){this.showDatePicker=e},e.prototype.toggleTimePicker=function(e){this.showTimePicker=e},Object.defineProperty(e.prototype,"value",{get:function(){return this.modelValue},set:function(e){this.modelValue=e,this.onDateChange.emit(e),this.onChange(e),this.onTouched()},enumerable:!0,configurable:!0}),e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.writeValue=function(e){e instanceof Date?this.value=Moment(e).format():this.value=e},e.decorators=[{type:core.Component,args:[{selector:"date-time-picker",template:'<div class=\'row\'>\n    <div *ngIf="!showTime" class=\'col-xs-12 col-md-12\'>\n        <input *ngIf="!showWeeks" type="text" class="form-control" [value]="value | date: \'mediumDate\'" (focus)="toggleDatePicker(true)"\n            readonly placeholder="Select Date" />\n        <div *ngIf="showWeeks" class="input-group">\n            <input type="text" class="form-control" class="form-control" [value]="value | date: \'mediumDate\'" (focus)="toggleDatePicker(true)"\n                readonly placeholder="Select Date">\n            <div class="input-group-btn">\n                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Weeks <span class="caret"></span></button>\n                <ul class="dropdown-menu up">\n                    <li (click)="weeksSelected(count)" *ngFor="let count of weeks"><span> {{count}} Weeks</span></li>\n                </ul>\n            </div>\n        </div>\n    </div>\n    <div *ngIf="showTime" class=\'col-xs-8 col-md-8\'>\n        <input *ngIf="!showWeeks" type="text" class="form-control" [value]="value | date: \'mediumDate\'" (focus)="toggleDatePicker(true)"\n            readonly placeholder="Select Date" />\n        <div *ngIf="showWeeks" class="input-group">\n            <input type="text" class="form-control" class="form-control" [value]="value | date: \'mediumDate\'" (focus)="toggleDatePicker(true)"\n                readonly placeholder="Select Date">\n            <div class="input-group-btn">\n                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Weeks <span class="caret"></span></button>\n                <ul class="dropdown-menu up">\n                    <li (click)="weeksSelected(count)" *ngFor="let count of weeks"><span> {{count}} Weeks</span></li>\n                </ul>\n            </div>\n        </div>\n    </div>\n    <div *ngIf="showTime" class=\'col-xs-4 col-md-4\'>\n        <input type="text" class="form-control" [value]="value | date: \'shortTime\'" (focus)="toggleTimePicker(true)" readonly placeholder="Select Time"\n        />\n    </div>\n</div>\n<date-picker *ngIf="showDatePicker" [initDate]="value" (onSelectDate)="setDate($event)" (onDatePickerCancel)="toggleDatePicker($event)"></date-picker>\n\n<time-picker *ngIf="showTimePicker" [initTime]="value" [use12Hour]="true" (onSelectTime)="setTime($event)" (onTimePickerCancel)="toggleTimePicker($event)"></time-picker>\n',styles:["input[readonly]{background-color:#fff}.up{bottom:100%!important;top:auto!important}.glyphicon{top:1px}"],providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef(function(){return e}),multi:!0}]}]}],e.ctorParameters=function(){return[]},e.propDecorators={modelValue:[{type:core.Input}],showDate:[{type:core.Input}],showTime:[{type:core.Input}],showWeeks:[{type:core.Input}],weeks:[{type:core.Input}],onDateChange:[{type:core.Output}]},e}(),DateTimePickerModule=function(){function e(){}return e.decorators=[{type:core.NgModule,args:[{imports:[common.CommonModule,forms.FormsModule],declarations:[DatePickerComponent,TimePickerComponent,ModalComponent,MomentPipe,DateTimePickerComponent],exports:[DatePickerComponent,TimePickerComponent,ModalComponent,MomentPipe,DateTimePickerComponent],providers:[]}]}],e}(),moment$3=moment_,MY_FORMATS={parse:{dateInput:"LL"},display:{dateInput:"LL",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}},NgxDateTimePickerComponent=function(){function e(){this.selectedTime=moment$3().format("HH:mm"),this.selectedDate=moment$3().format(),this.loadInitial=!1,this.weeks=[0,2,4,6,8,12,16,24],this.showTime=!1,this.showWeeks=!0,this.onDateChange=new core.EventEmitter,this.onChange=function(){},this.onTouched=function(){}}return e.prototype.ngOnInit=function(){},Object.defineProperty(e.prototype,"value",{get:function(){return this.modelValue},set:function(e){var t=this;setTimeout(function(){t.onDateChange.emit(e)},100),this.onChange(e),this.onTouched()},enumerable:!0,configurable:!0}),e.prototype.writeValue=function(e){this.loadInitial||this.setFormValues(e)},e.prototype.setFormValues=function(e){this.loadInitial=!0,this.selectedDate=moment$3(e).format(),this.selectedTime=moment$3(e).format("HH:mm"),e instanceof Date?this.value=moment$3(e).format():this.value=e,this.modelValue=this.value},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.onDateSelect=function(e){var t=moment$3(e),o=this.selectedTime;this.setDateTime(t,o)},e.prototype.onTimeSelect=function(e){var t=moment$3(this.selectedDate),o=e;this.setDateTime(t,o)},e.prototype.setCurrentTime=function(){var e=moment$3(this.selectedDate),t=moment$3().format("HH:mm");this.setDateTime(e,t)},e.prototype.weekSelect=function(e){var t=moment$3(this.selectedDate).add(e,"weeks"),o=this.selectedTime;this.setDateTime(t,o)},e.prototype.setCurrentDate=function(){var e=moment$3(),t=moment$3().format("HH:mm");this.setDateTime(e,t)},e.prototype.setDateTime=function(e,t){var o=moment$3(e).format("DD-MM-YYYY"),n=t,r=moment$3(o+""+n,"DD-MM-YYYY HH:mm"),i=moment$3(r).format();this.selectedDate=i,this.selectedTime=n,this.modelValue=i,this.value=i},e.decorators=[{type:core.Component,args:[{selector:"ngx-date-time-picker",template:'<div class="row">\n  <div class="col-sm-8 col-md-8 col-lg-8 col-xs-12">\n    <div class="row">\n        <div class="col-sm-9 col-md-9 col-lg-9 col-xs-12">\n            <div class="input-group">\n                   \n                    <input matInput [matDatepicker]="picker" class="form-control" [(ngModel)]="selectedDate" placeholder="Choose a date" \n                    (ngModelChange)="onDateSelect($event)">\n                    <mat-datepicker #picker touchUi="true" disabled="false"></mat-datepicker>\n                    <div class="input-group-btn">\n                        <button class="btn btn-default" (click)="picker.open()">\n                            <i class="glyphicon glyphicon-calendar"></i>\n                          </button>\n                        <button class="btn btn-default" (click)="setCurrentDate()">\n                          Set Current Date\n                        </button>\n                    </div>\n            </div>\n          </div>\n          <div class="col-sm-3 col-md-3 col-lg-3 col-xs-12" *ngIf="showWeeks">\n          \n              <div class="form-group">\n                  <mat-select placeholder="Weeks" class="form-control" [(ngModel)]="modelValue" name="weeks" (ngModelChange)="weekSelect($event)">\n                    <mat-option *ngFor="let count of weeks" [value]="count">\n                      {{count}} Weeks\n                    </mat-option>\n                  </mat-select>\n              </div>\n          </div>\n    </div>\n    \n  </div>\n  <div class="col-sm-4 col-md-4 col-lg-4 col-xs-12" id="time-section">\n   \n        <div class="input-group">\n            <input type="time" class="form-control" atp-time-picker [(ngModel)] = "selectedTime" (ngModelChange)="onTimeSelect($event)" id="ngx-atp-time-picker"/>\n            <div class="input-group-btn">\n              <button class="btn btn-default" (click)="setCurrentTime()">\n                  Set Current Time\n              </button>\n            </div>\n         </div>\n    \n      \n  </div>\n\n</div>',styles:["#time-section{display:inline-block}#ngx-atp-time-picker,#ngx-mat-form-field{width:100%}.up{bottom:100%!important;top:auto!important}.time-btn{margin-top:-20px}"],providers:[{provide:core$1.MAT_DATE_FORMATS,useValue:MY_FORMATS},{provide:core$1.DateAdapter,useClass:materialMomentAdapter.MomentDateAdapter},{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef(function(){return e}),multi:!0}]}]}],e.propDecorators={weeks:[{type:core.Input}],modelValue:[{type:core.Input}],showTime:[{type:core.Input}],showWeeks:[{type:core.Input}],onDateChange:[{type:core.Output}]},e}(),NgxDateTimePickerModule=function(){function e(){}return e.decorators=[{type:core.NgModule,args:[{imports:[common.CommonModule,forms.FormsModule,forms.ReactiveFormsModule,datepicker.MatDatepickerModule,formField.MatFormFieldModule,material.MatNativeDateModule,material.MatInputModule,amazingTimePicker.AmazingTimePickerModule,select.MatSelectModule],declarations:[NgxDateTimePickerComponent],exports:[datepicker.MatDatepickerModule,formField.MatFormFieldModule,material.MatNativeDateModule,material.MatInputModule,NgxDateTimePickerComponent],providers:[]}]}],e}(),Option$1=function(e){this.label=e.label,this.value=e.value},AfeNgSelectComponent=function(){function e(){this.question_options=[],this.errors=[],this.propagateChange=function(e){}}return e.prototype.getChangingText=function(e){var t=this;this.getData(e).subscribe(function(e){t.question_options=e})},e.prototype.writeValue=function(e){},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(e){},e.prototype.ngOnChanges=function(e){},e.prototype.ngOnInit=function(){var t=this;this.extras&&this.extras.originalValue&&this.resolveSelectedOption(this.extras.originalValue).subscribe(function(e){t.selected_question_option=e})},e.prototype.getData=function(e){var n=this;return this.subject=new rxjs.BehaviorSubject([]),this.dataSource.searchOptions(e).subscribe(function(e){console.log("options",e);for(var t=new Array,o=0;o<e.length;o++)t.push(new Option$1(e[o]));n.subject.next(t)},function(e){n.subject.error(e)}),this.subject.asObservable()},e.prototype.onValueChange=function(e){},e.prototype.resolveSelectedOption=function(e){var t=this;return this.subjectOption=new rxjs.BehaviorSubject(null),this.dataSource.resolveSelectedValue(e).subscribe(function(e){console.log("option",e),t.subjectOption.next(e)},function(e){t.subjectOption.error(e)}),this.subjectOption.asObservable()},e.prototype.resetOptions=function(){this.subject.next(new Array)},e.decorators=[{type:core.Component,args:[{selector:"afe-ng-select",template:'<ng-select\n                   (searchInputText)="getChangingText($event)"\n                    (ngModelChange)="onValueChange($event)"\n                    [options]="question_options"\n                    [multiple]="multiple" >\n            </ng-select>\n  ',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef(function(){return e}),multi:!0}]}]}],e.propDecorators={dataSource:[{type:core.Input}],multiple:[{type:core.Input}],extras:[{type:core.Input}]},e}(),FormSchemaCompiler=function(){function e(){}return e.prototype.compileFormSchema=function(e,t){var o=this.getReferencedForms(e,t);if(_.isEmpty(o))return e;var n=this.getAllPlaceholderObjects(e);return _.isEmpty(n)||this.replaceAllPlaceholdersWithActualObjects(o,n),e},e.prototype.findSchemaByName=function(e,t){if(!_.isEmpty(e)&&!_.isEmpty(t)){var o={};return _.each(e,function(e){e.name===t&&(o=e)}),o}},e.prototype.getPageInSchemaByLabel=function(e,t){if(!_.isEmpty(e)&&!_.isEmpty(t)){var o={};return _.each(e.pages,function(e){e.label===t&&(o=e)}),o}},e.prototype.getSectionInSchemaByPageLabelBySectionLabel=function(e,t,o){if(!(_.isEmpty(e)||_.isEmpty(t)||_.isEmpty(o))){var n=this.getPageInSchemaByLabel(e,t);if(!_.isEmpty(n)){var r={};return _.each(n.sections,function(e){e.label===o&&(r=e)}),r}}},e.prototype.getQuestionByIdInSchema=function(e,t){if(!_.isEmpty(e)&&!_.isEmpty(t)){if(Array.isArray(e)){for(var o=void 0,n=0;n<e.length&&(_.isEmpty(e[n])||(o=this.getQuestionByIdInSchema(e[n],t)),_.isEmpty(o));n++);return o}if("object"!=typeof e);else{if(this.isQuestionObjectWithId(e,t))return e;if(this.isSchemaSubObjectExpandable(e)){var r=e.pages||e.sections||e.questions;return this.getQuestionByIdInSchema(r,t)}}}},e.prototype.getQuestionsArrayByQuestionIdInSchema=function(e,t){if(!_.isEmpty(e)&&!_.isEmpty(t))return this.getQuestionsArrayByQuestionId(e,e,t)},e.prototype.getQuestionsArrayByQuestionId=function(e,t,o){if(Array.isArray(t)){for(var n=void 0,r=0;r<t.length&&(_.isEmpty(t[r])||(n=this.getQuestionsArrayByQuestionId(t,t[r],o)),_.isEmpty(n));r++);return n}if("object"!=typeof t);else{if(this.isQuestionObjectWithId(t,o))return e;if(this.isSchemaSubObjectExpandable(t)){var i=t.pages||t.sections||t.questions;return this.getQuestionsArrayByQuestionId(i,i,o)}}},e.prototype.isSchemaSubObjectExpandable=function(e){if("object"==typeof e){var t=Object.keys(e);if(_.includes(t,"pages")||_.includes(t,"sections")||_.includes(t,"questions"))return!0}return!1},e.prototype.isQuestionObjectWithId=function(e,t){return e.id===t},e.prototype.getAllPlaceholderObjects=function(e){var t=[];return this.extractPlaceholderObjects(e,t),t},e.prototype.extractPlaceholderObjects=function(e,t){if(!_.isEmpty(e))if(Array.isArray(e))for(var o=0;o<e.length;o++)_.isEmpty(e[o])||this.extractPlaceholderObjects(e[o],t);else if("object"==typeof e)if(_.isEmpty(e.reference)){if(this.isSchemaSubObjectExpandable(e)){var n=e.pages||e.sections||e.questions;this.extractPlaceholderObjects(n,t)}}else t.push(e)},e.prototype.fillPlaceholderObject=function(e,t){for(var o in t)_.isEmpty(e[o])&&(e[o]=t[o]);return e},e.prototype.replaceAllPlaceholdersWithActualObjects=function(o,e){var n=this;return _.each(e,function(e){var t=n.getReferencedObject(e.reference,o);_.isEmpty(t)?console.error("Form compile: Error finding referenced object",e.reference):(e=n.fillPlaceholderObject(e,t),delete(e=n.removeExcludedQuestionsFromPlaceholder(e)).reference)}),e},e.prototype.removeObjectFromArray=function(e,t){var o=e.indexOf(t);-1!==o&&e.splice(o,1)},e.prototype.removeExcludedQuestionsFromPlaceholder=function(n){var r=this;return Array.isArray(n.reference.excludeQuestions)&&_.each(n.reference.excludeQuestions,function(e){var t=r.getQuestionsArrayByQuestionIdInSchema(n,e);if(Array.isArray(t)){var o=r.getQuestionByIdInSchema(t,e);r.removeObjectFromArray(t,o)}}),n},e.prototype.getReferencedObject=function(e,t){if(_.isEmpty(e.form))console.error("Form compile: reference missing form attribute",e);else{if(!_.isEmpty(t[e.form]))return _.isEmpty(e.questionId)?_.isEmpty(e.page)||_.isEmpty(e.section)?_.isEmpty(e.page)?void console.error("Form compile: Unsupported reference type",e.reference):this.getPageInSchemaByLabel(t[e.form],e.page):this.getSectionInSchemaByPageLabelBySectionLabel(t[e.form],e.page,e.section):this.getQuestionByIdInSchema(t[e.form],e.questionId);console.error("Form compile: referenced form alias not found",e)}},e.prototype.getReferencedForms=function(e,t){var o=this,n=e.referencedForms;if(!_.isEmpty(n)){var r={};return _.each(n,function(e){r[e.alias]=o.findSchemaByName(t,e.formName)}),r}},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[]},e}(),TextInputQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.placeholder=e.placeholder||"",t.controlType=AfeControlType.AfeFormControl,t}return __extends(e,o),e}(QuestionBase),TextAreaInputQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.placeholder=e.placeholder||"",t.isExpanded=e.isExpanded||!1,t.rows=e.rows||18,t.renderingType="textarea",t.controlType=AfeControlType.AfeFormControl,t}return __extends(e,o),e}(TextInputQuestion),SelectQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.renderingType="select",t.options=e.options||[],t.controlType=AfeControlType.AfeFormControl,t.dataSource=e.dataSource||"",t}return __extends(e,o),e}(QuestionBase),UiSelectQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.renderingType="ui-select",t.options=e.options||[],t.controlType=AfeControlType.AfeFormControl,t}return __extends(e,o),e}(QuestionBase),DateQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.showTime=!0,t.showWeeksAdder=!1,t.renderingType="date",t.controlType=AfeControlType.AfeFormControl,t}return __extends(e,o),e}(QuestionBase),MultiSelectQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.renderingType="multi-select",t.options=e.options||[],t.controlType=AfeControlType.AfeFormControl,t}return __extends(e,o),e}(SelectQuestion),NestedQuestion=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(QuestionBase),QuestionGroup=function(o){function e(e){var t=o.call(this,e)||this;return t.isExpanded=!0,t.renderingType="group",t.questions=e.questions||[],t.controlType=AfeControlType.AfeFormGroup,t}return __extends(e,o),e}(NestedQuestion),RepeatingQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.renderingType="repeating",t.questions=e.questions||[],t.controlType=AfeControlType.AfeFormArray,t}return __extends(e,o),e}(NestedQuestion),CheckBoxQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.renderingType="checkbox",t.options=e.options||[],t.controlType=AfeControlType.AfeFormControl,t}return __extends(e,o),e}(QuestionBase),FileUploadQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.showTime=!0,t.showWeeksAdder=!1,t.renderingType="file",t.dataSource=e.dataSource,t.controlType=AfeControlType.AfeFormControl,t}return __extends(e,o),e}(QuestionBase),TestOrderQuestion=function(o){function e(e){var t=o.call(this,e)||this;return t.renderingType="select",t.orderType=e.orderType,t.selectableOrders=e.selectableOrders,t.options=e.options,t.orderSettingUuid=e.orderSettingUuid,t.rendering=e.orderSettingUuid,t.controlType=AfeControlType.AfeFormControl,t}return __extends(e,o),e}(QuestionBase),DateValidationModel=function(o){function e(e){var t=o.call(this,e)||this;return t.allowFutureDates=!1,t.allowFutureDates="true"===e.allowFutureDates,t}return __extends(e,o),e}(ValidationModel),MaxValidationModel=function(n){function e(e){var t=n.call(this,e)||this,o=e.max;return t.max=+o,t}return __extends(e,n),e}(ValidationModel),MinValidationModel=function(n){function e(e){var t=n.call(this,e)||this,o=e.min;return t.min=+o,t}return __extends(e,n),e}(ValidationModel),DummyDataSource=function(){function e(){this.returnErrorOnNext=!1}return e.prototype.resolveSelectedValue=function(t){var e=this.sampleData();e=(e=e.map(function(e){return new Option$1({label:e.label,value:e.concept})})).filter(function(e){return e.value===t});var o=new rxjs.BehaviorSubject([]);return this.returnErrorOnNext?o.error(new Error("Error loading Options")):o.next(e[0]),o.asObservable()},e.prototype.fileUpload=function(e){return rxjs.of({image:""})},e.prototype.fetchFile=function(e){return rxjs.of({image:""})},e.prototype.searchOptions=function(t){var e=this.sampleData();e=(e=e.map(function(e){return new Option$1({label:e.label,value:e.concept})})).filter(function(e){return-1!==e.label.indexOf(t)});var o=new rxjs.BehaviorSubject([]);return this.returnErrorOnNext?o.error(new Error("Error loading Options")):o.next(e),o.asObservable()},e.prototype.sampleData=function(){return[{concept:"a899e0ac-1350-11df-a1f1-0026b9348838",label:"None"},{concept:"a8ad1276-1350-11df-a1f1-0026b9348838",label:"Breathlessness"},{concept:"a892e4b4-1350-11df-a1f1-0026b9348838",label:"Chest pain"},{concept:"a8afc8b8-1350-11df-a1f1-0026b9348838",label:"Cough = 2 weeks"},{concept:"d7adae14-c386-49cc-8f7c-765d8ceec566",label:"Fever for = 2 weeks"},{concept:"3f57aafc-7162-41da-a51b-6a804cb6f5e8",label:"New exposure to household contact with TB"},{concept:"a89807f0-1350-11df-a1f1-0026b9348838",label:"Noticeable Weight loss"},{concept:"e1862fef-68ed-4df4-90dd-a00152f719aa",label:"Night sweats = 2 weeks"},{concept:"a8ad462e-1350-11df-a1f1-0026b9348838",label:"Abdomen"},{concept:"f218c60e-4b54-475a-a4fa-facab9216da8",label:"Groin"},{concept:"a8a774b0-1350-11df-a1f1-0026b9348838",label:"Joints"},{concept:"4639388c-ee31-4dcf-abb4-ad71253493bb",label:"Neck Kw"}]},e}(),moment$4=moment_,HistoricalEncounterDataService=function(){function e(){this.dataSources={}}return e.prototype.registerEncounters=function(e,t){var n=this,r={data:[],getValue:function(e,t){void 0===t&&(t=0);var o=e.split(".");return 0<o.length?n.getFirstValue(o,r.data[t]):r.data[t][e]},getAllObjects:function(){return r.data},getSingleObject:function(e){return void 0===e&&(e=0),r.data[e]}};if(_.isArray(t)){var o=[];_.each(t,function(e){o.push(n._transformEncounter(e))}),r.data=_.sortBy(o,"encounterDatetime").reverse()}else r.data.push(this._transformEncounter(t));this.putObject(e,r)},e.prototype.putObject=function(e,t){this.dataSources[e]=t},e.prototype.getObject=function(e){return this.dataSources[e]||null},e.prototype.getFirstValue=function(e,t){var o=[];if(this.getAllValues(e,t,o),0<o.length)return{value:o[0],valueDate:moment$4(t.encounterDatetime).format("ll")}},e.prototype.getAllValues=function(e,t,o){var n=this;if(!_.isNil(t))if(e.length<=1)_.isNil(t[e[0]])||o.push(t[e[0]]);else{var r=e.splice(1),i=e[0];_.isArray(t[i])&&0<t[i].length?_.each(t[i],function(e){n.getAllValues(r.slice(0),e,o)}):this.getAllValues(r.slice(0),t[i],o)}},e.prototype._transformEncounter=function(e){if(!_.isNil(e)){var t={encounterDatetime:e.encounterDatetime};if(e.location&&e.location.uuid&&(t.location=e.location.uuid),e.patient&&e.patient.uuid&&(t.patient=e.patient.uuid),e.form&&e.form.uuid&&(t.form=e.form.uuid),e.encounterType&&e.encounterType.uuid&&(t.encounterType=e.encounterType.uuid),e.provider){var o=e.provider;t.provider=o.uuid}if(e.obs){var n=this._transformObs(e.obs);_.extend(t,n)}return t}},e.prototype._transformObs=function(e){var t=this;if(!e)return null;var o={};if(_.isArray(e))return _.each(e,function(e){t._augumentObs(o,t._transformObs(e))}),o;if(e.groupMembers){var n={};return _.each(e.groupMembers,function(e){t._augumentObs(n,t._transformObs(e))}),o[e.concept.uuid]&&_.isArray(o[e.concept.uuid])?o[e.concept.uuid].push(n):o[e.concept.uuid]=[n],o}return e.value instanceof Object?o[e.concept.uuid]=e.value.uuid:o[e.concept.uuid]=e.value,o},e.prototype._augumentObs=function(e,t){for(var o in t)if(_.has(e,o)){if(!_.isArray(e[o])){var n=e[o];e[o]=[n]}_.isArray(t[o])?Array.prototype.push.apply(e[o],t[o]):e[o].push(t[o])}else e[o]=t[o];return e},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[]},e}(),HistoricalHelperService=function(){function e(){}return e.prototype.evaluate=function(e,t){var o=new HistoricalEncounterDataService;o.registerEncounters("prevEnc",t.rawPrevEnc);var n={HD:o},r=new JsExpressionHelper,i=new AfeFormControl;return(new ExpressionRunner).getRunnable(e,i,r.helperFunctions,n).run()},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[]},e}(),QuestionFactory=function(){function e(){this.dataSources={},this.historicalHelperService=new HistoricalHelperService}return e.prototype.createQuestionModel=function(e,t){if(t){var o=t.dataSourcesContainer.dataSources;this.dataSources=o}return this.toFormQuestionModel(e)},e.prototype.toSelectQuestion=function(e){var t=new SelectQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.options=e.questionOptions.answers.map(function(e){return{label:e.label,value:e.concept}}),t.options.splice(0,0,{label:"",value:""}),t.renderingType=e.questionOptions.rendering,t.validators=this.addValidators(e),t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toNumericQuestion=function(e){var t=new TextInputQuestion({placeholder:"",type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="number",t.placeholder=e.questionOptions.placeholder,t.validators=this.addValidators(e),t.extras=e,t.placeholder=e.questionOptions.placeholder||"";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toNumberQuestion=function(e){var t=new TextInputQuestion({placeholder:"",type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="number",t.placeholder=e.questionOptions.placeholder||"",t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),t.validators=this.addValidators(e),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toDateQuestion=function(e){if("encounterDatetime"===e.type)return this.toEncounterDatetimeQuestion(e);var t=new DateQuestion({type:"",key:""});t.renderingType="date",t.validators=this.addValidators(e),t.extras=e,t.showTime=e.questionOptions.showTime,t.showWeeksAdder=!!e.questionOptions.weeksList;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toEncounterDatetimeQuestion=function(e){var t=new DateQuestion({type:"",key:""});t.label=e.label,t.renderingType="date",t.key=e.id,t.validators=this.addValidators(e),t.extras=e,t.showWeeksAdder=!!e.questionOptions.weeksList;return t.showTime=!0,this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toCheckBoxQuestion=function(e){var t=new CheckBoxQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.extras=e,t.options=e.questionOptions.answers.map(function(e){return{label:e.label,value:e.concept}}),t.options.splice(0,0),t.renderingType=e.questionOptions.rendering;return this.copyProperties({label:"label",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toMultiCheckboxQuestion=function(e){var t=new MultiSelectQuestion({renderType:"",options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.options=e.questionOptions.answers.map(function(e){return{label:e.label,value:e.concept}}),t.validators=this.addValidators(e),t.dataSource=new DummyDataSource,t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toTextAreaQuestion=function(e){var t=new TextAreaInputQuestion({isExpanded:!1,rows:18,placeholder:"",type:"",key:""});t.label=e.label,t.key=e.id,t.placeholder=e.questionOptions.placeholder,t.isExpanded=e.isExpanded,t.rows=e.questionOptions.rows,t.validators=this.addValidators(e),t.extras=e,t.placeholder=e.questionOptions.placeholder||"";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toTextQuestion=function(e){var t=new TextInputQuestion({placeholder:"",type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="text",t.placeholder=e.questionOptions.placeholder,t.validators=this.addValidators(e),t.extras=e,t.placeholder=e.questionOptions.placeholder||"";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toFileUploadQuestion=function(e){var t=new FileUploadQuestion({type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="file",t.dataSource="file",t.validators=this.addValidators(e),t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toDrugQuestion=function(e){var t=new SelectQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="drug";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toProblemQuestion=function(e){var t=new SelectQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="problem";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toConceptAnswerSelect=function(e){var t=new SelectQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource=e.questionOptions.dataSource||"conceptAnswers",t.dataSourceOptions={concept:e.questionOptions.concept};return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toRepeatingQuestion=function(e){var t=new RepeatingQuestion({questions:[],type:"",key:""});if(t.label=e.label,t.questions=this.getChildrenQuestionModels(e.questions),t.key=e.id,t.validators=this.addValidators(e),"testOrder"===(t.extras=e).type){var o=this.toTestOrderQuestion(e),n=[];n.push(o),t.questions=n}return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toGroupQuestion=function(e){var t=new QuestionGroup({questions:[],type:"",key:""});t.label=e.label,t.questions=this.getChildrenQuestionModels(e.questions),t.key=e.id,t.validators=this.addValidators(e),t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toPageQuestion=function(e){var t=this,o=new QuestionGroup({questions:[],type:"",key:""});return o.label=e.label,o.key=e.label,o.renderingType="page",o.controlType=AfeControlType.None,o.questions=[],e.sections.forEach(function(e){o.questions.push(t.toSectionQuestion(e))}),o},e.prototype.toFormQuestionModel=function(e){var t=this,o=new QuestionGroup({questions:[],type:"",key:""});return o.label=e.label,o.key=e.label,o.renderingType="form",o.controlType=AfeControlType.AfeFormGroup,o.extras=e,o.questions=[],e.pages.forEach(function(e){o.questions.push(t.toPageQuestion(e))}),o},e.prototype.toSectionQuestion=function(e){var t=new QuestionGroup({questions:[],type:"",key:""});return t.label=e.label,t.key=e.label,t.renderingType="section",t.controlType=AfeControlType.None,t.isExpanded="true"===e.isExpanded,t.questions=this.getSchemaQuestions(e.questions),t},e.prototype.toPersonAttributeQuestion=function(e){var t=new UiSelectQuestion({options:[],type:"",key:"",searchFunction:function(){},resolveFunction:function(){}});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="personAttribute";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addHistoricalExpressions(e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toEncounterProviderQuestion=function(e){var t=new UiSelectQuestion({options:[],type:"",key:"",searchFunction:function(){},resolveFunction:function(){}});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="provider";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toFieldSetQuestion=function(e){var t=this.toGroupQuestion(e);return t.renderingType="field-set",t},e.prototype.toEncounterLocationQuestion=function(e){var t=new UiSelectQuestion({options:[],type:"",key:"",searchFunction:function(){},resolveFunction:function(){}});t.label=e.label,t.key=e.id,t.renderingType=e.type,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="location";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toTestOrderQuestion=function(e){var t=new TestOrderQuestion({type:"",key:"",orderType:"",selectableOrders:[],orderSettingUuid:"",label:"",rendering:""});t.label=e.label,t.key=e.id,t.validators=this.addValidators(e),t.extras=e,t.options=e.questionOptions.selectableOrders.map(function(e){return{label:e.label,value:e.concept}});return this.copyProperties({label:"label",required:"required",id:"key"},e,t),t},e.prototype.getSchemaQuestions=function(e){var t=new Array;return this.getQuestions(e,t),t},e.prototype.getQuestions=function(e,t){if(Array.isArray(t)||(t=[]),Array.isArray(e))for(var o in e)e.hasOwnProperty(o)&&this.getQuestions(e[o],t);if(e&&!Array.isArray(e)&&"object"==typeof e)if(e.questionOptions)"group"===e.questionOptions.rendering||"repeating"===e.questionOptions.rendering?t.push(this.toModel(e,e.questionOptions.rendering)):"field-set"===e.questionOptions.rendering||t.push(this.toModel(e,e.questionOptions.rendering));else for(var n in e)e.hasOwnProperty(n)&&this.getQuestions(e[n],t)},e.prototype.getChildrenQuestionModels=function(e){var t=[];return this.getQuestions(e,t),t},e.prototype.toModel=function(e,t){switch("ui-select-extended"===t&&(t=e.type),e.id||(e.id=this.generateId(10)),!e.questionOptions||!0!==e.questionOptions.showDate&&"true"!==e.questionOptions.showDate||(e=this.convertOldVersionComplexObsQuestionToNewVersion(e),t="field-set"),t){case"select":return this.toSelectQuestion(e);case"numeric":return this.toNumericQuestion(e);case"number":return this.toNumberQuestion(e);case"encounterDatetime":return this.toEncounterDatetimeQuestion(e);case"date":return this.toDateQuestion(e);case"multiCheckbox":return this.toMultiCheckboxQuestion(e);case"drug":return this.toDrugQuestion(e);case"problem":return this.toProblemQuestion(e);case"group":return this.toGroupQuestion(e);case"field-set":return this.toFieldSetQuestion(e);case"repeating":return this.toRepeatingQuestion(e);case"personAttribute":return this.toPersonAttributeQuestion(e);case"text":return this.toTextQuestion(e);case"textarea":case"textarea":return this.toTextAreaQuestion(e);case"select-concept-answers":return this.toConceptAnswerSelect(e);case"encounterLocation":return this.toEncounterLocationQuestion(e);case"encounterDatetime":return this.toEncounterDatetimeQuestion(e);case"encounterProvider":return this.toEncounterProviderQuestion(e);case"radio":case"checkbox":return this.toCheckBoxQuestion(e);case"encounterProvider":return this.toEncounterProviderQuestion(e);default:return console.warn("New Schema Question Type found........."+t),this.toTextQuestion(e)}},e.prototype.convertOldVersionComplexObsQuestionToNewVersion=function(e){var t={type:"complex-obs"};t.label=e.label,t.id="complex_"+e.id,t.questionOptions={},t.questionOptions.concept=e.questionOptions.concept,t.questionOptions.rendering="field-set",t.questions=[],t.validators=[];var o=JSON.parse(JSON.stringify(e));o.type="complex-obs-child",delete o.questionOptions.showDate,delete o.questionOptions.shownDateOptions,o.questionOptions.obsField="value";var n={type:"complex-obs-child"};n.label="Date of "+o.label,n.id="date_"+o.id,n.questionOptions={},n.questionOptions.concept=e.questionOptions.concept,n.questionOptions.rendering="date",n.questionOptions.obsField="obsDatetime";var r=Object.assign({},e.questionOptions.shownDateOptions);return n.validators=r.validators,n.hide=r.hide,t.questions.push(o),t.questions.push(n),t},e.prototype.copyProperties=function(e,t,o){for(var n in t)e.hasOwnProperty(n)&&o.hasOwnProperty(e[n])&&(o[e[n]]=t[n])},e.prototype.addValidators=function(e){var t=[];e.validators&&_.forEach(e.validators,function(e){switch(e.type){case"date":t.push(new DateValidationModel(e));break;case"js_expression":t.push(new JsExpressionValidationModel(e));break;case"conditionalAnswered":t.push(new ConditionalValidationModel(e));break;default:t.push(new ValidationModel(e))}});var o=e.questionOptions;switch(o?o.rendering:""){case"number":o.max&&o.min&&(t.push(new MaxValidationModel({type:"max",max:o.max})),t.push(new MinValidationModel({type:"min",min:o.min})))}if("object"==typeof e.required){var n=e.required;"conditionalRequired"===n.type&&t.push(new ConditionalValidationModel({referenceQuestionId:n.referenceQuestionId,referenceQuestionAnswers:n.referenceQuestionAnswers,type:n.type,message:n.message}))}return t},e.prototype.addHistoricalExpressions=function(e,t){if(e.historicalExpression&&0<e.historicalExpression.length){t.setHistoricalValue(!0),e.showHistoricalEncounterDate!==undefined?t.showHistoricalEncounterDate("true"===e.showHistoricalEncounterDate):t.showHistoricalEncounterDate();var o=this.historicalHelperService.evaluate(e.historicalExpression,this.dataSources);t.historicalDataValue=o,e.historicalPrepopulate&&(t.defaultValue=o)}},e.prototype.addCalculatorProperty=function(e,t){e.questionOptions&&"object"==typeof e.questionOptions.calculate&&(t.calculateExpression=e.questionOptions.calculate.calculateExpression)},e.prototype.addAlertProperty=function(e,t){e.alert&&(t.alert=e.alert)},e.prototype.addDisableOrHideProperty=function(e,t){e.disable&&(t.disable=e.disable),"object"==typeof e.disable&&(t.disable=e.disable.disableWhenExpression),e.hide&&(t.hide=e.hide),"object"==typeof e.hide&&e.hide.hideWhenExpression&&(t.hide=e.hide.hideWhenExpression)},e.prototype.generateId=function(e){for(var t="_";t.length<e&&0<e;){var o=Math.random();t+=o<.1?Math.floor(100*o):String.fromCharCode(Math.floor(26*o)+(.5<o?97:65))}return"_"+t},e}(),Form=function(){function e(e,t,o){this.schema=e,this.formFactory=t,this.questionFactory=o,this.valueProcessingInfo={},this.existingOrders={},this._showErrors=!1,this._dataSourcesContainer=new DataSources}return Object.defineProperty(e.prototype,"dataSourcesContainer",{get:function(){return this._dataSourcesContainer},enumerable:!0,configurable:!0}),e.prototype.searchNodeByPath=function(e,t,o){var n=this,r=e.children;for(var i in r)if(r.hasOwnProperty(i)){var a=r[i];if(a instanceof GroupNode){if(t===a.path)return o.push(a),o;this.searchNodeByPath(a,t,o)}else if(a instanceof LeafNode){if(t===a.path)return o.push(a),o}else if(a instanceof ArrayNode){if(t===a.path)return o.push(a),o;a.children.forEach(function(e){n.searchNodeByPath(e,t,o)})}}return o},e.prototype.searchNodeByQuestionId=function(e,t){var o=[];return t?this.searchNodeByQuestionType(this.rootNode,t,o):this.findNodesByQuestionId(this.rootNode,e,o),o},e.prototype.searchNodeByQuestionType=function(e,t,o){var n=this;if(e instanceof GroupNode){var r=e;for(var i in r.children)this.searchNodeByQuestionType(r.children[i],t,o)}e instanceof ArrayNode&&e.children.forEach(function(e){n.searchNodeByQuestionType(e,t,o)});if(e instanceof LeafNode){var a=e.question;a.extras&&a.extras.type&&a.extras.type===t&&o.push(e)}},e.prototype.findNodesByQuestionId=function(e,t,o){var n=this;if(e.question.key===t&&o.push(e),e instanceof GroupNode){var r=e;for(var i in r.children)this.findNodesByQuestionId(r.children[i],t,o)}e instanceof ArrayNode&&e.children.forEach(function(e){n.findNodesByQuestionId(e,t,o)})},Object.defineProperty(e.prototype,"valid",{get:function(){return this.rootNode.control.valid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showErrors",{get:function(){return this._showErrors},set:function(e){this._showErrors=e},enumerable:!0,configurable:!0}),e.prototype.markInvalidControls=function(e,t){var o=this,n=e.children;for(var r in n)if(n.hasOwnProperty(r)){var i=n[r];if(i instanceof GroupNode)this.markInvalidControls(i,t);else if(i instanceof LeafNode){var a=i.question;if(a.key&&0<a.key.length){var s=i.control;s.valid||s.disabled||(t&&t.push(i),s.markAsTouched())}}else if(i instanceof ArrayNode){var l=i;l&&l.children&&0<l.children.length&&_.forEach(l.children,function(e){o.markInvalidControls(e,t)})}}return t},e.prototype.updateHiddenDisabledStateForAllControls=function(){this._updateHiddenDisabledStateForAllControls(this.rootNode)},e.prototype.updateAlertsForAllControls=function(){this._updateAlertsForAllControls(this.rootNode)},e.prototype._updateAlertsForAllControls=function(e){var t=this;if(e.control&&e.control.updateAlert&&e.control.updateAlert(),e instanceof GroupNode){var o=e;for(var n in o.children)this._updateAlertsForAllControls(o.children[n])}e instanceof ArrayNode&&e.children.forEach(function(e){t._updateAlertsForAllControls(e)})},e.prototype._updateHiddenDisabledStateForAllControls=function(e){var t=this;if(e.control&&(e.control.updateDisabledState&&e.control.updateDisabledState(),e.control.updateHiddenState&&e.control.updateHiddenState()),e instanceof GroupNode){var o=e;for(var n in o.children)this._updateHiddenDisabledStateForAllControls(o.children[n])}e instanceof ArrayNode&&e.children.forEach(function(e){t._updateHiddenDisabledStateForAllControls(e)})},e}(),FormFactory=function(){function e(e,t,o){this.controlService=e,this.questionFactroy=t,this.controlRelationsFactory=o,this.hd={getValue:function(){return 20}}}return e.prototype.createForm=function(e,t){var o=new Form(e,this,this.questionFactroy);if(t)for(var n in t)t.hasOwnProperty(n)&&o.dataSourcesContainer.registerDataSource(n,t[n],!1);var r=this.questionFactroy.createQuestionModel(e,o);return o.rootNode=this.createNode(r,null,null,o),this.buildRelations(o.rootNode),o.updateHiddenDisabledStateForAllControls(),o.updateAlertsForAllControls(),o},e.prototype.buildRelations=function(e){Validations.JSExpressionValidatorsEnabled=!1,this.controlRelationsFactory.buildRelations(e),Validations.JSExpressionValidatorsEnabled=!0},e.prototype.createNode=function(e,t,o,n){return e instanceof NestedQuestion?e instanceof RepeatingQuestion?this.createArrayNode(e,t,o,n):this.createGroupNode(e,t,o,n):this.createLeafNode(e,t,o,n)},e.prototype.createLeafNode=function(e,t,o,n){var r=this.controlService.generateControlModel(e,o,!1,n);return new LeafNode(e,r,null,n,t?t.path:undefined)},e.prototype.createGroupNode=function(e,t,o,n){var r=this.controlService.generateControlModel(e,o,!1,n),i=new GroupNode(e,r,null,n,t?t.path:undefined);return this.createNodeChildren(e,i,r||o,n),i},e.prototype.createArrayNode=function(e,t,o,n){var r=this,i=this.controlService.generateControlModel(e,o,!1,n),a=new ArrayNode(e,i,o,this,n,t?t.path:undefined);return a.createChildFunc=this.createArrayNodeChild,a.removeChildFunc=this.removeArrayNodeChild,a.addChildNodeCreatedListener(function(e){Validations.JSExpressionValidatorsEnabled=!1,r.controlRelationsFactory.buildArrayNodeRelations(e),Validations.JSExpressionValidatorsEnabled=!0}),a},e.prototype.createNodeChildren=function(e,o,n,r){var i=this;return e.questions.forEach(function(e){var t=i.createNode(e,o,n,r);o.setChild(e.key,t)}),o.children},e.prototype.createArrayNodeChild=function(e,t,o){null!==o&&o!==undefined||(o=this);var n=new QuestionGroup({key:t.path+"."+t.children.length,type:"group",extras:e.extras,label:"",questions:e.questions});e.controlType===AfeControlType.None&&(n.controlType=e.controlType);var r=o.createGroupNode(n,null,null,t.form);if(t.children.push(r),t.control instanceof AfeFormArray){var i=t.control;i.setControl(i.controls.length,r.control)}return r},e.prototype.removeArrayNodeChild=function(e,t){var o=t.children[e];if(t.children.splice(e,1),(null!==t.control||t.control!==undefined)&&t.control instanceof AfeFormArray){var n=t.control,r=n.controls.indexOf(o.control);0<=r&&n.removeAt(r)}},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[{type:FormControlService},{type:QuestionFactory},{type:ControlRelationsFactory}]},e}(),moment$5=moment_,ObsAdapterHelper=function(){function e(){}return e.prototype.findObsAnswerToQuestion=function(t,e){var o=this,n=[];if(!this.isObsNode(t))return n;if(t instanceof LeafNode||t instanceof GroupNode&&"complex-obs"===t.question.extras.type)return _.each(e,function(e){e.concept&&e.concept.uuid===t.question.extras.questionOptions.concept&&n.push(e)}),n;var r=this.getChildQuestionsConceptUuids(t);return 0<r.length&&_.each(e,function(e){e.concept&&e.concept.uuid===t.question.extras.questionOptions.concept&&Array.isArray(e.groupMembers)&&o.isSubsetOf(r,o.getGroupMembersConceptUuids(e))&&n.push(e)}),n},e.prototype.getChildQuestionsConceptUuids=function(e){var t=[];return e.question.extras&&e.question.extras.questions&&_.each(e.question.extras.questions,function(e){e.questionOptions&&e.questionOptions.concept&&t.push(e.questionOptions.concept)}),t},e.prototype.getGroupMembersConceptUuids=function(e){var t=[];return Array.isArray(e.groupMembers)&&_.each(e.groupMembers,function(e){t.push(e.concept.uuid)}),t},e.prototype.isObsNode=function(e){return e.question.extras&&("obs"===e.question.extras.type||"obsGroup"===e.question.extras.type||"complex-obs"===e.question.extras.type||"complex-obs-child"===e.question.extras.type)},e.prototype.isSubsetOf=function(t,e){return 0===e.length&&0===t.length||e.every(function(e){return 0<=t.indexOf(e)})},e.prototype.setSimpleObsNodeValue=function(e,t){if(e&&0<t.length){var o=t[0];e.initialValue=o,!this.isEmpty(o.value)&&o.value.uuid?this.setNodeFormControlValue(e,o.value.uuid):this.isEmpty(o.value)||this.setNodeFormControlValue(e,o.value)}},e.prototype.setMultiselectObsNodeValue=function(e,t){if(e&&0<t.length){e.initialValue=t;var o=[];try{for(var n=__values(t),r=n.next();!r.done;r=n.next()){var i=r.value;o.push(i.value.uuid)}}catch(l){a={error:l}}finally{try{r&&!r.done&&(s=n["return"])&&s.call(n)}finally{if(a)throw a.error}}this.setNodeFormControlValue(e,o)}var a,s},e.prototype.setComplexObsNodeValue=function(e,t){if(e&&0<t.length){var o=void 0,n=void 0,r=e;for(var i in r.children)"value"===r.children[i].question.extras.questionOptions.obsField&&(o=r.children[i]),"obsDatetime"===r.children[i].question.extras.questionOptions.obsField&&(n=r.children[i]);this.setNodeValue(o,t),e.initialValue=o.initialValue,n.initialValue=o.initialValue,this.setNodeFormControlValue(n,o.initialValue.obsDatetime)}},e.prototype.setGroupObsNodeValue=function(e,t){if(e&&0<t.length){var o=e;for(var n in o.initialValue=t[0],o.children)this.setNodeValue(o.children[n],t[0].groupMembers)}},e.prototype.setRepeatingGroupObsNodeValue=function(e,t){if(e&&0<t.length){var o=e;o.initialValue=t;for(var n=0;n<t.length;n++){var r=o.createChildNode();this.setGroupObsNodeValue(r,[t[n]])}}},e.prototype.setNodeValue=function(e,t){switch(this.getObsNodeType(e)){case"unknown":if(e instanceof GroupNode){var o=e;for(var n in o.children)this.setNodeValue(o.children[n],t);break}if(e instanceof ArrayNode){for(var r=e,i=0;i<r.children.length;i++)this.setNodeValue(r.children[i],t);break}break;case"simple":var a=this.findObsAnswerToQuestion(e,t);this.setSimpleObsNodeValue(e,a);break;case"multiselect":var s=this.findObsAnswerToQuestion(e,t);this.setMultiselectObsNodeValue(e,s);break;case"complex":var l=this.findObsAnswerToQuestion(e,t);this.setComplexObsNodeValue(e,l);break;case"group":var u=this.findObsAnswerToQuestion(e,t);0<u.length&&this.setGroupObsNodeValue(e,u);break;case"repeatingGroup":var c=this.findObsAnswerToQuestion(e,t);0<c.length&&this.setRepeatingGroupObsNodeValue(e,c);break;default:console.error("Unknown obs node",e)}},e.prototype.setNodeFormControlValue=function(e,t){e.control.setValue(t),e.question.enableHistoricalValue&&e.initialValue!==undefined&&e.question.setHistoricalValue(!1)},e.prototype.getObsNodeType=function(e){return this.isObsNode(e)?e instanceof LeafNode&&("multiCheckbox"===e.question.extras.questionOptions.rendering||"checkbox"===e.question.extras.questionOptions.rendering)?"multiselect":e instanceof LeafNode?"simple":e instanceof GroupNode&&"complex-obs"===e.question.extras.type?"complex":e instanceof ArrayNode&&"obsGroup"===e.question.extras.type&&"repeating"===e.question.extras.questionOptions.rendering?"repeatingGroup":e instanceof GroupNode&&"obsGroup"===e.question.extras.type?"group":"unknownObs":"unknown"},e.prototype.getSimpleObsPayload=function(e){if(this.isEmpty(e.control.value))return e.initialValue?{uuid:e.initialValue.uuid,voided:!0}:null;if(e.initialValue&&!this.simpleNodeValueChanged(e))return null;var t={concept:e.question.extras.questionOptions.concept,value:e.control.value};return"date"===e.question.extras.questionOptions.rendering&&(t.value=this.toOpenMrsDateTimeString(e.control.value)),e.initialValue&&(delete t.concept,t.uuid=e.initialValue.uuid),t},e.prototype.getComplexObsPayload=function(e){var t,o,n=e;for(var r in n.children)"value"===n.children[r].question.extras.questionOptions.obsField&&(t=n.children[r]),"obsDatetime"===n.children[r].question.extras.questionOptions.obsField&&(o=n.children[r]);var i=this.getObsNodePayload(t);if(0<i.length)return i[0].obsDatetime=this.toOpenMrsDateTimeString(o.control.value),i[0];if(0===i.length&&e.initialValue&&!this.areDatesEqual(e.initialValue.obsDatetime,o.control.value)){var a={uuid:e.initialValue.uuid};return a.obsDatetime=this.toOpenMrsDateTimeString(o.control.value),a}return null},e.prototype.getMultiselectObsPayload=function(t){var o=[],n=[];return Array.isArray(t.initialValue)&&_.each(t.initialValue,function(e){n.push(e.value.uuid),Array.isArray(t.control.value)?t.control.value.indexOf(e.value.uuid)<0&&o.push({uuid:e.uuid,voided:!0}):o.push({uuid:e.uuid,voided:!0})}),Array.isArray(t.control.value)&&_.each(t.control.value,function(e){n.indexOf(e)<0&&o.push({concept:t.question.extras.questionOptions.concept,value:e})}),o},e.prototype.getGroupPayload=function(e){var o=this,t=e,n=[];if(_.each(t.children,function(e){var t=o.getObsNodePayload(e);0<t.length&&(n=n.concat(t))}),0===n.length)return null;var r={groupMembers:n};return t.initialValue?r.uuid=t.initialValue.uuid:r.concept=t.question.extras.questionOptions.concept,r},e.prototype.getRepeatingGroupPayload=function(e){var o=this,t=e,n=[],r=[];return _.each(t.children,function(e){var t=o.getObsNodePayload(e);0<t.length&&(n=n.concat(t)),e.initialValue&&e.initialValue.uuid&&r.push(e.initialValue.uuid)}),t.initialValue&&Array.isArray(t.initialValue)&&_.each(t.initialValue,function(e){if(r.indexOf(e.uuid)<0){var t={uuid:e.uuid,voided:!0};n.push(t)}}),n.length<=0?null:n},e.prototype.getObsNodePayload=function(e){var t=[];switch(this.getObsNodeType(e)){case"unknown":if(e instanceof GroupNode){var o=e;for(var n in o.children){var r=this.getObsNodePayload(o.children[n]);Array.isArray(r)&&0<r.length&&(t=t.concat(r))}break}if(e instanceof ArrayNode){for(var i=e,a=0;a<i.children.length;a++){var s=this.getObsNodePayload(i.children[a]);Array.isArray(s)&&0<s.length&&(t=t.concat(s))}break}break;case"simple":var l=this.getSimpleObsPayload(e);null!==l&&t.push(l);break;case"multiselect":var u=this.getMultiselectObsPayload(e);Array.isArray(u)&&0<u.length&&(t=t.concat(u));break;case"complex":var c=this.getComplexObsPayload(e);null!==c&&t.push(c);break;case"group":var p=this.getGroupPayload(e);p&&null!==p&&t.push(p);break;case"repeatingGroup":var d=this.getRepeatingGroupPayload(e);Array.isArray(d)&&0<d.length&&(t=t.concat(d))}return t},e.prototype.simpleNodeValueChanged=function(e){return!!e.initialValue&&(e.initialValue.value&&e.initialValue.value.uuid?e.control.value!==e.initialValue.value.uuid:"date"===e.question.extras.questionOptions.rendering?!this.areDatesEqual(e.control.value,e.initialValue.value):e.control.value!==e.initialValue.value)},e.prototype.areDatesEqual=function(e,t){return moment$5(e).isSame(t)},e.prototype.isEmpty=function(e){return""===e||null===e||e===undefined},e.prototype.toOpenMrsDateTimeString=function(e){if(this.isEmpty(e))return undefined;var t=e.substring(0,19).replace("T"," ");return this.isEmpty(t)?undefined:t},e}(),ObsValueAdapter=function(){function e(e){this.helper=e}return e.prototype.generateFormPayload=function(e){return this.helper.getObsNodePayload(e.rootNode)},e.prototype.populateForm=function(e,t){this.helper.setNodeValue(e.rootNode,t)},e.prototype.setValues=function(e,o,n){if(e){var t=function(t){if(t instanceof LeafNode)r.setObsValue(t,o),t.question.enableHistoricalValue&&t.initialValue!==undefined&&t.question.setHistoricalValue(!1);else if(t.question&&t.question.extras&&"group"===t.question.renderingType||n){var e=_.find(o,function(e){return e.concept.uuid===t.question.extras.questionOptions.concept&&e.groupMembers});e&&(t.node&&(t.node.initialValue=e),r.setValues(t.groupMembers,e.groupMembers)),n&&t.payload&&r.setValues(t.groupMembers,t.payload.groupMembers)}else if(t instanceof GroupNode&&"complex-obs"===t.question.extras.type)r.setComplexObsValue(t,o);else{if(!t.question||!t.question.extras||"repeating"!==t.question.renderingType||n)throw new Error("not implemented");r.setRepeatingGroupValues(t,o),t.node.control.updateValueAndValidity()}},r=this;try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){t(a.value)}}catch(u){s={error:u}}finally{try{a&&!a.done&&(l=i["return"])&&l.call(i)}finally{if(s)throw s.error}}}var s,l},e.prototype.setObsValue=function(t,e){if(t.question&&t.question.extras&&("obs"===t.question.extras.type||"complex-obs-child"===t.question.extras.type&&"value"===t.question.extras.questionOptions.obsField)&&"multiCheckbox"!==t.question.extras.questionOptions.rendering||"checkbox"!==t.question.extras.questionOptions.rendering){var o=_.find(e,function(e){return e.concept.uuid===t.question.extras.questionOptions.concept});o&&(o.value instanceof Object?t.control.setValue(o.value.uuid):t.control.setValue(o.value),t.control.updateValueAndValidity(),t.initialValue={obsUuid:o.uuid,value:o.value})}else{var n=_.filter(e,function(e){return e.concept.uuid===t.question.extras.questionOptions.concept});n&&0<n.length&&(t.control.setValue(this.getMultiselectValues(n)),t.control.updateValueAndValidity(),t.initialValue=n)}},e.prototype.setComplexObsValue=function(t,e){var o,n;for(var r in t.children)"value"===t.children[r].question.extras.questionOptions.obsField&&(o=t.children[r]),"obsDatetime"===t.children[r].question.extras.questionOptions.obsField&&(n=t.children[r]);this.setObsValue(o,e);var i=_.find(e,function(e){return e.concept.uuid===t.question.extras.questionOptions.concept});i&&(n.initialValue={obsUuid:i.uuid,value:i.obsDatetime},n.control.setValue(i.obsDatetime),n.control.updateValueAndValidity())},e.prototype.getMultiselectValues=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;n.push(a.value.uuid)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(o=r["return"])&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.setRepeatingGroupValues=function(i,e){var n=_.filter(e,function(e){var t=e.concept.uuid===i.question.extras.questionOptions.concept,o=!1;if(t&&e.groupMembers){var n=e.groupMembers.map(function(e){return e.concept.uuid}),r=i.question.questions.map(function(e){return e.extras.questionOptions.concept});o=0<_.intersection(n,r).length}return t&&o});if(0<n.length){i.node.initialValue=n;for(var t=0;t<n.length;t++)i.node.createChildNode()}var o,r,a=[],s=0,l=function(t){var e=Object.keys(t.children).map(function(e){return t.children[e]}),o=n[s];a.push({question:i.question,groupMembers:e,payload:o}),s++};try{for(var u=__values(i.node.children),c=u.next();!c.done;c=u.next()){l(c.value)}}catch(p){o={error:p}}finally{try{c&&!c.done&&(r=u["return"])&&r.call(u)}finally{if(o)throw o.error}}this.setValues(a,n,!0)},e.prototype.getQuestionNodes=function(e){var t,o,n,r,i=[];try{for(var a=__values(e),s=a.next();!s.done;s=a.next()){var l=s.value;try{for(var u=__values(l.page),c=u.next();!c.done;c=u.next()){var p=c.value;i.push(p.section)}}catch(d){n={error:d}}finally{try{c&&!c.done&&(r=u["return"])&&r.call(u)}finally{if(n)throw n.error}}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(o=a["return"])&&o.call(a)}finally{if(t)throw t.error}}return[].concat.apply([],i)},e.prototype.repeatingGroup=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;n.push({question:a.question,groupMembers:this.traverse(a)})}}catch(s){t={error:s}}finally{try{i&&!i.done&&(o=r["return"])&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.processGroup=function(e,t){if(e.question&&e.question.extras&&"group"===e.question.extras.questionOptions.rendering){var o=_.filter(this.getObsPayload(e.groupMembers),function(e){return""!==e.value}),n=o.map(function(e){return e.voided});0<o.length&&n.every(Boolean)?t.push({uuid:e.node.initialValue.uuid,voided:!0}):0<o.length&&(e.node.initialValue?t.push({uuid:e.node.initialValue.uuid,groupMembers:o}):t.push({concept:e.question.extras.questionOptions.concept,groupMembers:o}))}},e.prototype.mapInitialGroup=function(e){var t,o,n={};try{for(var r=__values(e.groupMembers),i=r.next();!i.done;i=r.next()){var a=i.value,s="";a.value instanceof Object?s=a.value.uuid:a.value?s=a.value:a.groupMembers&&0<a.groupMembers.length&&(n=this.mapInitialGroup(e)),n[a.concept.uuid+":"+s]=s}}catch(l){t={error:l}}finally{try{i&&!i.done&&(o=r["return"])&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.mapModelGroup=function(e,t){var o={};for(var n in t)if(t.hasOwnProperty(n)){var r=_.find(e.question.questions,{key:n}),i=t[n];i instanceof Object||""!==i&&(o[r.extras.questionOptions.concept+":"+i]=i)}return o},e.prototype.processRepeatingGroups=function(e,t){var o=[];if(e.node.initialValue)try{for(var n=__values(e.node.initialValue),r=n.next();!r.done;r=n.next()){var i=r.value;o.push({uuid:i.uuid,value:this.mapInitialGroup(i)})}}catch(D){c={error:D}}finally{try{r&&!r.done&&(p=n["return"])&&p.call(n)}finally{if(c)throw c.error}}var a=[];try{for(var s=__values(e.node.control.value),l=s.next();!l.done;l=s.next()){var u=l.value;a.push({value:this.mapModelGroup(e,u)})}}catch(_){d={error:_}}finally{try{l&&!l.done&&(h=s["return"])&&h.call(s)}finally{if(d)throw d.error}}var c,p,d,h,f,y,m,g,v=this.leftOuterJoinArrays(o,a),b=this.leftOuterJoinArrays(a,o),x=e.question.extras.questionOptions.concept,w=[];if(0<v.length){var C=this.createGroupDeletedObs(v);try{for(var O=__values(C),S=O.next();!S.done;S=O.next()){var k=S.value;t.push(k)}}catch(V){f={error:V}}finally{try{S&&!S.done&&(y=O["return"])&&y.call(O)}finally{if(f)throw f.error}}0<b.length&&(w=this.createGroupNewObs(b,x))}else w=this.createGroupNewObs(b,x);if(0<w.length)try{for(var q=__values(w),A=q.next();!A.done;A=q.next()){var E=A.value;t.push(E)}}catch(T){m={error:T}}finally{try{A&&!A.done&&(g=q["return"])&&g.call(q)}finally{if(m)throw m.error}}},e.prototype.leftOuterJoinArrays=function(e,o){return e.filter(function(t){return!o.some(function(e){return _.isEqual(t.value,e.value)})})},e.prototype.createGroupNewObs=function(e,t){var o,n,r=[];try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){var s=a.value,l=[];for(var u in s.value){var c=u.split(":")[0],p=u.split(":")[1];l.push({concept:c,value:p})}r.push({concept:t,groupMembers:l})}}catch(d){o={error:d}}finally{try{a&&!a.done&&(n=i["return"])&&n.call(i)}finally{if(o)throw o.error}}return r},e.prototype.createGroupDeletedObs=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;n.push({uuid:a.uuid,voided:!0})}}catch(s){t={error:s}}finally{try{i&&!i.done&&(o=r["return"])&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.getExactTime=function(e){return e.substring(0,19).replace("T"," ")},e.prototype.processObs=function(e,t){if(e.control&&e.question.extras){var o={concept:e.question.extras.questionOptions.concept,value:"date"!==e.question.extras.questionOptions.rendering||this.isEmpty(e.control.value)?e.control.value:this.getExactTime(e.control.value)};if("multiCheckbox"===e.question.extras.questionOptions.rendering||"checkbox"===e.question.extras.questionOptions.rendering){var n=this.processMultiSelect(e.question.extras.questionOptions.concept,e.control.value);if(e.initialValue){var r=e.initialValue.map(function(e){return{uuid:e.uuid,value:{concept:e.concept.uuid,value:e.value.uuid}}}),i=n.map(function(e){return{value:e}}),a=this.leftOuterJoinArrays(r,i),s=this.leftOuterJoinArrays(i,r);this.processDeletedMultiSelectObs(a,t),this.processNewMultiSelectObs(s,t)}else this.processNewMultiSelectObs(n,t)}else e.initialValue&&e.initialValue.value&&o?this.updateOrVoidObs(o,e.initialValue,t):""!==o.value&&null!==o.value&&t.push(o)}},e.prototype.processComplexObs=function(e,t){var o,n;for(var r in e.children)"value"===e.children[r].question.extras.questionOptions.obsField&&(o=e.children[r]),"obsDatetime"===e.children[r].question.extras.questionOptions.obsField&&(n=e.children[r]);if(o){this.processObs(o,t);var i=0<t.length?t[t.length-1]:undefined;i&&(i.concept&&i.concept===e.question.extras.questionOptions.concept||o.initialValue&&i.uuid===o.initialValue.obsUuid)&&n.initialValue&&n.control.value!==n.initialValue.value&&(i.obsDatetime=n.control.value)}},e.prototype.processDeletedMultiSelectObs=function(e,t){try{for(var o=__values(e),n=o.next();!n.done;n=o.next()){var r=n.value;t.push({uuid:r.uuid,voided:!0})}}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=o["return"])&&a.call(o)}finally{if(i)throw i.error}}var i,a},e.prototype.processNewMultiSelectObs=function(e,t){try{for(var o=__values(e),n=o.next();!n.done;n=o.next()){var r=n.value;r.value instanceof Object?t.push(r.value):t.push(r)}}catch(s){i={error:s}}finally{try{n&&!n.done&&(a=o["return"])&&a.call(o)}finally{if(i)throw i.error}}var i,a},e.prototype.updateOrVoidObs=function(e,t,o){this.isEmpty(e.value)&&t.value?o.push({uuid:t.obsUuid,voided:!0}):!this.isEmpty(e.value)&&t.value&&o.push({uuid:t.obsUuid,value:e.value})},e.prototype.isEmpty=function(e){return""===e||null===e||e===undefined},e.prototype.traverse=function(e,t){var o=[];if(e.children){if(e.children instanceof Array)return this.repeatingGroup(e.children);if(e.children instanceof Object)for(var n in e.children)if(e.children.hasOwnProperty(n))switch(e.children[n].question.renderingType){case"page":var r=this.traverse(e.children[n]);o.push({page:r});break;case"section":var i=this.traverse(e.children[n]);o.push({section:i});break;case"group":var a=this.traverse(e.children[n]);o.push({node:e.children[n],question:e.children[n].question,groupMembers:a});break;case"repeating":var s=this.repeatingGroup(e.children[n].children);o.push({node:e.children[n],question:e.children[n].question,groupMembers:s});break;default:o.push(e.children[n])}}return o},e.prototype.processMultiSelect=function(e,t){var o,n,r=[];if(t&&null!==t)try{for(var i=__values(t),a=i.next();!a.done;a=i.next()){var s={concept:e,value:a.value};r.push(s)}}catch(l){o={error:l}}finally{try{a&&!a.done&&(n=i["return"])&&n.call(i)}finally{if(o)throw o.error}}return r},e.prototype.isObs=function(e){return"obs"===e.question.extras.type||"obsGroup"===e.question.extras.type||"complex-obs"===e.question.extras.type},e.prototype.getObsPayload=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;this.isObs(a)&&(a.groupMembers,"group"===a.question.extras.questionOptions.rendering?this.processGroup(a,n):(a.groupMembers,"repeating"===a.question.extras.questionOptions.rendering?this.processRepeatingGroups(a,n):a instanceof GroupNode&&"complex-obs"===a.question.extras.type?this.processComplexObs(a,n):this.processObs(a,n)))}}catch(s){t={error:s}}finally{try{i&&!i.done&&(o=r["return"])&&o.call(r)}finally{if(t)throw t.error}}return n},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[{type:ObsAdapterHelper}]},e}(),OrderValueAdapter=function(){function e(){this.formOrderNodes=[],this.provider=""}return e.prototype.generateFormPayload=function(e){return this.formOrderNodes=[],this._setOrderProvider(e),this._findTestOrderQuestionNodes(e.rootNode),this._createOrdersPayload(this.formOrderNodes,e)},e.prototype.populateForm=function(e,t){e.existingOrders=t,this.formOrderNodes=[],this._findTestOrderQuestionNodes(e.rootNode);var o=this._getExistingOrders(e);this._setOrderValues(this.formOrderNodes,o)},e.prototype._setOrderProvider=function(e){e.valueProcessingInfo.providerUuid&&(this.provider=e.valueProcessingInfo.providerUuid)},e.prototype._createOrdersPayload=function(e,t){var o,n,r,a=[],s=[],l=this._getExistingOrders(t),i=function(e){var t=e.control.value,o=[];for(var n in l&&l.map(function(e){o[e.concept]=e.concept}),t)if(t.hasOwnProperty(n)){var r=t[n][e.question.key],i=u._createPayloadOrder(r,e.question.extras);o[r]!==r&&""!==i.concept&&a.push(i),s[r]=r,""===i.orderNumber&&delete i.orderNumber,""===i.uuid&&delete i.uuid}},u=this;try{for(var c=__values(e),p=c.next();!p.done;p=c.next()){i(p.value)}}catch(d){n={error:d}}finally{try{p&&!p.done&&(r=c["return"])&&r.call(c)}finally{if(n)throw n.error}}return o=this._getDeletedOrders(s,l),this._addDeletedOrdersToPayload(o,a)},e.prototype._getExistingOrders=function(e){if(e.existingOrders&&e.existingOrders.orders){var t=e.existingOrders.orders.map(function(e){return{concept:e.concept.uuid,orderNumber:e.orderNumber,orderUuid:e.uuid,voided:e.voided,dateVoided:e.auditInfo.dateVoided}});return _.filter(t,function(e){return!0!==e.voided&&!e.dateVoided})}},e.prototype._setOrderValues=function(e,t){this._findTestOrderQuestionNodes(e);var o,n,r=this.formOrderNodes;try{for(var i=__values(r),a=i.next();!a.done;a=i.next()){var s=a.value;this._setOrderNodeValues(s,t)}}catch(l){o={error:l}}finally{try{a&&!a.done&&(n=i["return"])&&n.call(i)}finally{if(o)throw o.error}}},e.prototype._addDeletedOrdersToPayload=function(e,t){for(var o in e)e.hasOwnProperty(o)&&t.push({uuid:e[o],voided:!0});return t},e.prototype._createPayloadOrder=function(e,t){var o={concept:"",type:"",orderer:"",careSetting:""};return o.concept=e,o.type=t.questionOptions.orderType,o.orderer=this.provider,o.careSetting=t.questionOptions.orderSettingUuid,""===o.orderer&&delete o.orderer,o},e.prototype._getDeletedOrders=function(e,t){var o=[];if(e)for(var n in t)if(t.hasOwnProperty(n)){var r=t[n].concept;e[r]!==r&&o.push(t[n].orderUuid)}return console.log("Deleted Orders ",o),o},e.prototype._setOrderNodeValues=function(e,t){var o,n,r=0;e.initialValue=t;try{for(var i=__values(t),a=i.next();!a.done;a=i.next()){var s=a.value;e.createChildNode();var l={};l[e.question.key]=s.concept;var u=e.children[r];u.control.setValue(l),u.initialValue=l,u.orderNumber=s.orderNumber,console.log("Set Value",e.children[r].control.value,e,u),r++}}catch(c){o={error:c}}finally{try{a&&!a.done&&(n=i["return"])&&n.call(i)}finally{if(o)throw o.error}}},e.prototype._findTestOrderQuestionNodes=function(e){if(e.children&&e.children instanceof Object)for(var t in e.children)if(e.children.hasOwnProperty(t))switch(e.children[t].question.renderingType){case"page":case"section":case"group":this._findTestOrderQuestionNodes(e.children[t]);break;case"repeating":if(e.children)for(var o in e.children){var n=e.children[o].question;n.extras&&"testOrder"===n.extras.type&&this.formOrderNodes.push(e.children[o])}}},e.decorators=[{type:core.Injectable}],e}(),moment$6=moment_,EncounterAdapter=function(){function e(e,t){this.ordersAdapter=e,this.obsAdapter=t}return e.prototype.populateForm=function(e,t){this.populateNode(e.rootNode,t),Array.isArray(t.orders)&&this.ordersAdapter.populateForm(e,t),Array.isArray(t.obs)&&this.obsAdapter.populateForm(e,t.obs)},e.prototype.populateNode=function(e,o){if(o===undefined||null===o)throw new Error("Expected payload");this.getEncounterNodes(e).forEach(function(e){switch(e.question.extras.type){case"encounterDatetime":o.encounterDatetime&&(console.log("date",o.encounterDatetime),e.control.setValue(moment$6(o.encounterDatetime).toDate()),e.initialValue=moment$6(o.encounterDatetime).toDate());break;case"encounterProvider":if(Array.isArray(o.encounterProviders)&&0<o.encounterProviders.length){var t=o.encounterProviders[0].provider;t&&t.uuid&&(e.control.setValue(t.uuid),e.initialValue=t.uuid)}break;case"encounterLocation":o.location&&o.location.uuid&&(e.control.setValue(o.location.uuid),e.initialValue=o.location.uuid)}})},e.prototype.generateFormPayload=function(e){var t=this.generateNodePayload(e.rootNode);return this.setNonFilledPayloadMembers(e,t),t.obs=this.obsAdapter.generateFormPayload(e)||[],t.orders=this.ordersAdapter.generateFormPayload(e)||[],t},e.prototype.generateNodePayload=function(n){var e=this.getEncounterNodes(n),r={};return e.forEach(function(e){if(null!==e.control.value&&e.control.value!==undefined&&""!==e.control.value)switch(e.question.extras.type){case"encounterDatetime":var t=moment$6(e.control.value).utcOffset(n.form.valueProcessingInfo.utcOffset||"+0300");r.encounterDatetime=t.format("YYYY-MM-DD HH:mm:ss");break;case"encounterProvider":if(e.control.value&&""!==e.control.value){var o=[];o.push({provider:e.control.value,encounterRole:"a0b03050-c99b-11e0-9572-0800200c9a66"}),r.encounterProviders=o}break;case"encounterLocation":r.location=e.control.value}}),r},e.prototype.getEncounterNodes=function(e){var t=[];return this._getEncounterNodes(e,t),t},e.prototype.setNonFilledPayloadMembers=function(e,t){e.valueProcessingInfo.patientUuid&&this.setPayloadPatientUuid(t,e.valueProcessingInfo.patientUuid),e.valueProcessingInfo.visitUuid&&this.setPayloadVisitUuid(t,e.valueProcessingInfo.visitUuid),e.valueProcessingInfo.encounterTypeUuid&&this.setPayloadEncounterTypeUuid(t,e.valueProcessingInfo.encounterTypeUuid),e.valueProcessingInfo.formUuid&&this.setPayloadFormUuid(t,e.valueProcessingInfo.formUuid),e.valueProcessingInfo.encounterUuid&&this.setPayloadEncounterUuid(t,e.valueProcessingInfo.encounterUuid)},e.prototype.setPayloadPatientUuid=function(e,t){e.patient=t},e.prototype.setPayloadVisitUuid=function(e,t){e.visit=t},e.prototype.setPayloadEncounterTypeUuid=function(e,t){e.encounterType=t},e.prototype.setPayloadFormUuid=function(e,t){e.form=t},e.prototype.setPayloadEncounterUuid=function(e,t){e.uuid=t},e.prototype._getEncounterNodes=function(e,t){var o=this;if(this._isEncounterNode(e)&&t.push(e),e instanceof GroupNode){var n=e;for(var r in n.children)n.children[r]instanceof NodeBase&&this._getEncounterNodes(n.children[r],t)}e instanceof ArrayNode&&(n=e).children.forEach(function(e){o._getEncounterNodes(e,t)})},e.prototype._isEncounterNode=function(e){return!(!e.question.extras||"encounterDatetime"!==e.question.extras.type&&"encounterProvider"!==e.question.extras.type&&"encounterLocation"!==e.question.extras.type)},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[{type:OrderValueAdapter},{type:ObsValueAdapter}]},e}(),PersonAttribuAdapter=function(){function e(){}return e.prototype.generateFormPayload=function(e){return this.generateNodePayload(e.rootNode)},e.prototype.generateNodePayload=function(e){var t=this.getPersonAttributeNodes(e),o=[];return t.forEach(function(e){null!==e.control.value&&e.control.value!==undefined&&""!==e.control.value&&e.initialValue!==e.control.value&&(!0===e.question.extras.questionOptions.isSimpleValue?o.push({attributeType:e.question.extras.questionOptions.attributeType,value:e.control.value}):o.push({attributeType:e.question.extras.questionOptions.attributeType,hydratedObject:e.control.value}))}),o},e.prototype.populateForm=function(e,t){this.populateNode(e.rootNode,t)},e.prototype.populateNode=function(e,o){if(!Array.isArray(o))throw new Error("Expected an array of attributes");this.getPersonAttributeNodes(e).forEach(function(t){o.forEach(function(e){e.attributeType.uuid===t.question.extras.questionOptions.attributeType&&(e.value.uuid?(t.control.setValue(e.value.uuid),t.initialValue=e.value.uuid):(t.control.setValue(e.value),t.initialValue=e.value))})})},e.prototype.getPersonAttributeNodes=function(e){var t=[];return this._getPersonAttributesNodes(e,t),t},e.prototype._getPersonAttributesNodes=function(e,t){var o=this;if(e.question.extras&&"personAttribute"===e.question.extras.type&&t.push(e),e instanceof GroupNode){var n=e;for(var r in n.children)n.children[r]instanceof NodeBase&&this._getPersonAttributesNodes(n.children[r],t)}e instanceof ArrayNode&&(n=e).children.forEach(function(e){o._getPersonAttributesNodes(e,t)})},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[]},e}(),RemoteSelectComponent=function(){function e(e){this.renderer=e,this.placeholder="Search...",this.items=[],this.value=[],this.loading=!1,this.searchText="",this.notFoundMsg="match no found",this.done=new core.EventEmitter,this.characters=[],this.propagateChange=function(e){}}return Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(e){this._dataSource=e,this._dataSource&&this._dataSource.dataFromSourceChanged&&this.subscribeToDataSourceDataChanges()},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.subscribeToDataSourceDataChanges=function(){var t=this;this._dataSource.dataFromSourceChanged.subscribe(function(e){0<e.length?(t.items=e,t.notFoundMsg="",t.restoreSelectedValue(t.selectC.value,e)):(t.notFoundMsg="Not found",t.items=[])})},e.prototype.typed=function(e){this.search(e)},e.prototype.search=function(e){var o=this;this.dataSource&&(this.searchText=e,this.notFoundMsg="Loading.........",this.dataSource.searchOptions(e).subscribe(function(e){if(0<e.length){var t=_.map(o.value,_.clone).concat(e);o.items=_.uniqBy(t,"value")}o.notFoundMsg=""},function(e){o.notFoundMsg="Errored"}))},e.prototype.restoreSelectedValue=function(t,e){var o=this,n=!1;_.each(e,function(e){e.value===t&&(setTimeout(function(){o.selectC.select(t),o.selectC.value=t}),n=!0)}),n||setTimeout(function(){o.selectC.select(""),o.selectC.value=""})},e.prototype.canSearch=function(e){return(2<=e.length-this.searchText.length||e.length-this.searchText.length<=2&&""!==e)&&!1===this.loading},e.prototype.writeValue=function(e){var t=this;e&&""!==e&&this.dataSource&&(this.loading=!0,this.dataSource.resolveSelectedValue(e).subscribe(function(e){t.items=[e],setTimeout(function(){t.selectC.select(e.value),t.selectC.value=e.value}),t.loading=!1},function(e){t.loading=!1}))},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(){},e.prototype.onChange=function(e){this.propagateChange(e.id)},e.prototype.removed=function(e){console.log("Removed"),this.propagateChange("")},e.prototype.selected=function(e){this.propagateChange(e.value)},e.decorators=[{type:core.Component,args:[{selector:"remote-select",template:'<div>\n    <ng-select [id]="componentID" [noFilter]="0" (selected)="selected($event)" (deselected)="removed($event)" [options]="items" [allowClear]="true"\n        [placeholder]="placeholder" [notFoundMsg]="notFoundMsg" (typed)="typed($event)" tabindex="0">\n    </ng-select>\n    <div *ngIf="loading">\n        resolving....\n    </div>\n</div>\n',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef(function(){return e}),multi:!0}]}]}],e.ctorParameters=function(){return[{type:core.Renderer2}]},e.propDecorators={placeholder:[{type:core.Input}],componentID:[{type:core.Input}],done:[{type:core.Output}],selectC:[{type:core.ViewChild,args:[SelectComponent]}],dataSource:[{type:core.Input}]},e}(),RemoteSelectModule=function(){function e(){}return e.decorators=[{type:core.NgModule,args:[{imports:[common.CommonModule,SelectModule,forms.FormsModule],exports:[RemoteSelectComponent],declarations:[RemoteSelectComponent],providers:[]}]}],e}(),moment$7=moment_,AppointmentsOverviewComponent=function(){function e(){this.showAppointments=!1,this.loadingAppointments=!1,this.errorLoadingAppointments=!1,this.appointmentsLoaded=!1,this.appointments=[],this.today=""}return e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(){var u=this;this.node.control.valueChanges.subscribe(function(e){u.resetProperties();var t=u.node;if(t.question.extras.questionOptions.concept&&("a8a666ba-1350-11df-a1f1-0026b9348838"===t.question.extras.questionOptions.concept||"a89d2398-1350-11df-a1f1-0026b9348838"===t.question.extras.questionOptions.concept)&&(console.log("what change is here",u.showAppointments),!u.showAppointments)){u.loadingAppointments=!0,u.showAppointments=!0;var o=void 0;t.form&&t.form.dataSourcesContainer.dataSources&&(o=t.form.dataSourcesContainer.dataSources.monthlyScheduleResourceService);var n=t.form.dataSourcesContainer.dataSources.userLocation.uuid;if(o&&n){var r=moment$7(e).startOf("week").add(1,"day").format("YYYY-MM-DD"),i=moment$7(e).endOf("week").subtract(1,"day").format("YYYY-MM-DD");u.today=moment$7(e).format("DD-MM-YYYY");for(var a=[],s=encodeURI(JSON.stringify({programType:["781d85b0-1359-11df-a1f1-0026b9348838","781d897a-1359-11df-a1f1-0026b9348838","96047aaf-7ab3-45e9-be6a-b61810fe617d","c19aec66-1a40-4588-9b03-b6be55a8dd1d","f7793d42-11ac-4cfd-9b35-e0a21a7a7c31","334c9e98-173f-4454-a8ce-f80b20b7fdf0","96ba279b-b23b-4e78-aba9-dcbd46a96b7b","781d8880-1359-11df-a1f1-0026b9348838"]})),l=1;l<=5;l++)a.push({date:moment$7(e).startOf("week").add(l,"day").format("DD-MM-YYYY"),count:0});o.getMonthlySchedule({startDate:r,endDate:i,limit:5,locationUuids:n,programVisitEncounter:s}).subscribe(function(o){u.appointmentsLoaded=!0,u.loadingAppointments=!1,a.map(function(e,t){e.count=o[t]!==undefined?o[t].count.scheduled:0}),u.appointments=a},function(e){u.loadingAppointments=!1,u.errorLoadingAppointments=!0,u.showAppointments=!1,console.error(e)})}else u.showAppointments=!1,u.errorLoadingAppointments=!0}})},e.prototype.resetProperties=function(){this.loadingAppointments=!1,this.appointmentsLoaded=!1,this.errorLoadingAppointments=!1,this.showAppointments=!1,this.appointments=[],this.today=""},e.decorators=[{type:core.Component,args:[{selector:"appointments-overview",template:'<div *ngIf="showAppointments" class="appointments">\n  <p *ngIf="loadingAppointments">\n    <span *ngIf="!appointmentsLoaded && errorLoadingAppointments">Error checking appointments</span>\n    <span *ngIf="loadingAppointments"><span\n      class="fa fa-spinner fa-spin"></span>Checking appointments...</span>\n  </p>\n  <div *ngIf="appointmentsLoaded && !errorLoadingAppointments">\n    <table *ngIf="appointments.length>0" class="table table-stripped table-bordered">\n      <thead>\n      <tr>\n        <th *ngFor="let appointment of appointments" [ngClass]="{\'active\': appointment.date === today}">\n          <span>{{appointment.date}}</span>\n        </th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr>\n        <td *ngFor="let appointment of appointments"\n            [ngClass]="{\'active\': appointment.date === today}">\n          <span><strong><em>{{appointment.count}}</em></strong></span>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n',styles:[".appointments{margin-top:12px;font-size:12px;color:#999}.appointments p{padding-top:12px}.appointments th{border-bottom:0!important;color:#333}.appointments td span,.appointments th span{display:block}.appointments td.active,.appointments th.active{background-color:#3c8dbc;color:#fff!important;padding:0}.appointments td.active span,.appointments th.active span{padding:4px}.appointments span.fa{display:inline-block;margin-right:7px}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={node:[{type:core.Input}]},e}(),EncounterViewerService=function(){function e(){}return e.prototype.resolveSelectedValue=function(e){},e.prototype.searchOptions=function(e){},e.prototype.fileUpload=function(e){},e.prototype.fetchFile=function(e){},e.prototype.resolveSelectedValueFromSchema=function(o,e){var n,r=this;return e.pages&&_.forEach(e.pages,function(e){var t=r.resolveSelectedValueFromSchema(o,e);t&&(n=t)}),e.sections&&_.forEach(e.sections,function(e){var t=r.resolveSelectedValueFromSchema(o,e);t&&(n=t)}),e.questions&&_.forEach(e.questions,function(e){if(e.questions){var t=r.resolveSelectedValueFromSchema(o,e);t&&(n=t)}else e.questionOptions.answers?_.forEach(e.questionOptions.answers,function(e){e.concept===o&&(n=e.label)}):e.questionOptions.selectableOrders&&_.forEach(e.questionOptions.selectableOrders,function(e){e.concept===o&&(n=e.label)})}),n},e.prototype.hasAnswer=function(e){var t=!1;return e.initialValue&&(t=!0),t},e.prototype.questionsAnswered=function(e,t){var o=this,n=t||[];if("page"===e.question.renderingType)_.forEach(e.children,function(e){o.questionsAnswered(e,n)});else{if("section"!==e.question.renderingType)return this.hasAnswer(e);_.forEach(e.children,function(e){"group"===e.question.renderingType?_.forEach(e.children,function(e){var t=o.questionsAnswered(e,n);t&&n.push(t)}):o.hasAnswer(e)&&n.push(!0)})}return 0<n.length},e.prototype.isDate=function(e){return!!Date.parse(e)},e.prototype.convertTime=function(e){var t=new Date(e),o=t.getFullYear(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],r=t.getDate(),i=t.getHours(),a=t.getMinutes();t.getSeconds();return 0===i&&0===a?r+" "+n+" "+o:r+" "+n+" "+o+" "+i+":"+a+(i<12?"AM":"PM")+" (EAT)"},e.decorators=[{type:core.Injectable}],e.ctorParameters=function(){return[]},e}(),EncounterViewerComponent=function(){function e(e,t){this.encounterViewerService=e,this.dataSources=t}return Object.defineProperty(e.prototype,"node",{set:function(e){this.rootNode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schema",{set:function(e){this._schema=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"encounter",{set:function(e){this.enc=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"form",{set:function(e){this.rootNode=e.rootNode,this._schema=e.schema,console.log(this.rootNode)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.rootNode&&this.rootNode.question.extras&&"file"===this.rootNode.question.renderingType?this.fileDataSource=this.dataSources.dataSources[this.rootNode.question.dataSource]:this.rootNode&&this.rootNode.question.extras&&"remote-select"===this.rootNode.question.renderingType?this.remoteDataSource=this.dataSources.dataSources[this.rootNode.question.dataSource]:this.customDataSource=this.encounterViewerService},e.prototype.questionsAnswered=function(e){return this.encounterViewerService.questionsAnswered(e)},e.prototype.questionAnswered=function(e){return this.encounterViewerService.hasAnswer(e)},e.prototype.checkForColon=function(e){return-1===e.indexOf(":")},e.decorators=[{type:core.Component,args:[{selector:"encounter-viewer",template:'<div class="viewer">\n\n\n  <div *ngIf="rootNode.question.renderingType === \'form\'" class="form">\n    <div *ngFor="let question of rootNode.question.questions; let i = index;">\n      <div *ngIf="questionsAnswered(rootNode.children[question.key])">\n        <div [attr.id]="\'page\'+i" class="panel panel-default">\n          <p class="page-label panel-heading text-primary">{{question.label}}</p>\n          <div class="panel-body">\n            <encounter-viewer [node]="rootNode.children[question.key]" [schema]="_schema" [parentComponent]="this" [parentGroup]="rootNode.control"></encounter-viewer>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div *ngIf="rootNode.question.renderingType === \'page\'" class="page">\n    <encounter-viewer *ngFor="let question of rootNode.question.questions" [parentComponent]="this" [node]="rootNode.children[question.key]"\n      [schema]="_schema" [parentGroup]="parentGroup"></encounter-viewer>\n  </div>\n\n\n  <div *ngIf="rootNode.question.renderingType === \'section\'&& questionsAnswered(rootNode)"\n    class="section">\n    <div class="panel panel-primary">\n      <p class="panel-heading section-label">{{ rootNode.question.label }}</p>\n    </div>\n    <div *ngFor="let question of rootNode.question.questions">\n      <encounter-viewer [node]="rootNode.children[question.key]" [parentComponent]="this" [schema]="_schema" [parentGroup]="parentGroup"></encounter-viewer>\n    </div>\n  </div>\n\n  \x3c!--Leaf Controls--\x3e\n  <div style="margin-left:10px;">\n  <form *ngIf="rootNode.question.controlType === 0" [formGroup]="parentGroup">\n    <div *ngIf="rootNode.control.value">\n    <div class="question-answer">\n      <label *ngIf="rootNode.question.label" [attr.for]="rootNode.question.key" style="font-weight:400;">\n          {{ rootNode.question.label }}\n      </label>\n      <span *ngIf="checkForColon(rootNode.question.label)">:</span>\n      <div [ngSwitch]="rootNode.question.renderingType" style="display:inline-block; font-weight:bold;">\n          <div *ngSwitchCase=" \'file\' ">\n            <file-preview [formControlName]="rootNode.question.key" [id]="rootNode.question.key + \'id\'" [dataSource]="fileDataSource"></file-preview>\n          </div>\n          <div *ngSwitchCase="\'remote-select\'">\n            <remote-answer [formControlName]="rootNode.question.key" [id]="rootNode.question.key + \'id\'" [dataSource]="remoteDataSource"></remote-answer>\n          </div>\n          <div *ngSwitchDefault style="display:inline-block">\n              <question-control [schema]="_schema" [value]="rootNode.control.value" [dataSource]="customDataSource"></question-control>\n            </div>\n      </div>\n     \n    </div>\n    </div>\n  </form>\n</div>\n\n  \x3c!--Array Controls--\x3e\n  <div *ngIf="rootNode.question.controlType === 1 && questionsAnswered(rootNode)">\n    <div [ngSwitch]="rootNode.question.renderingType">\n      <div *ngSwitchCase=" \'repeating\' ">\n        <div [ngSwitch]="rootNode.question.extras.type">\n          <div *ngSwitchCase="\'testOrder\'">\n            <label>{{rootNode.question.label}}:</label>\n            <div *ngFor="let child of rootNode.children; let i=index ">\n              <encounter-viewer *ngFor="let question of child.question.questions " [parentComponent]="this" [node]="child.children[question.key]\n                " [parentGroup]="child.control " [schema]="_schema"></encounter-viewer>\n            </div>\n          </div>\n          \n          <div *ngSwitchCase="\'obsGroup\'">\n            <div *ngFor="let child of rootNode.children; let i=index ">\n              <encounter-viewer *ngFor="let question of child.question.questions " [parentComponent]="this" [node]="child.children[question.key]\n                " [parentGroup]="child.control " [schema]="_schema"></encounter-viewer>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div *ngIf="rootNode.question.controlType === 2">\n\n    \x3c!--GROUP--\x3e\n    <div [ngSwitch]="rootNode.question.renderingType ">\n      <div *ngSwitchCase=" \'group\' ">\n        <encounter-viewer *ngFor="let question of rootNode.question.questions " [parentComponent]="this" [node]="rootNode.children[question.key]\n                  " [parentGroup]="rootNode.control " [schema]="_schema"></encounter-viewer>\n      </div>\n      <div *ngSwitchCase=" \'field-set\' ">\n        <encounter-viewer *ngFor="let question of rootNode.question.questions " [parentComponent]="this" [node]="rootNode.children[question.key]\n                  " [parentGroup]="rootNode.control " [schema]="_schema"></encounter-viewer>\n      </div>\n    </div>\n  </div>\n\n\n\n  </div>\n',styles:[".page-label{font-size:20px;font-weight:700}.section-label{font-size:18px;font-weight:500}.panel-primary{border:none!important}.question-answer{font-size:16px}.panel{margin-bottom:5px}div.section{margin-bottom:15px!important}.line-breaker{white-space:pre-line}hr{margin:10px}"]}]}],e.ctorParameters=function(){return[{type:EncounterViewerService},{type:DataSources}]},e.propDecorators={parentGroup:[{type:core.Input}],parentComponent:[{type:core.Input}],node:[{type:core.Input}],schema:[{type:core.Input}],encounter:[{type:core.Input}],form:[{type:core.Input}]},e}(),EncounterContainerComponent=function(){function e(e){this.encAdapter=e}return Object.defineProperty(e.prototype,"form",{set:function(e){this.$form=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"encounter",{set:function(e){this.$enc=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.decorators=[{type:core.Component,args:[{selector:"encounter-renderer",template:'<encounter-viewer class="card" [form]="$form" [encounter]="$enc"></encounter-viewer>\n\n\n',styles:[".card{box-shadow:0 2px 5px 0 rgba(0,0,0,.16),0 2px 10px 0 rgba(0,0,0,.12)}"]}]}],e.ctorParameters=function(){return[{type:EncounterAdapter}]},e.propDecorators={form:[{type:core.Input}],encounter:[{type:core.Input}]},e}(),QuestionControlComponent=function(){function e(){this.innerValue=""}return Object.defineProperty(e.prototype,"schema",{set:function(e){this._schema=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{set:function(e){this._value=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{set:function(e){this._dataSource=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.writeValue(this._value)},e.prototype.isUuid=function(e){return 36===e.length&&-1===e.indexOf(" ")&&-1===e.indexOf(".")},e.prototype.writeValue=function(e,t){var o=this;if(e!==this.innerValue)if(this.isUuid(e)){if(t)return this._dataSource.resolveSelectedValueFromSchema(e,this._schema);var n=this._dataSource.resolveSelectedValueFromSchema(e,this._schema);this.innerValue=n?n.toUpperCase():e}else if(_.isArray(e)){var r=[];_.forEach(e,function(e){r.push(o.writeValue(e,!0))}),this.innerValue=r}else if(this.isDate(e)){if(t)return this._dataSource.convertTime(e);this.innerValue=this._dataSource.convertTime(e)}else{if(t)return e;this.innerValue=e}},e.prototype.isDate=function(e){return this._dataSource.isDate(e)&&!_.isNumber(e)},e.decorators=[{type:core.Component,args:[{selector:"question-control",styles:["input{border:none;box-shadow:none;color:#000;background:#fff!important;padding-top:23px;display:block;position:relative}"],template:"<div>\n    {{innerValue}}\n</div>"}]}],e.ctorParameters=function(){return[]},e.propDecorators={schema:[{type:core.Input}],value:[{type:core.Input}],dataSource:[{type:core.Input}]},e}(),noop=function(){},FilePreviewComponent=function(){function e(e){this.encounterService=e,this.innerValue=null,this.onTouchedCallback=noop,this.onChangeCallback=noop}return Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(e){this._dataSource=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.innerValue},set:function(e){e!==this.innerValue&&(this.innerValue=e)},enumerable:!0,configurable:!0}),e.prototype.writeValue=function(e){e!==this.innerValue&&(this.innerValue=e)},e.prototype.registerOnChange=function(e){this.onChangeCallback=e},e.prototype.registerOnTouched=function(e){this.onTouchedCallback=e},e.prototype.onBlur=function(){this.onTouchedCallback()},e.prototype.onChange=function(e){},e.decorators=[{type:core.Component,args:[{selector:"file-preview",styles:[""],template:'<div *ngIf="innerValue">\n              <img class="img-responsive"\n                [src]="innerValue | secure:this._dataSource.fetchFile" alt="image" />\n                </div>',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef(function(){return e}),multi:!0}]}]}],e.ctorParameters=function(){return[{type:EncounterViewerService}]},e.propDecorators={source:[{type:core.Input}],dataSource:[{type:core.Input}]},e}(),noop$1=function(){},RemoteAnswerComponent=function(){function e(){this.innerValue=null,this.onTouchedCallback=noop$1,this.onChangeCallback=noop$1}return Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(e){this._dataSource=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.innerValue},set:function(e){e!==this.innerValue&&(this.innerValue=e)},enumerable:!0,configurable:!0}),e.prototype.writeValue=function(e){var t=this;e!==this.innerValue&&(this._dataSource?this._dataSource.resolveSelectedValue(e).subscribe(function(e){t.innerValue=e.label}):this.innerValue=e)},e.prototype.registerOnChange=function(e){this.onChangeCallback=e},e.prototype.registerOnTouched=function(e){this.onTouchedCallback=e},e.prototype.onBlur=function(){this.onTouchedCallback()},e.prototype.onChange=function(e){},e.decorators=[{type:core.Component,args:[{selector:"remote-answer",styles:[],template:'\n    <div *ngIf="innerValue">\n      {{innerValue}}\n      </div>\n',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef(function(){return e}),multi:!0}]}]}],e.ctorParameters=function(){return[]},e.propDecorators={source:[{type:core.Input}],dataSource:[{type:core.Input}]},e}(),EncounterViewerModule=function(){function e(){}return e.decorators=[{type:core.NgModule,args:[{declarations:[EncounterViewerComponent,EncounterContainerComponent,QuestionControlComponent,FilePreviewComponent,RemoteAnswerComponent],imports:[forms.FormsModule,forms.ReactiveFormsModule,common.CommonModule,http.HttpModule,SharedModule],providers:[EncounterViewerService],exports:[EncounterContainerComponent,http.HttpModule]}]}],e}(),CheckboxControlComponent=function(){function e(){this._value=[],this.onChange=function(e){},this.onTouched=function(){}}return e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){},e.prototype.writeValue=function(e){this.value=e},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},Object.defineProperty(e.prototype,"value",{get:function(){return 0===this._value.length?"":this._value||this._value[0]},set:function(e){if(null==e||""===e)e=[];else if("string"==typeof e)e=[e];else if(!Array.isArray(e))throw new TypeError("Value must be a string or an array.")},enumerable:!0,configurable:!0}),e.prototype.selectOpt=function(t,e){var o=this;e.target.checked?this._value.push(t.value):this.options.forEach(function(e){e.value===t.value&&o._value.splice(e,1)}),this.onChange(this.value)},e.decorators=[{type:core.Component,args:[{selector:"checkbox",template:'<div *ngFor="let option of options; let i = index;">\n    <label class="form-control no-border">\n        <input type="checkbox" id="i + \'id\'" (change)="selectOpt(option, $event)" value="option.value">\n        {{ option.label }}\n    </label>\n</div>',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef(function(){return e}),multi:!0}],styles:["\n  .no-border {\n    border: 0;\n    box-shadow: none;\n  }"]}]}],e.propDecorators={options:[{type:core.Input}]},e}(),CheckboxModule=function(){function e(){}return e.decorators=[{type:core.NgModule,args:[{declarations:[CheckboxControlComponent],exports:[CheckboxControlComponent],imports:[common.CommonModule,forms.FormsModule]}]}],e}(),FormEntryModule=function(){function e(){}return e.decorators=[{type:core.NgModule,args:[{imports:[common.CommonModule,forms.ReactiveFormsModule,collapse.CollapseModule,SelectModule,DateTimePickerModule,RemoteSelectModule,RemoteFileUploadModule,EncounterViewerModule,CheckboxModule,material.MatIconModule,material.MatTabsModule,material.MatCardModule,NgxDateTimePickerModule,SharedModule],declarations:[FormRendererComponent,AfeNgSelectComponent,AppointmentsOverviewComponent,HistoricalValueDirective,ErrorRendererComponent],providers:[forms.FormBuilder,FormControlService,FormErrorsService,ValidationFactory,HidersDisablersFactory,AlertsFactory,ExpressionRunner,JsExpressionHelper,HistoricalFieldHelperService,FormSchemaCompiler,FormFactory,QuestionFactory,ValidationFactory,ControlRelationsFactory,ObsAdapterHelper,ObsValueAdapter,EncounterAdapter,PersonAttribuAdapter,OrderValueAdapter,DebugModeService],exports:[FormRendererComponent,AfeNgSelectComponent,ErrorRendererComponent,DateTimePickerModule,EncounterViewerModule,NgxDateTimePickerModule]}]}],e}(),Pair=function(e,t){this.key=e,this.value=t},RenderingType={Form:0,Page:1,Section:2,Select:3,DropDown:4};RenderingType[RenderingType.Form]="Form",RenderingType[RenderingType.Page]="Page",RenderingType[RenderingType.Section]="Section",RenderingType[RenderingType.Select]="Select",RenderingType[RenderingType.DropDown]="DropDown",exports.FormEntryModule=FormEntryModule,exports.AfeFormControl=AfeFormControl,exports.AfeFormGroup=AfeFormGroup,exports.AfeFormArray=AfeFormArray,exports.AfeControlType=AfeControlType,exports.ControlRelationsFactory=ControlRelationsFactory,exports.FormControlService=FormControlService,exports.FormFactory=FormFactory,exports.Form=Form,exports.QuestionFactory=QuestionFactory,exports.ValidationFactory=ValidationFactory,exports.FormSchemaCompiler=FormSchemaCompiler,exports.HistoricalEncounterDataService=HistoricalEncounterDataService,exports.FormErrorsService=FormErrorsService,exports.EncounterAdapter=EncounterAdapter,exports.PersonAttribuAdapter=PersonAttribuAdapter,exports.OrderValueAdapter=OrderValueAdapter,exports.ObsValueAdapter=ObsValueAdapter,exports.ObsAdapterHelper=ObsAdapterHelper,exports.DataSources=DataSources,exports.CheckBoxQuestion=CheckBoxQuestion,exports.ConditionalValidationModel=ConditionalValidationModel,exports.DateQuestion=DateQuestion,exports.DateValidationModel=DateValidationModel,exports.FileUploadQuestion=FileUploadQuestion,exports.QuestionGroup=QuestionGroup,exports.JsExpressionValidationModel=JsExpressionValidationModel,exports.MaxValidationModel=MaxValidationModel,exports.MinValidationModel=MinValidationModel,exports.MultiSelectQuestion=MultiSelectQuestion,exports.Pair=Pair,exports.QuestionBase=QuestionBase,exports.RenderingType=RenderingType,exports.RepeatingQuestion=RepeatingQuestion,exports.Option=Option$1,exports.SelectQuestion=SelectQuestion,exports.TestOrderQuestion=TestOrderQuestion,exports.TextAreaInputQuestion=TextAreaInputQuestion,exports.TextInputQuestion=TextInputQuestion,exports.UiSelectQuestion=UiSelectQuestion,exports.ValidationModel=ValidationModel,exports.NestedQuestion=NestedQuestion,exports.DateTimePickerModule=DateTimePickerModule,exports.NgxDateTimePickerModule=NgxDateTimePickerModule,exports.bf=AfeNgSelectComponent,exports.bg=AppointmentsOverviewComponent,exports.ba=CheckboxControlComponent,exports.z=CheckboxModule,exports.g=DatePickerComponent,exports.k=DateTimePickerComponent,exports.i=ModalComponent,exports.j=MomentPipe,exports.h=TimePickerComponent,exports.q=RemoteFileUploadComponent,exports.n=RemoteFileUploadModule,exports.p=SecurePipe,exports.bb=MY_FORMATS,exports.bc=NgxDateTimePickerComponent,exports.m=RemoteSelectComponent,exports.l=RemoteSelectModule,exports.e=SelectDropdownComponent,exports.f=STYLE$1,exports.b=SELECT_VALUE_ACCESSOR,exports.c=SelectComponent,exports.d=STYLE,exports.a=SelectModule,exports.x=FilePreviewComponent,exports.w=QuestionControlComponent,exports.y=RemoteAnswerComponent,exports.v=EncounterContainerComponent,exports.s=EncounterViewerComponent,exports.r=EncounterViewerModule,exports.t=EncounterViewerService,exports.u=DataSources,exports.bh=HistoricalValueDirective,exports.bj=ErrorRendererComponent,exports.bl=ExpressionRunner,exports.bk=HidersDisablersFactory,exports.bo=AlertsFactory,exports.bd=FormRendererComponent,exports.be=DEFAULT_STYLES,exports.bi=HistoricalFieldHelperService,exports.bm=JsExpressionHelper,exports.bn=DebugModeService,exports.o=SharedModule,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-openmrs-formentry.umd.min.js.map